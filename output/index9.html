<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Lo-Fi Python | Page 9</title>
    <link rel="shortcut icon" type="image/png" href="https://lofipython.com/favicon.png">
    <link rel="shortcut icon" type="image/x-icon" href="https://lofipython.com/favicon.ico">
    <link href="https://lofipython.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Lo-Fi Python Full Atom Feed" />
    <link href="https://lofipython.com/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="Lo-Fi Python Full RSS Feed" />
    <link rel="stylesheet" href="https://lofipython.com/theme/css/main.css" type="text/css" />
    <link rel="stylesheet" href="https://lofipython.com/theme/css/pygments.css" type="text/css" />
    <meta name="generator" content="Pelican" />
    <meta name="description" content="" />
    <meta name="author" content="@erickbytes" />
</head>
<body>
    <header>
        <nav style="overflow: hidden;">
            <ul>
                <li><a href="https://lofipython.com/">Home</a></li>
                <li><a href="feeds/all.rss.xml">RSS</a></li>
                <li><a href="feeds/all.atom.xml">Atom</a></li>
                <li><a href="https://github.com/erickbytes/lofipython">Github</a></li>
            </ul>
        </nav>
        <div class="header_box" style="height: 50px">
        <h1><a href="https://lofipython.com/">
            <image src='images/python-powered-h-140x182.png' class="avatar" width="50px" /><span class="site_title">Lo-Fi Python</span>
            </a></h1></div>
        </div>
    </header>
    <div id="wrapper">
        <div id="content">            <h4 class="date">Jan 25, 2020</h4>

            <article class="post">
                <h2 class="title">
                    <a href="https://lofipython.com/git-the-basics-a-git-version-control-cheat-sheet.html" rel="bookmark" title="Permanent Link to &quot;"Git" The Basics: A Version Control Cheat Sheet&quot;">&quot;Git&quot; The Basics: A Version Control Cheat Sheet</a>
                </h2>

                
                

                <p>I am finally starting to understand <a class="reference external" href="https://en.wikipedia.org/wiki/Git">git version control</a>! It makes developing a project on different computers easy. Some of these notes were picked up from the super informative <a class="reference external" href="https://www.youtube.com/watch?v=_ZEWDGpM-vM">Reproducible Data Analysis in Jupyter video series</a> by Jake VanderPlas, author of the <a class="reference external" href="https://jakevdp.github.io/PythonDataScienceHandbook/">Python Data Science Handbook</a>.</p>
<p>First, <a class="reference external" href="https://git-scm.com/downloads">go here</a> to download and install git if you haven't yet. Alright, here are my go-to steps and commands for git:</p>
<p><strong>Beginning a New Project With Git</strong></p>
<ol class="arabic simple">
<li>Create new repository on GitHub</li>
<li>Add a README</li>
<li>Add a Python gitignore</li>
<li>Add a license. Jake V. used an MIT license.</li>
</ol>
<p><strong>Clone Any Repository from GitHub</strong></p>
<ol class="arabic simple">
<li>Visit your new project, or any GitHub project, click the green &quot;Clone or download&quot; button and copy the link.</li>
<li>In your terminal or command prompt, navigate to the directory where you want to clone your project.</li>
<li>In terminal, enter: git clone REPO_URL</li>
<li>Now cd into your project folder.</li>
</ol>
<p><strong>Push Your Local Computer Changes to the Remote Repository</strong></p>
<p>Let's say you did some work on your computer and want to push the changes to GitHub. Enter these commands in terminal:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><span class="go">git add .</span>
<span class="go">git commit -m &quot;Add your commit note here&quot;</span>
<span class="go">git push origin main</span>
</pre></div></td></tr></table></div>
<p>Above: &quot;git add .&quot; stages all files in project directory for main. Add your commit message, then push your changes to the remote repo.</p>
<p><strong>Fetch Changes From Main Branch to Your Local Computer</strong></p>
<p>You might want to update your local computer with any main branch changes before beginning work on it. Enter these commands in terminal:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><span class="go">git fetch</span>
<span class="go">git pull origin main</span>
</pre></div></td></tr></table></div>
<p><strong>Review Merge Conflicts</strong></p>
<p>Sometimes, your code may conflict with changes in the main branch. You'll find out if you try to push or pull changes and the auto-merge fails. Use &quot;git status&quot; to locate the files with the conflicts. Enter in your terminal:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><span class="go">git status</span>
</pre></div></td></tr></table></div>
<p>Then <a class="reference external" href="https://help.github.com/en/github/collaborating-with-issues-and-pull-requests/resolving-a-merge-conflict-using-the-command-line">follow these instructions</a> to review the merge conflicts.</p>
<p>See also: <a class="reference external" href="https://dont-be-afraid-to-commit.readthedocs.io/en/latest/git/conflicts.html">Resolving Conflicts - Virtualenv Documentation</a></p>
<p><strong>Or maybe you want to discard any local changes, then merge:</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><span class="go">git fetch</span>
<span class="go">git checkout</span>
<span class="go">git pull origin main</span>
</pre></div></td></tr></table></div>
<p><strong>Recovering from a Corrupted Repository</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><span class="go">git fsck --full --no-dangling</span>
</pre></div></td></tr></table></div>
<p><a class="reference external" href="https://mirrors.edge.kernel.org/pub/software/scm/git/docs/user-manual.html#recovering-from-repository-corruption">Additional Reading</a></p>
<p><strong>Revert local repo to a previous commit, then push your repo to the remote.</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><span class="go">git reset --hard rollback_commit_id</span>
<span class="go">git push origin main</span>
</pre></div></td></tr></table></div>
<p><strong>Supplementary Reading</strong></p>
<p><a class="reference external" href="https://dev.to/lydiahallie/cs-visualized-useful-git-commands-37p1">CS Visualized: Useful Git Commands</a></p>
<p><a class="reference external" href="https://lanraccoon.com/2018/8-git-commands-i-use-everyday/">8 Git Commands I Use Every Day</a></p>
<p><a class="reference external" href="http://who-t.blogspot.com/2009/12/on-commit-messages.html">On Commit Messages</a></p>
<p><a class="reference external" href="https://github.com/pandas-dev/pandas/wiki/Git-Workflows">Pandas Library Git Workflows</a></p>

                <div class="clear"></div>

                <div class="info">
                    <a href="https://lofipython.com/git-the-basics-a-git-version-control-cheat-sheet.html">posted at 05:06</a>
                    &nbsp;&middot;&nbsp;<a href="https://lofipython.com/category/coding-command-prompt-data-analysis-git-programming-software.html" rel="tag">coding, command prompt, data analysis, git, programming, software</a>
                    &nbsp;&middot;
                    &nbsp;<a href="https://lofipython.com/tag/github.html" class="tags">github</a>
                    &nbsp;<a href="https://lofipython.com/tag/terminal.html" class="tags">terminal</a>
                    &nbsp;<a href="https://lofipython.com/tag/version-control.html" class="tags">version control</a>
                </div>
            </article>            <h4 class="date">Dec 26, 2019</h4>

            <article class="post">
                <h2 class="title">
                    <a href="https://lofipython.com/comparing-text-editors-on-ubuntu-atom-emacs-sublime-vim-vs-code.html" rel="bookmark" title="Permanent Link to &quot;Comparing Text Editors on Ubuntu: Atom, Emacs, Sublime, Vim & VS Code&quot;">Comparing Text Editors on Ubuntu: Atom, Emacs, Sublime, Vim &amp; VS Code</a>
                </h2>

                
                

                <p>The text editor is a core tool for writing software. I've always used Atom. Lately, I've noticed my Atom text editor was bogging down on my Chromebook running Ubuntu 16.04. Keystrokes and mouse movements were lagging and slowing my coding down. I'm also getting low on disk space, which may be a related issue.</p>
<p>You'll want to choose a text editor based on how it suits your own needs. In this case, I want a light-weight, responsive editor with no lag. Bells and whistles are less important. I'm also looking to minimize disk space required.</p>
<p>I decided to compare the <a class="reference external" href="https://codeburst.io/a-beginners-guide-to-using-apt-get-commands-in-linux-ubuntu-d5f102a56fc4">apt installed</a> package size of some popular editors.&nbsp;First, I installed Atom, Emacs, Sublime, VS Code and Vim using the Ubuntu 16.04 terminal. You&nbsp;could also consider using <a class="reference external" href="https://docs.python.org/3/library/idle.html">IDLE, python's built-in text editor</a> as an alternative that requires no additional software.</p>
<p><strong>Then I</strong> <a class="reference external" href="https://unix.stackexchange.com/questions/40442/which-installed-software-packages-use-the-most-disk-space-on-debian">found the below command</a> <strong>to list all installed apt packages by package size on Ubuntu:</strong></p>
<pre class="literal-block">
dpkg-query -Wf '${Installed-Size}\t${Package}\n' | sort -n
</pre>
<p><strong>Here's the terminal output with relevant packages in Megabytes (including Firefox for comparative size):</strong></p>
<pre class="literal-block">
136    emacsen-common
366 vim-common
1071    vim-tiny
2400    vim
21648   emacs26
26870   vim-runtime
34033   sublime-text
70307   emacs26-common
193694  firefox
236965  code
607932  atom
</pre>
<p>Atom is by far the largest package I downloaded. It is nearly three times the size of VS Code, my second largest package. The next largest was my web browser, Firefox. Most of the other packages I downloaded were considerably smaller.</p>
<blockquote>
Side note: I also found out Ubuntu 16.04 ships with a stripped down version of Vim called <a class="reference external" href="https://askubuntu.com/questions/104138/what-features-does-vim-tiny-have">vim-tiny</a>.</blockquote>
<p><strong>Total Installed Package Sizes in Megabytes (Smallest to Largest)</strong></p>
<p>Some of these editors have multiple packages they are dependent on.</p>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="36%" />
<col width="48%" />
</colgroup>
<tbody valign="top">
<tr><td>Text Editor</td>
<td>Total Installed Packages Size</td>
<td><strong>Packages Installed</strong></td>
</tr>
<tr><td>Vim</td>
<td>29,636 MB</td>
<td>vim, vim-common, vim-runtime</td>
</tr>
<tr><td>Sublime</td>
<td>34,033 MB</td>
<td>sublime-text</td>
</tr>
<tr><td>Emacs</td>
<td>91,955 MB</td>
<td>emacs26-common, emacs26, emacsen-common</td>
</tr>
<tr><td>VS Code</td>
<td>236,965 MB</td>
<td>code</td>
</tr>
<tr><td>Atom</td>
<td>607,932 MB</td>
<td>atom</td>
</tr>
</tbody>
</table>
<p><strong>Results: Vim and Sublime win for smallest installed package size.</strong></p>
<ul class="simple">
<li>Vim is the lightest-weight package of these 5 popular text editors, with Sublime not far behind. Emacs is comparable to them for usability and relatively small.</li>
<li>Atom is nearly 3x the size of VS Code and 20x the size of Vim. Atom and VS Code are larger than the Firefox browser package, the third largest of any downloaded package on my system.</li>
<li>I tested out all of the editors by opening the same Python file and making some edits. I found Vim, Emacs and Sublime were much more responsive than Atom and VS Code.</li>
</ul>
<p><strong>Conclusion: All Editors Are Not Created Equal</strong></p>
<p>These are fine editors when paired with the right machine and developer needs. In my case, a Chromebook running Linux installed with <a class="reference external" href="https://github.com/dnschneid/crouton">Crouton</a>, a few editors are performing faster and taking up less space. I've chosen Sublime or Emacs as my editor for this computer. One slightly annoying feature of Sublime is being prompted to buy the paid version from the trial version. Atom, Emacs, Vim and VS Code are free. Vim might be a good option if I ever decide to conquer its <a class="reference external" href="https://stackoverflow.com/questions/11828270/how-do-i-exit-the-vim-editor">notoriously high learning curve</a>.</p>
<p><strong>[Bonus] Find the size of all packages matching with &quot;vim&quot; in their name:</strong></p>
<pre class="literal-block">
dpkg-query -Wf '${Installed-Size}\t${Package}\n' | sort -n | grep vim
</pre>
<p><strong>Terminal output from above command:</strong></p>
<pre class="literal-block">
366 vim-common
1071 vim-tiny
2400 vim
26870 vim-runtime
</pre>
<p><strong>Additional Reading</strong></p>
<p><a class="reference external" href="https://www.quora.com/What-is-the-best-lightweight-text-editor">What is the best lightweight text editor?</a></p>
<p><a class="reference external" href="https://github.com/atom/atom/issues/9755">Atom as an Editor is Too Big</a></p>

                <div class="clear"></div>

                <div class="info">
                    <a href="https://lofipython.com/comparing-text-editors-on-ubuntu-atom-emacs-sublime-vim-vs-code.html">posted at 01:25</a>
                    &nbsp;&middot;&nbsp;<a href="https://lofipython.com/category/coding-linux-scripts-software-ubuntu.html" rel="tag">coding, Linux, Scripts, software, Ubuntu</a>
                    &nbsp;&middot;
                    &nbsp;<a href="https://lofipython.com/tag/atom.html" class="tags">atom</a>
                    &nbsp;<a href="https://lofipython.com/tag/emacs.html" class="tags">emacs</a>
                    &nbsp;<a href="https://lofipython.com/tag/sublime.html" class="tags">sublime</a>
                    &nbsp;<a href="https://lofipython.com/tag/text-editors.html" class="tags">text editors</a>
                    &nbsp;<a href="https://lofipython.com/tag/vim.html" class="tags">vim</a>
                    &nbsp;<a href="https://lofipython.com/tag/vs-code.html" class="tags">vs code</a>
                </div>
            </article>            <h4 class="date">Dec 21, 2019</h4>

            <article class="post">
                <h2 class="title">
                    <a href="https://lofipython.com/copying-a-csv-file-to-google-sheets-with-pygsheets.html" rel="bookmark" title="Permanent Link to &quot;Copying a pandas Dataframe to Google Sheets with pygsheets&quot;">Copying a pandas Dataframe to Google Sheets with pygsheets</a>
                </h2>

                
                

                <p><strong>Disclaimer</strong>: This endeavor was before I discovered <a class="reference external" href="https://developers.google.com/apps-script">AppScript</a>, which may be an alternative solution to using pygsheets or other python libraries. pygsheets is interesting, but it could be a stretch to justify using it for something that could be done with AppScript. Both are ways to solve a problem by automating Google Sheet operations.</p>
<p>This was done on the Windows 7 OS. First, <a class="reference external" href="https://docs.python.org/3/installing/index.html">install libraries with pip</a>. Enter in command prompt or terminal:</p>
<pre class="literal-block">
python -m pip install pandas
python -m pip install numpy
python -m pip install pygsheets
</pre>
<p><strong>After installing necessary libraries, follow the</strong> <a class="reference external" href="https://pygsheets.readthedocs.io/en/stable/authorization.html">steps documented by pygsheets:</a></p>
<ol class="arabic simple">
<li>Create a Google Developer Account at <a class="reference external" href="http://console.developers.google.com">console.developers.google.com</a></li>
<li><a class="reference external" href="https://pygsheets.readthedocs.io/en/stable/authorization.html">Enable Sheets API</a> to account</li>
<li>Enable Drive API to account. Same as last step, but search for Drive.</li>
<li>Create a Client Secret json file. Select &quot;Credentials&quot; tab, and &quot;Create Credentials&quot;. Select Client Secret from options. Export from console and place in same directory as your .py file.</li>
<li>Create a Service Account json file by selecting it instead of &quot;Client Secret&quot;.</li>
<li>Authorize pygsheets with your json files. See below.</li>
<li>Copy spreadsheet to Google Sheet with pandas and pygsheets. See below.</li>
</ol>
<p>After completing the first 5 steps, import pygsheets and authorize your account with the client secret json file:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">import</span> <span class="nn">pygsheets</span>
<span class="n">gc</span> <span class="o">=</span> <span class="n">pygsheets</span><span class="o">.</span><span class="n">authorize</span><span class="p">(</span><span class="n">client_secret</span><span class="o">=</span><span class="s1">&#39;path/to/client_secret[...].json&#39;</span><span class="p">)</span>
</pre></div></td></tr></table></div>
<p>You will be prompted by the terminal to go to a hyperlink in a browser, get your authorization code, and enter that authorization code into the terminal.</p>
<p>Now, import both libraries needed and switch to authorize with your service json file. Then, load the csv to a dataframe with pandas. Finally, copy it to an existing Google Sheet with pygsheets:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">import</span> <span class="nn">pygsheets</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="sd">&quot;&quot;&quot;Select worksheets by id, index, or title.&quot;&quot;&quot;</span>
<span class="n">gc</span> <span class="o">=</span> <span class="n">pygsheets</span><span class="o">.</span><span class="n">authorize</span><span class="p">(</span><span class="n">service_file</span><span class="o">=</span><span class="s1">&#39;path/to/service_account_credentials.json&#39;</span><span class="p">)</span>
<span class="n">sh</span> <span class="o">=</span> <span class="n">gc</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;add_google_sheet_name_here&#39;</span><span class="p">)</span>
<span class="n">wks</span> <span class="o">=</span> <span class="n">sh</span><span class="o">.</span><span class="n">worksheet_by_title</span><span class="p">(</span><span class="s1">&#39;add_sheet_tab_name_here&#39;</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot;Set a pandas dataframe to google sheet, starting at 1st row, 1st column&quot;&quot;&quot;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;Example_Data.csv&#39;</span><span class="p">)</span>
<span class="n">wks</span><span class="o">.</span><span class="n">set_dataframe</span><span class="p">(</span><span class="n">df</span><span class="p">,(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</pre></div></td></tr></table></div>
<p><strong>[Example] Split and upload a sheet with 40 columns</strong></p>
<p>Google Sheets limits importing to 26 columns and 1,000 rows at a time. So you'll have to load the sheets in chunks if you have more than that. This approach uses numpy's <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.array_split.html">array_split</a>:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">import</span> <span class="nn">pygsheets</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">gc</span> <span class="o">=</span> <span class="n">pygsheets</span><span class="o">.</span><span class="n">authorize</span><span class="p">(</span><span class="n">client_secret</span><span class="o">=</span><span class="s1">&#39;path/to/client_secret[...].json&#39;</span><span class="p">)</span>
<span class="n">sh</span> <span class="o">=</span> <span class="n">gc</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;add_google_sheet_name_here&#39;</span><span class="p">)</span>
<span class="n">wks</span> <span class="o">=</span> <span class="n">sh</span><span class="o">.</span><span class="n">worksheet_by_title</span><span class="p">(</span><span class="s1">&#39;add_sheet_tab_name_here&#39;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;Data_to_GSheets.csv&#39;</span><span class="p">)</span>

<span class="c1"># split columns into two dataframes with numpy and pandas</span>
<span class="n">first_half_cols</span><span class="p">,</span> <span class="n">second_half_cols</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_split</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">first_half</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">first_half_cols</span><span class="p">]</span>
<span class="n">second_half</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">second_half_cols</span><span class="p">]</span>

<span class="c1"># set both dataframes side-by-side in Google sheet</span>
<span class="n">wks</span><span class="o">.</span><span class="n">set_dataframe</span><span class="p">(</span><span class="n">first_half</span><span class="p">,(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">start_column</span> <span class="o">=</span> <span class="n">first_half</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">wks</span><span class="o">.</span><span class="n">set_dataframe</span><span class="p">(</span><span class="n">second_half</span><span class="p">,(</span><span class="mi">1</span><span class="p">,</span> <span class="n">start_column</span><span class="p">))</span>
</pre></div></td></tr></table></div>
<p><strong>Conclusion</strong></p>
<p>I found the terminal error messages from pygsheets to be very helpful while debugging the above. This module offers many other nifty spreadsheet operations. Solid library. You can now create and edit Google Sheets with Python.</p>
<p>AppsScript should probably be the default tool when working with Google Sheets because it is built in, but Python does have tools available to work with Google Sheets.</p>
<p><strong>Resources</strong></p>
<p><a class="reference external" href="https://github.com/nithinmurali/pygsheets">pygsheets Github</a></p>
<p><a class="reference external" href="https://pygsheets.readthedocs.io/en/stable/authorization.html">pygsheets Documentation</a></p>
<p><a class="reference external" href="https://developers.google.com/sheets/api/guides/concepts">Google Sheets Documentation</a></p>
<p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_csv.html">pandas Documentation</a></p>

                <div class="clear"></div>

                <div class="info">
                    <a href="https://lofipython.com/copying-a-csv-file-to-google-sheets-with-pygsheets.html">posted at 18:58</a>
                    &nbsp;&middot;&nbsp;<a href="https://lofipython.com/category/automation-coding-excel-google-pandas.html" rel="tag">automation, coding, excel, Google, pandas</a>
                    &nbsp;&middot;
                    &nbsp;<a href="https://lofipython.com/tag/api.html" class="tags">api</a>
                    &nbsp;<a href="https://lofipython.com/tag/google-api.html" class="tags">google api</a>
                    &nbsp;<a href="https://lofipython.com/tag/google-sheets.html" class="tags">google sheets</a>
                    &nbsp;<a href="https://lofipython.com/tag/json.html" class="tags">json</a>
                    &nbsp;<a href="https://lofipython.com/tag/python.html" class="tags">python</a>
                    &nbsp;<a href="https://lofipython.com/tag/spreadsheets.html" class="tags">spreadsheets</a>
                </div>
            </article>            <h4 class="date">Dec 05, 2019</h4>

            <article class="post">
                <h2 class="title">
                    <a href="https://lofipython.com/a-collection-of-software-testing-opinions-for-python-and-beyond.html" rel="bookmark" title="Permanent Link to &quot;A Collection of Software Testing Opinions for Python and Beyond&quot;">A Collection of Software Testing Opinions for Python and Beyond</a>
                </h2>

                
                

                <p>I am a beginner to testing my code. I wanted to write about testing to better understand it. While shaping this link fest masquerading as an essay, I collected great ideas from people who are way more experienced than me. You'll find a few of my thoughts, a Pytest example I use to monitor files, ideas for unit testing, property testing, test driven development and many other commonly used software tests.</p>
<p><strong>An Introductory Rant on Testing</strong></p>
<p>Over several years as a programmer, I've slowly grasped the landscape of testing in software development. After moving beyond my first few tutorials and projects, it seemed very noisy to sort out. Examples provided are usually simple assertions that seem tough to relate to a real use case. It might be easy test the wrong things. Plus, some don't do it at all! The quality of the tests is more important than the quantity. But what makes a quality test? Where's the balance between testing every minute detail of a program and not at all?</p>
<blockquote>
<p>Yeah. And the worst thing that happens is that you get people that just stop&nbsp;<em>thinking</em>&nbsp;about what they’re doing. “This is the principle, to always write unit tests, so I’m always going to write unit tests,” and then they’re just not thinking about how they’re spending their time, and they wind up wasting a lot of it.</p>
<p>Joel Spolsky, <a class="reference external" href="https://www.joelonsoftware.com/2009/01/">Stack Overflow Podcast #38</a></p>
</blockquote>
<p>Implementing software tests is a best practice for maintaining code, but seems ambiguous to someone who has not tested any code before. I guess the best way is to <a class="reference external" href="https://github.com/iodide-project/pyodide/tree/master/test">read open source projects with test suites</a>, but those can be tough to find. How do you know <a class="reference external" href="https://docs.python-guide.org/writing/reading/">a good test suite</a> when you see it? Maybe the maintainers went rogue and off the deep end with tests. Online, everybody says you should test your code, <a class="reference external" href="https://en.wikipedia.org/wiki/The_Emperor%27s_New_Clothes">is the emperor wearing any clothes?</a></p>
<p>As a beginner stumbling across articles on testing, these questions were tough to answer. As with most things in programming, figuring out the right question to ask is a challenge in itself. <a class="reference external" href="https://www.codecademy.com/learn/learn-python-3">Codeacademy</a> and <a class="reference external" href="https://www.coursera.org/specializations/python">Coursera</a> never mentioned anything about writing tests. On the other hand, <a class="reference external" href="https://docs.djangoproject.com/en/2.2/intro/tutorial05/">Django</a> includes testing in its tutorial and documentation. Also, most languages come with built-in testing tools. Python has the <a class="reference external" href="https://docs.python.org/3/library/unittest.html">unittest</a> library.</p>
<p><strong>Why test at all? First, some solid benefits of software testing:</strong></p>
<ul class="simple">
<li>With tests on your code in place, you can implement changes and have confidence the code still works if the tests pass. This gives developers more confidence to iterate and improve an application.</li>
<li>Detect problems faster. Passing tests are a good indicator that your programs are actually doing what they're supposed to do. If they don't pass, you likely found a bug you might have missed otherwise.</li>
<li>When you find a bug, you either need to amend your code, or your tests. write a test for that bug and then fix it. Either that, or you need to be amend your tests. You've just improved the quality of your test suite.</li>
<li><a class="reference external" href="https://daedtech.com/dont-learn-to-code-learn-to-automate/">Automation</a>. If you are writing tests, those tests can be automated. If you are manually checking the results of your program, you're missing a chance to automate those checks away. I haven't applied it yet, but have heard the <a class="reference external" href="https://tox.readthedocs.io/en/latest/">Tox library</a> may be useful to automate tests related to Python packaging. For more on automating tests, see this PyCon talk, <a class="reference external" href="https://www.youtube.com/watch?v=-BHverY7IwU">Three Excellent Python Tools to Automate Repetitive Tasks</a>.</li>
<li>Test Driven Development can decrease the time spent debugging code. This claim sometimes lacks empirical evidence, supporting evidence tends to be anecdotal.</li>
</ul>
<!--  -->
<blockquote>
<p>A good unit test, therefore, is one that helps enforce the contract to which the function is committed.</p>
<p>If a good unit test breaks, the contract is violated and should be either explicitly amended (by changing the documentation and tests), or fixed (by fixing the code and leaving the tests as is).</p>
<p>A good unit test is also&nbsp;<em>strict</em>. It does its best to ensure the output is valid. This helps it catch more bugs.</p>
<ul class="simple">
<li>Moshe Zadka, <a class="reference external" href="https://orbifold.xyz/pyhamcrest.html">Precise Unit Tests With pyhamcrest</a></li>
</ul>
</blockquote>
<p><strong>Pytest and Unit Testing in Python</strong></p>
<p>This is where the Python hits the pavement. Unit tests are generally liked, although some prefer property tests or integration tests because they think the scope of unit tests is too narrow. The <a class="reference external" href="https://docs.python.org/3/library/unittest.html">unittest</a> library is Python's default testing framework. However nowadays, <a class="reference external" href="https://docs.pytest.org/en/latest/contents.html">pytest</a> seems to be the preferred unit testing framework for Python. <a class="reference external" href="https://hypothesis.readthedocs.io/en/latest/">Hypothesis</a> is another popular framework I've read about.</p>
<p><strong>Pytest Testing</strong></p>
<ul class="simple">
<li><a class="reference external" href="https://realpython.com/interview-brian-okken/">Interview with the author of Pytest</a></li>
<li><a class="reference external" href="https://docs.pytest.org/en/latest/">Pytest Documentation</a></li>
<li><a class="reference external" href="https://martinheinz.dev/blog/7">Pytest Features That You Need In Your Life</a></li>
<li><a class="reference external" href="http://love-python.blogspot.com/2017/10/table-driven-unit-test-in-python.html">Table Driven Unit Testing With pytest</a></li>
<li><a class="reference external" href="https://www.youtube.com/watch?v=Pf1ADyUKOrE">Reproducible Data Analysis in Jupyter, Part 6/10: Unit Testing with PyTest</a> [YouTube]</li>
</ul>
<!--  -->
<blockquote>
Tests start to lose signal when <a class="reference external" href="https://docs.python.org/3/library/unittest.mock.html">Mock</a> becomes routine instead of a reluctant workaround. - Brandon Rhodes, <a class="reference external" href="http://S0No2zSJmks">When Python Practices Go Wrong</a></blockquote>
<p><strong>Testing in Python \ General Unit Testing Ideas</strong></p>
<ul class="simple">
<li><a class="reference external" href="https://github.com/pandas-dev/pandas/wiki/Testing">Testing Conventions for the Pandas Library</a></li>
<li><a class="reference external" href="https://kanoki.org/2019/11/18/how-to-create-dataframe-for-testing/">How to Create a Dataframe for Testing</a></li>
<li><a class="reference external" href="https://jeffknupp.com/blog/2013/12/09/improve-your-python-understanding-unit-testing//">Improve Your Python: Understanding Unit Testing</a></li>
<li><a class="reference external" href="http://kbroman.org/blog/2015/12/07/write-unit-tests/">Write Unit Tests</a></li>
<li><a class="reference external" href="https://henrikwarne.com/2013/12/08/tdd-unit-tests-and-the-passage-of-time/">Writing Unit Tests for Time</a></li>
<li><a class="reference external" href="https://henrikwarne.com/2014/02/19/5-unit-testing-mistakes/">5 Unit Testing Mistakes</a></li>
<li><a class="reference external" href="https://hillelwayne.com/post/unit-tests-are-not-tests/">Unit Tests Are Not Tests</a></li>
<li><a class="reference external" href="https://hakibenita.com/the-best-new-feature-in-unittest-you-didnt-know-you-need">The Best New Feature in unittest You Didn't Know You Need</a></li>
<li><a class="reference external" href="https://orbifold.xyz/pyhamcrest.html">Precise Unit Tests With pyhamcrest</a></li>
<li><a class="reference external" href="https://michaelfeathers.typepad.com/michael_feathers_blog/2008/06/the-flawed-theo.html">The Flawed Theory Behind Unit Testing</a></li>
<li><a class="reference external" href="https://docs.djangoproject.com/en/2.2/intro/tutorial05/">Django Introduction to Automated Testing</a></li>
<li><a class="reference external" href="https://hillelwayne.com/post/python-doctests/">Python Doc Tests</a> Turn docstrings into tests, unique to Python.</li>
</ul>
<!--  -->
<blockquote>
<p>I think&nbsp;<a class="reference external" href="https://hypothesis.readthedocs.io/en/latest/">hypothesis</a>&nbsp;is probably underrated—some libraries are hesitant to incorporate it into their testing frameworks, but I think the property-based testing has real potential to catch scenarios humans would have a hard time anticipating, or at least that would take a long time to properly plan for. I find that hypothesis almost always adds a few useful test cases I hadn’t thought of that will require special error handling, for example.</p>
<p><a class="reference external" href="http://www.blog.pythonlibrary.org/2020/01/13/pydev-of-the-week-tyler-reddy/">Tyler Reddy</a>, SciPy Release Manager</p>
</blockquote>
<p><strong>Integration \ Property Tests</strong></p>
<ul class="simple">
<li><a class="reference external" href="https://blog.juliobiason.me/books/things-i-learnt/integration-tests/">Unit Tests Are Good, Integration Tests Are Gooder</a></li>
<li><a class="reference external" href="https://hillelwayne.com/post/pbt-contracts/">PROPERTY TESTS + CONTRACTS = INTEGRATION TESTS</a></li>
<li><a class="reference external" href="https://hillelwayne.com/post/contract-examples/">Finding Property Tests</a></li>
<li><a class="reference external" href="https://increment.com/testing/in-praise-of-property-based-testing/">In Praise of Property-Based Testing</a></li>
<li><a class="reference external" href="https://hillelwayne.com/post/contracts/">Contracts</a></li>
</ul>
<!--  -->
<blockquote>
<p>Traditional, or example-based, testing specifies the behavior of your software by writing examples of it—each test sets up a single concrete scenario and asserts how the software should behave in that scenario. Property-based tests take these concrete scenarios and generalize them by focusing on which features of the scenario are essential and which are allowed to vary. This results in cleaner tests that better specify the software’s behavior—and that better uncover bugs missed by traditional&nbsp;testing.</p>
<ul class="simple">
<li>David Maciver, <a class="reference external" href="https://increment.com/testing/in-praise-of-property-based-testing/">In Praise of Property-based Testing</a></li>
</ul>
</blockquote>
<p><strong>Assertions</strong></p>
<p>Assertions are generally accepted as welcome additions to your code.</p>
<ul class="simple">
<li><a class="reference external" href="https://blog.regehr.org/archives/1091">Use of Assertions</a></li>
<li><a class="reference external" href="http://www.squarefree.com/2014/02/03/fuzzers-love-assertions/">Fuzzers Love Assertions</a></li>
<li><a class="reference external" href="http://pgbovine.net/code-carabiners.htm">Code Carabiners</a></li>
<li><a class="reference external" href="https://docs.pytest.org/en/latest/assert.html#assert">pytest Assertions</a></li>
</ul>
<!--  -->
<blockquote>
<p>In reality, the safety and restraints that these code carabiners provide actually give you <strong>more freedom</strong> to take risks in your coding. If you want to try out some risky feature, refactoring, or external library, you know something is wrong as soon as one of your assertions or tests fail and can undo back to an earlier working state.</p>
<p>Phillip J. Guo, <a class="reference external" href="http://pgbovine.net/code-carabiners.htm">Code Carabiners</a></p>
</blockquote>
<p><strong>Test Driven Development</strong></p>
<p>Eventually, you'll discover the evangelists preaching Test Driven Development. There are certain discussions which polarize us in the software development world, such as the appropriate scenarios to deploy this system of development.</p>
<p>Opinions vary widely on the merits and appropriate application of TDD. I'm admittedly skeptical but do see the merits of TDD. But which flavor? Where do unit tests and integration tests fit in? How many tests should I write? What exactly should I be testing? <a class="reference external" href="https://georgestocker.com/2019/12/10/is-pair-programming-tdd-worth-it/?utm_source=rss&amp;utm_medium=rss&amp;utm_campaign=is-pair-programming-tdd-worth-it">This essay</a> claims anyone pair programming software with an expected life of 3 or more years should use Test Driven Development.</p>
<ul class="simple">
<li><a class="reference external" href="https://henrikwarne.com/2019/09/29/when-tdd-is-not-a-good-fit/">When TDD is Not a Good Fit</a></li>
<li><a class="reference external" href="http://neverworkintheory.org/2016/10/05/test-driven-development.html">Test Driven Development vs. Test Last Development</a> [Study]</li>
<li><a class="reference external" href="https://www.youtube.com/watch?v=DQBf6li1hww">Why TDD Is Crap</a> [YouTube]</li>
<li><a class="reference external" href="https://hillelwayne.com/post/why-tdd-isnt-crap/">Why TDD Isn't Crap</a> [Response Blog to Video]</li>
<li><a class="reference external" href="https://www.arp242.net/testing.html">Testing Isn't Everything</a></li>
<li><a class="reference external" href="https://georgestocker.com/2019/12/10/is-pair-programming-tdd-worth-it/?utm_source=rss&amp;utm_medium=rss&amp;utm_campaign=is-pair-programming-tdd-worth-it">Is Pair Programming + TDD worth it?</a></li>
</ul>
<!--  -->
<blockquote>
<p>&quot;Test Driven Development is a tool for continuously evaluating hypotheses.&quot;</p>
<ul class="simple">
<li><a class="reference external" href="https://www.youtube.com/watch?time_continue=170&amp;v=UOOuW5tqT8M&amp;feature=emb_logo">James Shore, Assert(JS) Con 2019</a></li>
</ul>
</blockquote>
<p><strong>General Testing Ideas and Principles</strong></p>
<ul class="simple">
<li><a class="reference external" href="https://docs.python-guide.org/writing/tests/">Testing Your Code</a>, The Hitchhiker's Guide to Python</li>
<li><a class="reference external" href="https://blog.liw.fi/posts/2019/06/29/dijkstra_was_only_partially_correct_about_testing/">The Point of Software Testing</a></li>
<li><a class="reference external" href="https://rachelbythebay.com/w/2013/01/30/test/">Connecting Bug Fixing to Automated Testing</a></li>
<li><a class="reference external" href="https://www.jamesshore.com/In-the-News/Thinking-In-Tests.html">Thinking in Tests</a> [YouTube]</li>
<li><a class="reference external" href="https://www.drmaciver.com/2015/04/some-empirically-derived-testing-principles/">Some empirically derived testing principles</a></li>
<li><a class="reference external" href="https://danluu.com/tests-v-reason/">Testing Vs. Informal Reasoning</a></li>
<li><a class="reference external" href="https://blog.nelhage.com/2016/12/how-i-test/">How I Write Tests</a></li>
<li><a class="reference external" href="https://www.youtube.com/watch?v=Xu5EhKVZdV8">Stop Mocking, Start Testing</a> [YouTube]</li>
<li>&quot;<a class="reference external" href="https://python-guide-es.readthedocs.io/es/latest/writing/reading.html">Each one of these projects is a paragon of Python coding.</a>&quot;</li>
<li><a class="reference external" href="https://increment.com/development/what-its-like-to-be-a-developer-at/">What it's Like to Be a Developer at...</a>&nbsp;[Testing Practices Described]</li>
<li><a class="reference external" href="https://www.youtube.com/watch?v=f84n5oFoZBc">Hammock Driven Development</a> [YouTube] Not so much testing focused, but including because I really enjoyed this talk.</li>
</ul>
<p><strong>Other common tests types:</strong></p>
<blockquote>
<p>Unit test: when it fails, it tells you what piece of your code needs to be fixed.</p>
<p>Integration test: when it fails, it tells you that the pieces of your application are not working together as expected.</p>
<p>Acceptance test: when it fails, it tells you that the application is not doing what the customer expects it to do.</p>
<p>Regression test: when it fails, it tells you that the application no longer behaves the way it used to.</p>
<ul class="simple">
<li><a class="reference external" href="https://stackoverflow.com/questions/7672511/unit-test-integration-test-regression-test-acceptance-test">Mathias, Stack Overflow Answer</a></li>
</ul>
</blockquote>
<p><strong>Testing maturity level progression:</strong></p>
<ol class="arabic simple">
<li>No tests</li>
<li>Occasional, slow, unreliable tests</li>
<li>Semi-comprehensive integration tests</li>
<li>Fast, comprehensive unit tests comprise the bulk of testing<ul>
<li>Dependency injection</li>
<li>Composable subsystem design</li>
</ul>
</li>
<li>Real-time test feedback (ideally integrated into the editor)</li>
<li>Tests are extremely reliable or&nbsp;<a class="reference external" href="http://andyfriesen.com/2015/06/17/testable-io-in-haskell.html">guaranteed reliable by the type system</a><ul>
<li>With tooling that tracks the reliability of tests and provides that feedback to authors.</li>
</ul>
</li>
<li>Fuzzing, statistically automated microbenchmarking, rich testing frameworks for every language and every platform, and a company culture of writing the appropriate number of unit tests and high-value integration tests.</li>
</ol>
<ul class="simple">
<li><a class="reference external" href="https://chadaustin.me/2019/11/two-years-at-dropbox/">ChadAustin.me</a></li>
</ul>
<p><strong>I recently wrote my first unit tests with pytest. Below is a script named test_file_date.py. It tests if the day of month of the most recently changed file in a directory matches today's day. To install pytest, enter into command prompt or terminal:</strong></p>
<p><tt class="docutils literal">python <span class="pre">-m</span> pip install pytest</tt></p>
<p><strong>test_file_date.py</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">date</span>

<span class="c1"># The dir_query format is for a Windows path with Unix style pattern matching.</span>
<span class="k">def</span> <span class="nf">test_csv_date_equals_today</span><span class="p">():</span>
    <span class="n">dir_query</span> <span class="o">=</span> <span class="s1">&#39;C:</span><span class="se">\\</span><span class="s1">Users</span><span class="se">\\</span><span class="s1">your_username</span><span class="se">\\</span><span class="s1">Desktop</span><span class="se">\\</span><span class="s1">*.csv&#39;</span> <span class="c1"># specify csv extension and folder</span>
    <span class="n">file_path</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">iglob</span><span class="p">(</span><span class="n">dir_query</span><span class="p">),</span> <span class="n">key</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getmtime</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># get most recent file</span>
    <span class="n">file_timestamp</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getmtime</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
    <span class="n">file_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">file_timestamp</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">file_date</span><span class="o">.</span><span class="n">day</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">day</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">file_date</span><span class="o">.</span><span class="n">day</span> <span class="o">==</span> <span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">day</span>
</pre></div></td></tr></table></div>
<div class="line-block">
<div class="line"><strong>Run the test with pytest by entering:</strong></div>
<div class="line"><tt class="docutils literal">pytest test_file_date.py</tt></div>
</div>
<div class="line-block">
<div class="line"><strong>Conclusion</strong></div>
<div class="line">I write programs for personal productivity and to <a class="reference external" href="https://pythonmarketer.wordpress.com/2018/11/25/automated-python-with-windows-task-scheduler/">automate processes</a> at my company. The scope of problems my code solves has grown with my programming ability. I'm now reaching the point where I can apply tests to my advantage. However, sometimes I'll write a quick-hitter script for which I can't justify writing tests. Beyond those cases, testing can help if you pick the right style for your project. More so for recurring, automated processes.</div>
</div>
<p>It feels pretty cool when your tests run and you know with more certainty whether a part of your program is getting the job done or not. After setting up my first test with pytest, I have leveled up to novice tester, instead of blissfully not knowing what I don't know about testing. That's a step in the right direction.</p>

                <div class="clear"></div>

                <div class="info">
                    <a href="https://lofipython.com/a-collection-of-software-testing-opinions-for-python-and-beyond.html">posted at 03:06</a>
                    &nbsp;&middot;&nbsp;<a href="https://lofipython.com/category/coding-productivity-programming-python-software-testing.html" rel="tag">coding, productivity, programming, python, software testing</a>
                    &nbsp;&middot;
                    &nbsp;<a href="https://lofipython.com/tag/pytest.html" class="tags">pytest</a>
                    &nbsp;<a href="https://lofipython.com/tag/software-development.html" class="tags">software development</a>
                    &nbsp;<a href="https://lofipython.com/tag/test-driven-development.html" class="tags">test driven development</a>
                </div>
            </article>            <h4 class="date">Nov 30, 2019</h4>

            <article class="post">
                <h2 class="title">
                    <a href="https://lofipython.com/inserting-new-records-into-a-microsoft-access-database-with-python.html" rel="bookmark" title="Permanent Link to &quot;Inserting New Rows Into A Microsoft Access Database With Python and pyodbc&quot;">Inserting New Rows Into A Microsoft Access Database With Python and pyodbc</a>
                </h2>

                
                

                <p>I recently automated the loading of data into a Microsoft Access database with <a class="reference external" href="https://github.com/mkleehammer/pyodbc/wiki">pyodbc</a>, a Python library for connecting to databases. ODBC stands for <a class="reference external" href="https://en.wikipedia.org/wiki/Open_Database_Connectivity">Open Database Connectivity</a>. It can be used for a variety of Database Management Systems outside of Access also.</p>
<p><strong>First,</strong> <a class="reference external" href="https://docs.python.org/3/installing/index.html">install libraries with pip</a><strong>. Enter in terminal or command prompt:</strong></p>
<pre class="literal-block">
python -m pip install pyodbc
python -m pip install pandas
</pre>
<p><strong>Next, check available Microsoft Access drivers on your computer. Enter the below statements into the Python interpreter:</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><span class="n">python</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">pyodbc</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">pyodbc</span><span class="o">.</span><span class="n">drivers</span><span class="p">()</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;Microsoft Access Driver&#39;</span><span class="p">)]</span>
</pre></div></td></tr></table></div>
<p><strong>Drivers for</strong> <strong>Access &amp; Many Other Data Sources</strong></p>
<p>The driver is the engine that allows you to connect to a specific type of database. The drivers available vary depending on your machine.</p>
<p>The two most common drivers for Access are Microsoft Access Driver (<em>.mdb) and Microsoft Access Driver (</em>.mdb, *.accdb). My computer only had *.mdb, which has been deprecated. My Access database was a .mdb file, so I was able to use this driver as shown below. Read more on Access drivers <a class="reference external" href="https://github.com/mkleehammer/pyodbc/wiki/Connecting-to-Microsoft-Access">here</a>.</p>
<blockquote>
&quot;Drivers exist for all major DBMSs, many other data sources like address book systems and Microsoft Excel, and even for text or comma-separated values (CSV) files.&quot;&nbsp; - <a class="reference external" href="https://en.wikipedia.org/wiki/Open_Database_Connectivity">Wikipedia</a></blockquote>
<p><strong>Database Data Types</strong></p>
<p>I set all of the field data types to &quot;Short Text&quot; because I'm passing strings as SQL parameters below. Uploading as other data types may require additional formatting. To edit the data types of your table, open the table and select &quot;Design View&quot; under the &quot;Home&quot; tab. It got the job done for me!</p>
<p><strong>Inserting new rows into a Microsoft Access Database:</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">pyodbc</span>


<span class="k">def</span> <span class="nf">df_to_row_tuples</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Use list comprehension to format df rows as a list of tuples:</span>
<span class="sd">    rows = [(&#39;Garfield&#39;,&#39;Orange&#39;,&#39;Eat&#39;),(&#39;Meowth&#39;,&#39;White&#39;,&#39;Scratch&#39;)]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span> <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">rows</span>

<span class="sd">&quot;&quot;&quot;Rows are not added to DB until they are committed.</span>
<span class="sd">Pass each row tuple as a SQL parameter (?,?,?).</span>
<span class="sd">cursor.execute docs: https://www.mcobject.com/docs/Content/Programming/Python/Classes/Cursor/execute.htm</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">pyodbc</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Driver={Microsoft Access Driver (*.mdb)};DBQ=C:\Add_Path\To_DB\Here\Your_DB.mdb;&#39;</span><span class="p">)</span>
<span class="n">cursor</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
<span class="n">sql</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39; INSERT INTO Cats (Name, Color, Move)</span>
<span class="s1">          VALUES(?,?,?) &#39;&#39;&#39;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;Cat Data.csv&#39;</span><span class="p">)</span>
<span class="n">rows</span> <span class="o">=</span> <span class="n">df_to_row_tuples</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">row</span><span class="p">)</span>
<span class="n">conn</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</pre></div></td></tr></table></div>
<p><strong>Conclusion</strong></p>
<p>Running the above in command prompt uses pyodbc and SQL to add dataframe rows to a Microsoft Access DB table named &quot;Cats&quot;. Passing each row as a <a class="reference external" href="https://www.python.org/dev/peps/pep-0249/#paramstyle">SQL parameter</a> has two benefits:</p>
<ol class="arabic simple">
<li>It handles strings with single quotes (') and loads them to the DB.</li>
<li>It protects against <a class="reference external" href="https://www.acunetix.com/websitesecurity/sql-injection/">SQL injection</a> attacks.</li>
</ol>
<p><strong>Access Limitation Disclaimer</strong></p>
<p>Access topped out just shy of 10 million rows in my use case, when records stopped getting added to my database. So keep that in mind if you're thinking about using Access to store your data.</p>
<p><strong>Supplementary Resources</strong></p>
<p><a class="reference external" href="https://datatofish.com/insert-ms-access-python/">Insert Values into MS Access Table using Python</a></p>
<p><a class="reference external" href="https://github.com/mkleehammer/pyodbc/wiki">pyodbc documentation</a></p>
<p><a class="reference external" href="https://docs.microsoft.com/en-us/sql/connect/python/pyodbc/step-3-proof-of-concept-connecting-to-sql-using-pyodbc?view=sql-server-ver15">Microsoft Documentation pyodbc example</a></p>
<p><a class="reference external" href="https://www.mcobject.com/docs/Content/Programming/Python/Classes/Cursor.htm">The Python Cursor Class</a></p>
<p><a class="reference external" href="https://www.psycopg.org/docs/cursor.html">Psycopg Cursor Class Documentation</a></p>

                <div class="clear"></div>

                <div class="info">
                    <a href="https://lofipython.com/inserting-new-records-into-a-microsoft-access-database-with-python.html">posted at 00:28</a>
                    &nbsp;&middot;&nbsp;<a href="https://lofipython.com/category/automation-data-databases-excel-odbc-pandas-python-windows.html" rel="tag">automation, data, Databases, excel, ODBC, pandas, python, Windows</a>
                    &nbsp;&middot;
                    &nbsp;<a href="https://lofipython.com/tag/access.html" class="tags">Access</a>
                    &nbsp;<a href="https://lofipython.com/tag/microsoft.html" class="tags">Microsoft</a>
                    &nbsp;<a href="https://lofipython.com/tag/productivity.html" class="tags">productivity</a>
                    &nbsp;<a href="https://lofipython.com/tag/programming.html" class="tags">programming</a>
                </div>
            </article>            <h4 class="date">Apr 25, 2019</h4>

            <article class="post">
                <h2 class="title">
                    <a href="https://lofipython.com/installing-debian-9-stretch-linux-os-on-a-dell-inspiron-laptop-and-troubleshooting-wifi.html" rel="bookmark" title="Permanent Link to &quot;Installing Debian 9 Stretch Linux OS on a Dell Inspiron Laptop and Configuring the Wifi Network&quot;">Installing Debian 9 Stretch Linux OS on a Dell Inspiron Laptop and Configuring the Wifi Network</a>
                </h2>

                
                

                <p>Yesterday, I converted an 11-year old Dell Inspiron E1505 from Windows XP to Debian 9 Stretch. I may have overwrote my Windows XP OS. I do not care if I lost it since it's a vulnerable and outdated OS, which is no longer supported by Microsoft. I encountered difficulty with getting the wifi to work on Debian, but was able to find a solution using <a class="reference external" href="https://help.ubuntu.com/community/WICD">Wicd</a>. Here are the steps I followed to do it all.</p>
<div class="section" id="using-the-debian-installer-loader">
<h2>Using The Debian Installer-Loader</h2>
<ol class="arabic simple">
<li>First, back up your Windows computer files. Then download the <a class="reference external" href="https://wiki.debian.org/DebianInstaller/Loader">Debian-Installer Loader</a> Windows executable from the Debian wiki.</li>
<li>Click the downloaded executable and <img alt="IMG_20190423_184816999" class="wp-image-1785 alignright" src="http://pythonmarketer.files.wordpress.com/2019/04/97878-img_20190423_184816999-e1556211269262.jpg" style="width: 311px; height: 196px;" />follow instructions. I followed the default settings all the way through.</li>
<li>You may need to choose your own partitioning settings to ensure Windows is preserved if desired.</li>
<li>During installation, choose your Linux collection. I chose Xfce because it <a class="reference external" href="https://www.slant.co/versus/1122/1124/~xfce_vs_gnome-3">seems to be highest ranked</a> among Linux users and &quot;not just helpful for older computers where few system resources are available, but also simply for those who want to get the most out of their systems.&quot; Gnome and KDE are other popular options.</li>
</ol>
<img alt="IMG_20190423_184023738" class="wp-image-1784 aligncenter" src="http://pythonmarketer.files.wordpress.com/2019/04/46248-img_20190423_184023738-e1556211291659.jpg" style="width: 564px; height: 375px;" />
<p><strong>After completing installation, restart your computer and select your new OS on boot-up. The following error codes displayed for me while starting up, signaling missing wifi firmware.</strong></p>
<pre class="literal-block">
ERROR Failed to load firmware!
b43ssb0:0: firmware: failed to load b43/ucode5.fw (-2)
b43ssb0:0: firmware: failed to load b43-open/ucode5.fw (-2)
b43-phy0 ERROR: You must go to https://wireless.wiki.kernel.org/en/users/drivers/b43#devicefirmware and download the correct firmware for this driver version.
</pre>
<p><em>It took me a few boot-ups before I realized what this error message meant. In the rest of this post I am trying to figure out and fix what is wrong before I saw the error message. I enjoyed learning how to introspect Linux networks, but if I were trying to fix this problem again, I'd go to directly to *`this page &lt;http://linuxwireless.sipsolutions.net/en/users/Drivers/b43/&gt;`__*, which is linked to from the link in the error message, and try the solution there first.</em></p>
</div>
<div class="section" id="post-installation-setup">
<h2>Post Installation Setup</h2>
<p><strong>Open up the terminal once you're into your new Desktop OS</strong>&nbsp;and enter the below commands.</p>
<pre class="literal-block">
su -
apt-get install sudo -y usermod -aG sudo yourusername
</pre>
<p><strong>1) Enable yourself as root user.</strong></p>
<p><strong>2) Install sudo.</strong></p>
<p><strong>3) Give yourself sudo user permission.</strong></p>
</div>
<div class="section" id="optional-replacing-network-manager-with-wicd">
<h2>Optional: Replacing Network-Manager With Wicd</h2>
<p>This Debian 9 package ships with Network-Manager. After logging in, I wasn't sure why wifi was not working, so I decided to remove Network-Manager and install Wicd. (This was before I realized what the error code displayed on boot-up meant.) Wicd is a Linux network managing alternative and it's built with Python, by the way. I followed <a class="reference external" href="https://help.ubuntu.com/community/WICD">these instructions</a> to execute the below commands.</p>
<pre class="literal-block">
uninstall nm
sudo apt-get install -d --reinstall network-manager network-manager-gnome
install wicd
sudo apt-get install wicd-gtk
</pre>
<p><strong>After installing Wicd, my Ethernet connection was not working. This fixed it for me:</strong></p>
<pre class="literal-block">
sudo ifconfig eth0 up
</pre>
</div>
<div class="section" id="troubleshooting-linux-wifi-inspecting-your-system">
<h2>Troubleshooting Linux Wifi &amp; Inspecting Your System</h2>
<p>Now, let's check for enabled network interfaces. &quot;wlan0&quot; is usually the name of the wireless interface. Does wlan0 show when you enter this command? If not, then you may need to update your wifi firmware. This was the case for me. Below is an output where wlan0 is correctly configured.</p>
<pre class="literal-block">
sudo ifconfig
</pre>
<pre class="literal-block">
eth0: flags=4099&lt;UP,BROADCAST,MULTICAST&gt; mtu 1500
ether 00:25:a5:cf:38:7d txqueuelen 1000 (Ethernet)
RX packets 0 bytes 0 (0.0 B)
RX errors 0 dropped 0 overruns 0 frame 0
TX packets 0 bytes 0 (0.0 B)
TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0
device interrupt 17
lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt; mtu 65536
inet 127.0.0.1 netmask 255.0.0.0
inet6 ::1 prefixlen 128 scopeid 0x10
loop txqueuelen 1 (Local Loopback)
RX packets 4 bytes 240 (240.0 B)
RX errors 0 dropped 0 overruns 0 frame 0
TX packets 4 bytes 240 (240.0 B)
TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0
wlan0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt; mtu 1500
inet 191.142.1.297 netmask 255.255.255.0 broadcast 182.138.5.255
inet6 2601:241:8c00:50ea:21a:92ff:fe0d:7531 prefixlen 64 scopeid 0x0
inet6 fe80::22a:42tf:fe0d:7531 prefixlen 64 scopeid 0x20 ether 00:2a:92:2d:45:51 txqueuelen 1000 (Ethernet)
RX packets 8509 bytes 4639778 (4.4 MiB)
RX errors 0 dropped 0 overruns 0 frame 0
TX packets 6206 bytes 923792 (902.1 KiB)
TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0
</pre>
<p><strong>Check wlan0 is not blocked on kill list.</strong></p>
<pre class="literal-block">
sudo rfkill list all
</pre>
<p>Some computers have a &quot;kill switch&quot; for wifi. This command lists any blocked interfaces. If it is blocked, <a class="reference external" href="https://ubuntuforums.org/showthread.php?t=2298330">this thread</a> might be useful. If nothing shows when you run this command, or if you see wlan0 is not blocked, carry on.</p>
<p><strong>Check which wifi controller you have.</strong> <a class="reference external" href="https://askubuntu.com/questions/55868/installing-broadcom-wireless-drivers">This thread</a> <strong>provides more info on what this means.</strong></p>
<pre class="literal-block">
lspci -nn | grep -e 0200 -e 0280
</pre>
<pre class="literal-block">
03:00.0 Ethernet controller [0200]: Broadcom Limited BCM4401-B0 100Base-TX [14e4:170c] (rev 02)
0b:00.0 Network controller [0280]: Broadcom Limited BCM4311 802.11b/g WLAN [14e4:4311] (rev 01)
</pre>
<p><strong>Find your system architecture. This determines which firmware you should download in the next step.</strong></p>
<pre class="literal-block">
sudo dpkg --print-architecture
</pre>
<p><strong>First,</strong> <a class="reference external" href="https://wireless.wiki.kernel.org/en/users/drivers/b43/firmware">read here</a> <strong>to determine the right packages for your Linux system. Then download the appropriate missing wifi firmware. For Debian, I downloaded the two packages below.</strong></p>
<ol class="arabic simple">
<li><a class="reference external" href="https://packages.debian.org/stretch/b43-fwcutter">b43-fwcutter</a> 2) <a class="reference external" href="https://packages.debian.org/stretch/firmware-b43-installer">b43-installer</a></li>
</ol>
<p><strong>&quot;cd&quot; into the directory with .deb files. Run the below commands to install the new firmware, then reboot your computer. The last two commands are adapted from</strong> <a class="reference external" href="https://ubuntuforums.org/showthread.php?t=2203312&amp;page=4">this thread</a>.</p>
<pre class="literal-block">
sudo dpkg -i firmware-b43-installer_019-3_all.deb
sudo dpkg -i firmware-b43-fwcutter_019-3_i386.deb
sudo modprobe -r b43
sudo modprobe b43
</pre>
<p><strong>Edit Wicd preferences to set wlan0 as the wireless interface if needed.</strong></p>
<img alt="change_wicd_settings" class="alignnone wp-image-1779" src="https://pythonmarketer.files.wordpress.com/2019/04/change_wicd_settings.png" style="width: 380px; height: 357px;" />
<p><strong>Success! Wireless networks are now showing.</strong></p>
<img alt="wicd_success" class="alignnone wp-image-1780" src="https://pythonmarketer.files.wordpress.com/2019/04/wicd_success.png" style="width: 375px; height: 351px;" />
<p><strong>Wrapping Up</strong></p>
<p>I'd like to thank the awesome people who contributed to the Debian Installer-loader and all the help in Linux forums that enabled me figure this out. I'm new to the world of Linux but already enjoying diving into this operating system. Its ability to do just about anything from the command line are a lot of fun. I am now running two Linux systems, one on my Dell and another running Ubuntu that I installed on a Chromebook with <a class="reference external" href="https://www.howtogeek.com/162120/how-to-install-ubuntu-linux-on-your-chromebook-with-crouton/">Crouton</a>. Both have been relatively painless to set up. It this case, it turned a sluggish laptop into a very capable machine. They should call it Lit-nux :)</p>
<p><strong>Full Disclosure</strong></p>
<p>This worked on my computer for a few days before the keyboard stopped working correctly on my computer. Typing became impossible because the keys didn't work or entered the wrong letters when pressed. I'm not sure what the cause of it was, but consider that before attempting this on a machine. Be prepared to lose it. If you really need the machine to be functional, it may not be a great idea to try this. This was attempted on an old beat up computer. I would try this method of porting a Windows machine to Linux again as a salvage project or on a low-risk Windows machine if I had one lying around.</p>
</div>

                <div class="clear"></div>

                <div class="info">
                    <a href="https://lofipython.com/installing-debian-9-stretch-linux-os-on-a-dell-inspiron-laptop-and-troubleshooting-wifi.html">posted at 14:14</a>
                    &nbsp;&middot;&nbsp;<a href="https://lofipython.com/category/linux-software.html" rel="tag">Linux, software</a>
                    &nbsp;&middot;
                    &nbsp;<a href="https://lofipython.com/tag/computers.html" class="tags">computers</a>
                    &nbsp;<a href="https://lofipython.com/tag/debian.html" class="tags">debian</a>
                    &nbsp;<a href="https://lofipython.com/tag/operating-system.html" class="tags">operating system</a>
                    &nbsp;<a href="https://lofipython.com/tag/os-upgrade.html" class="tags">os upgrade</a>
                    &nbsp;<a href="https://lofipython.com/tag/windows.html" class="tags">Windows</a>
                </div>
            </article>            <h4 class="date">Feb 12, 2019</h4>

            <article class="post">
                <h2 class="title">
                    <a href="https://lofipython.com/lightning-scripts-%e2%9a%a1.html" rel="bookmark" title="Permanent Link to &quot;Lightning Scripts ⚡&quot;">Lightning Scripts ⚡</a>
                </h2>

                
                

                <p>You may or may not be familiar with <a class="reference external" href="https://www.youtube.com/channel/UCsX05-2sVSH7Nx3zuk3NYuQ">PyCon</a>'s <a class="reference external" href="https://pyvideo.org/pycon-us-2010/pycon-2010--plenary--saturday-evening-lightning-t.html">Lightning Talks</a>, a session of quick hitter talks given each year on a variety of topics. These &quot;Lightning Scripts&quot; are ten of my favorite Python scripts that have served me well as of late to perform a variety of tasks.</p>
<p>Highlights include the glob, os, calendar, webbrowser and pandas modules. Plus, how to convert a dataframe into a pdf and how to take a snapshot of a website with pdfkit. The webpage pdf was not the greatest snapshot in some cases, but did capture text and many of a live website's visual elements.</p>
<p>If you have Python installed, paste the script into a text editor and run your .py file from the command line or however you like to run your scripts. You may have to change file paths to work on your operating system.</p>
<div class="section" id="the-first-5-scripts-use-modules-that-ship-with-python">
<h2>The first 5 scripts use modules that ship with Python.</h2>
<p><strong>(1) Uppercase all of the file names in the current working directory.</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="n">filenames</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>
<span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">:</span>
    <span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">filename</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
</pre></div></td></tr></table></div>
<p>os module <a class="reference external" href="https://docs.python.org/3/library/os.html#os.rename">documentation</a></p>
<p><strong>(2) Get all filenames in the current directory and write to a text file.</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="n">folder_contents</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;list_of_dir_files.txt&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fhand</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">folder_contents</span><span class="p">:</span>
        <span class="n">fhand</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;f</span><span class="si">{item}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div></td></tr></table></div>
<p><strong>(3) Check what day of the week is today.</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">import</span> <span class="nn">calendar</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">date</span>
<span class="n">today</span> <span class="o">=</span> <span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span>
<span class="k">if</span> <span class="n">calendar</span><span class="o">.</span><span class="n">day_name</span><span class="p">[</span><span class="n">today</span><span class="o">.</span><span class="n">weekday</span><span class="p">()]</span> <span class="o">==</span> <span class="s1">&#39;Friday&#39;</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Today is Friday.&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Today is not Friday.&quot;</span><span class="p">)</span>
</pre></div></td></tr></table></div>
<p><a class="reference external" href="https://docs.python.org/3/library/calendar.html">calendar documentation</a></p>
<p><strong>(4) Get the two most recent file names from a directory. This is a Windows file path example. I have escaped the backslashes below to make it work in my Atom text editor.</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">getpass</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="c1"># getctime == by created date, getmtime == by date modified</span>
<span class="c1"># get all files, regardless of extension</span>
<span class="n">folder</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;C:/Users/</span><span class="si">{</span><span class="n">getpass</span><span class="o">.</span><span class="n">getuser</span><span class="p">()</span><span class="si">}</span><span class="s1">/Desktop/&#39;</span>
<span class="n">list_of_files</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">folder</span><span class="p">)</span>
<span class="n">newest_file</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">iglob</span><span class="p">(</span><span class="s1">&#39;C:/Users/your_username/Desktop/*.csv&#39;</span><span class="p">),</span> <span class="n">key</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getmtime</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">second_newest_file</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">iglob</span><span class="p">(</span><span class="s1">&#39;C:/Users/your_username/Desktop/*.csv&#39;</span><span class="p">),</span> <span class="n">key</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getmtime</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">newest_file</span><span class="p">,</span> <span class="n">second_newest_file</span><span class="p">)</span>
</pre></div></td></tr></table></div>
<p>glob module documentation: <a class="reference external" href="https://docs.python.org/3/library/glob.html#glob.iglob">https://docs.python.org/3/library/glob.html#glob.iglob</a></p>
<p><strong>(5)  Auto-Hamilton Ticket Lottery</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">import</span> <span class="nn">webbrowser</span>
<span class="n">webbrowser</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;https://www.luckyseat.com/hamilton-chi/&#39;</span><span class="p">,</span> <span class="n">new</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div></td></tr></table></div>
<p>webbrowser PMOTW: <a class="reference external" href="https://pymotw.com/3/webbrowser">https://pymotw.com/3/webbrowser</a></p>
</div>
<div class="section" id="to-run-the-next-3-scripts-install-pandas">
<h2>To Run The Next 3 Scripts, install pandas:</h2>
<pre class="literal-block">
python -m pip install pandas
</pre>
<p><strong>(6) Split a csv file into smaller excel files.</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">file_name</span> <span class="o">=</span> <span class="s1">&#39;big_file.csv&#39;</span>
<span class="c1"># slice off extension</span>
<span class="n">src_file_minus_ext</span> <span class="o">=</span> <span class="n">file_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="mi">250000</span><span class="p">)):</span>
    <span class="n">csv</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">src_file_minus_ext</span><span class="si">}{</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="si">}</span><span class="s1">.csv&#39;</span>
    <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">csv</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div></td></tr></table></div>
<p>pandas beginner tutorial: <a class="reference external" href="https://www.youtube.com/watch?v=5JnMutdy6Fw">https://www.youtube.com/watch?v=5JnMutdy6Fw</a></p>
<p><strong>(7) Convert a .xlsx to .csv</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s2">&quot;input.xlsx&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;output.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div></td></tr></table></div>
<p><strong>(8) Convert a .xlsx to .html</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">file_name</span> <span class="o">=</span> <span class="s2">&quot;data.xlsx&quot;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="s2">&quot;data.html&quot;</span><span class="p">)</span>
</pre></div></td></tr></table></div>
</div>
<div class="section" id="to-run-the-last-two-scripts-install-pdfkit">
<h2>To Run The Last Two Scripts, install pdfkit:</h2>
<p>pdfkit relies on another library, wkhtmltopdf, which adds an extra wrinkle to setting it up for Windows users. I've laid out the differences between using pdfkit for Windows vs. Ubuntu below.</p>
<pre class="literal-block">
python -m pip install pdfkit
</pre>
<p><strong>installing wkhtmltopdf on Windows</strong></p>
<p>To use pdfkit on Windows, go to the link, choose your version to download. This installs a Windows executable that pdfkit needs to find to work.</p>
<pre class="literal-block">
https://wkhtmltopdf.org/downloads.html
</pre>
<p><strong>installing wkhtmltopdf on Ubuntu</strong></p>
<pre class="literal-block">
sudo apt-get install wkhtmltopdf


**For Windows, **\ `download wkhtmltopdf &lt;https://wkhtmltopdf.org/downloads.html&gt;`__\ ** and add this config patch for pdfkit:**
</pre>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">import</span> <span class="nn">pdfkit</span>
<span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://www.hollywoodreporter.com/news/grammys-alicia-keys-best-moments-as-host-1185013&#39;</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">pdfkit</span><span class="o">.</span><span class="n">configuration</span><span class="p">(</span><span class="n">wkhtmltopdf</span><span class="o">=</span><span class="s1">&#39;C:</span><span class="se">\\</span><span class="s1">Program Files</span><span class="se">\\</span><span class="s1">wkhtmltopdf</span><span class="se">\\</span><span class="s1">bin</span><span class="se">\\</span><span class="s1">wkhtmltopdf.exe&#39;</span><span class="p">)</span>
<span class="n">pdfkit</span><span class="o">.</span><span class="n">from_url</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="s1">&#39;webpage.pdf&#39;</span><span class="p">,</span> <span class="n">configuration</span><span class="o">=</span><span class="n">config</span><span class="p">)</span>
</pre></div></td></tr></table></div>
<p><strong>4 Convert a .html file to .pdf. (Add config patch above for Windows.)</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">import</span> <span class="nn">pdfkit</span>
<span class="n">pdfkit</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s1">&#39;data.html&#39;</span><span class="p">,</span> <span class="s1">&#39;report.pdf&#39;</span><span class="p">)</span>
</pre></div></td></tr></table></div>
<p><strong>5 Create a pdf snapshot of a webpage on Ubuntu below. (Add config patch above for Windows.)</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">import</span> <span class="nn">pdfkit</span>
<span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://www.hollywoodreporter.com/news/grammys-alicia-keys-best-moments-as-host-1185013&#39;</span>
<span class="n">pdfkit</span><span class="o">.</span><span class="n">from_url</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="s1">&#39;alicia_keys.pdf&#39;</span><span class="p">)</span>
</pre></div></td></tr></table></div>
<p>pdfkit documentation: <a class="reference external" href="https://pypi.org/project/pdfkit/">https://pypi.org/project/pdfkit/</a></p>
<p><strong>Final Thoughts</strong></p>
<p>I am very pleased with pdfkit. I am also toying around with Python's PyFPDF: <a class="reference external" href="https://pyfpdf.readthedocs.io/en/latest/index.html">https://pyfpdf.readthedocs.io/en/latest/index.html</a> and PyPDF2: <a class="reference external" href="https://pythonhosted.org/PyPDF2">https://pythonhosted.org/PyPDF2</a> libraries. Together, these three offer some unique abilities for creating and manipulating pdf files. And the pandas library is amazing for reading and writing tabular data sheets, can't say enough great things about pandas. Worth the time. Hope you enjoyed these Lightning Scripts :)</p>
</div>

                <div class="clear"></div>

                <div class="info">
                    <a href="https://lofipython.com/lightning-scripts-%e2%9a%a1.html">posted at 06:27</a>
                    &nbsp;&middot;&nbsp;<a href="https://lofipython.com/category/automation-coding-pandas-productivity-programming-scripts.html" rel="tag">automation, coding, pandas, productivity, programming, Scripts</a>
                    &nbsp;&middot;
                    &nbsp;<a href="https://lofipython.com/tag/alicia-keys.html" class="tags">alicia keys</a>
                    &nbsp;<a href="https://lofipython.com/tag/code.html" class="tags">code</a>
                    &nbsp;<a href="https://lofipython.com/tag/computers.html" class="tags">computers</a>
                    &nbsp;<a href="https://lofipython.com/tag/hamilton.html" class="tags">hamilton</a>
                    &nbsp;<a href="https://lofipython.com/tag/lightning-scripts.html" class="tags">lightning scripts</a>
                    &nbsp;<a href="https://lofipython.com/tag/python.html" class="tags">python</a>
                </div>
            </article>            <h4 class="date">Nov 25, 2018</h4>

            <article class="post">
                <h2 class="title">
                    <a href="https://lofipython.com/automated-python-with-windows-task-scheduler.html" rel="bookmark" title="Permanent Link to &quot;Automated Python With Windows Task Scheduler&quot;">Automated Python With Windows Task Scheduler</a>
                </h2>

                
                

                <p><strong>So you want to run your Python scripts automatically, but how?</strong></p>
<p>I had heard of several popular scheduling libraries in Python like <a class="reference external" href="http://www.celeryproject.org/">celery</a>, <a class="reference external" href="https://www.pyinvoke.org/">Invoke</a>, and&nbsp;<a class="reference external" href="https://github.com/dbader/schedule">schedule</a>. One of my requirements is to run the python file &quot;in the background&quot;, not in command prompt or an open window.</p>
<p>Enter Windows Task Scheduler, the de facto scheduler on Windows 7 computers. I have&nbsp; scheduled a few scripts and it is working like a charm. In this post, I will schedule an example script to clean up my desktop at the beginning of each day. I have a habit of accumulating many Excel files there throughout the workday. This example automatically moves them into a folder.</p>
<p>Other Windows scheduling alternatives worth mentioning include <a class="reference external" href="http://thepythoncorner.com/dev/how-to-create-a-windows-service-in-python/">creating a Windows service</a>, or using <a class="reference external" href="https://docs.microsoft.com/en-us/windows/win32/taskschd/schtasks">schtasks</a> if you prefer the command line.</p>
<p><strong>Here's how to schedule a Python script to run:</strong></p>
<ol class="arabic simple">
<li>Search for Windows Task Scheduler in the start menu. Then select &quot;Task Scheduler Library&quot; to see all of the tasks Windows is running automatically.</li>
<li>In the right toolbar, select &quot;Create Basic Task&quot; and give it a name and description. Note: I selected &quot;Configure for: Windows 7, Windows Server 2008 R2&quot;.</li>
</ol>
<img alt="general" class="wp-image-1577 alignright" src="https://pythonmarketer.files.wordpress.com/2018/11/general.png" style="width: 481px; height: 361px;" />
<ol class="arabic simple" start="3">
<li>Set the time and frequency that the program will run in the &quot;Triggers&quot; tab.</li>
<li>Under the &quot;Actions&quot; tab, select &quot;Start a Program&quot; from the dropdown. Under &quot;Program/Script&quot;, enter the path to your Python.exe file. I set mine to a Python executable located within my <a class="reference external" href="https://pythonmarketer.wordpress.com/2018/04/10/creating-isolated-python-environments-with-virtualenv/">virtual environment</a>, but yours might be found wherever you have Python installed.</li>
</ol>
<pre class="literal-block">
C:\Users\your_username\Desktop\36env\Scripts\python.exe
</pre>
<ol class="arabic simple" start="5">
<li>Under &quot;Add arguments (optional)&quot;, add the path to your .py script, within quotes:</li>
</ol>
<pre class="literal-block">
&quot;C:\Users\your_username\Desktop\36env\clean_desktop_excels.py&quot;
</pre>
<img alt="actions" class="alignnone size-full wp-image-1578" src="http://pythonmarketer.files.wordpress.com/2018/11/bd0a9-actions-e1543177551739.png" style="width: 448px; height: 236px;" />
<ol class="arabic simple" start="6">
<li>Select additional conditions and settings as desired, such as &quot;Wake the computer to run this task&quot; and &quot;Run with highest privileges&quot;.</li>
</ol>
<p>I am enjoying this simple, easy and convenient scheduling manager for Windows. I figured most of this out thanks to <a class="reference external" href="https://www.esri.com/arcgis-blog/products/product/analytics/scheduling-a-python-script-or-model-to-run-at-a-prescribed-time/?rmedium=redirect&amp;rsource=/esri/arcgis/2013/07/30/scheduling-a-scrip">this blog</a>. Below is my script to clean my desktop each morning by moving my Excel files into a folder, using Python's stock <a class="reference external" href="https://docs.python.org/3/library/shutil.html">shutil</a> and os libraries. Set it and forget it, ya know what i mean? :D</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">from</span> <span class="nn">shutil</span> <span class="kn">import</span> <span class="n">move</span>
<span class="kn">import</span> <span class="nn">getpass</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># Desktop Spreadsheet File Cleaner: get all Desktop files and folders</span>
<span class="n">src</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;C:/Users/</span><span class="si">{</span><span class="n">getpass</span><span class="o">.</span><span class="n">getuser</span><span class="p">()</span><span class="si">}</span><span class="s2">/Desktop&quot;</span>
<span class="n">dir_items</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>
<span class="n">excel_files</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">dir_items</span> <span class="k">if</span> <span class="s2">&quot;.csv&quot;</span> <span class="ow">in</span> <span class="n">item</span> <span class="ow">or</span> <span class="s2">&quot;.xls&quot;</span> <span class="ow">in</span> <span class="n">item</span><span class="p">]</span>
<span class="n">dst</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;C:/Users/</span><span class="si">{</span><span class="n">getpass</span><span class="o">.</span><span class="n">getuser</span><span class="p">()</span><span class="si">}</span><span class="s2">/Desktop/Excels&quot;</span>
<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">dst</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">xl</span> <span class="ow">in</span> <span class="n">excel_files</span><span class="p">:</span>
    <span class="n">path_to_file</span> <span class="o">=</span> <span class="n">src</span> <span class="o">+</span> <span class="n">xl</span>
    <span class="n">move</span><span class="p">(</span><span class="n">path_to_file</span><span class="p">,</span> <span class="n">dst</span><span class="p">)</span>
</pre></div></td></tr></table></div>
<p><strong>Additional Reading</strong></p>
<p><a class="reference external" href="https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc721846(v=ws.11)?redirectedfrom=MSDN">Troubleshooting Windows Task Scheduler</a> - Windows Documentation</p>

                <div class="clear"></div>

                <div class="info">
                    <a href="https://lofipython.com/automated-python-with-windows-task-scheduler.html">posted at 19:44</a>
                    &nbsp;&middot;&nbsp;<a href="https://lofipython.com/category/automation-productivity-programming-python-windows.html" rel="tag">automation, productivity, programming, python, Windows</a>
                    &nbsp;&middot;
                    &nbsp;<a href="https://lofipython.com/tag/coding.html" class="tags">coding</a>
                    &nbsp;<a href="https://lofipython.com/tag/organization.html" class="tags">organization</a>
                </div>
            </article>            <h4 class="date">Nov 20, 2018</h4>

            <article class="post">
                <h2 class="title">
                    <a href="https://lofipython.com/packaging-python-as-a-windows-app.html" rel="bookmark" title="Permanent Link to &quot;Packaging Python as a Windows App via Pyinstaller&quot;">Packaging Python as a Windows App via Pyinstaller</a>
                </h2>

                
                

                <p>My research found that for creating a single-file Windows executable from a .py file, the front-running Python library is Pyinstaller. It worked on my Windows 7 PC. My program used a <a class="reference external" href="https://pythonmarketer.wordpress.com/2018/08/25/gooey-gui-for-python-scripts/">Gooey GUI</a>, but many of the popular Python GUI libraries work as well.</p>
<p><strong>Installation:</strong></p>
<div class="line-block">
<div class="line">To install, enter this into command your command prompt or terminal:</div>
</div>
<pre class="literal-block">
python -m pip install pyinstaller
</pre>
<div class="line-block">
<div class="line">At the time of this article, this installed Pyinstaller version 3.3.1 using Python version 3.6.5. <a class="reference external" href="https://lofipython.com/how-to-python-pip-install-new-libraries/">Go here</a> for a refresher on setting up pip if you need it.</div>
</div>
<p><strong>Using the build.spec file and starting Pyinstaller:</strong></p>
<p>Most examples I found used a build.spec file. Think of this as the blueprint by which your app will be constructed. It provides the compiling settings, images and any other data necessary for assembling your app. The format for passing the .spec file to Pyinstaller in pseudo-code:</p>
<blockquote>
pyinstaller (run mode options) (.spec file)</blockquote>
<div class="line-block">
<div class="line"><strong>Basic start compiler command to build.spec:</strong></div>
</div>
<pre class="literal-block">
pyinstaller build.spec
</pre>
<p><strong>Establishing a debugging loop with Pyinstaller</strong></p>
<p>Debug mode can be set from the command line:</p>
<pre class="literal-block">
pyinstaller -debug build.spec
</pre>
<p><strong>OR</strong>
by passing debug=True to the EXE() function of the build.spec. I used the second option. See my full build.spec file at the bottom of this post. Pyinstaller displayed a lot of error messages while compiling my app, but it still compiled into a working .exe.</p>
<p><em>To see your app's error message, run the resulting your_app.exe from the command line.</em>
You can find it in the 'dist' folder that pyinstaller creates when you pass it the build.spec file. Set the dist folder as your working directory, type your_app.exe and hit enter. Once you are reading and fixing error messages, you're well on the way to creating your own desktop app.</p>
<p><strong>Flushing sys.stdout/Python printing for Windows:</strong></p>
<p>Python's design requires some code to play nice with Windows when it prints a statement. Simply add this to your .py file. I used write mode 'w'. What worked for me: don't pass 0 to fdopen(). This was contrary to <a class="reference external" href="http://chriskiehl.com/article/packaging-gooey-with-pyinstaller/">Gooey's instructions</a>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="n">nonbuffered_stdout</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">fdopen</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">fileno</span><span class="p">(),</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="n">sys</span><span class="o">.</span><span class="n">stdout</span> <span class="o">=</span> <span class="n">nonbuffered_stdout</span>
</pre></div></td></tr></table></div>
<p><strong>Fetching the local user's system information:</strong></p>
<p>In order to run on any user's system, we need to grab their local file paths. I accomplished this by referencing the sys._MEIPASS via the below code I found from a Stack Overflow post.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><span class="k">def</span> <span class="nf">resource_path</span><span class="p">(</span><span class="n">relative_path</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Get absolute path to resource, works for dev and for PyInstaller&quot;&quot;&quot;</span>
    <span class="n">base_path</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">sys</span><span class="p">,</span> <span class="s1">&#39;_MEIPASS&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_path</span><span class="p">,</span> <span class="n">relative_path</span><span class="p">)</span>

<span class="n">temp_folder_path</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">sys</span><span class="p">,</span> <span class="s1">&#39;_MEIPASS&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>
<span class="n">relative_path</span> <span class="o">=</span> <span class="n">resource_path</span><span class="p">(</span><span class="n">temp_folder_path</span><span class="p">)</span>
</pre></div></td></tr></table></div>
<p><strong>Adding library-specific patches:</strong></p>
<ol class="arabic simple">
<li>Below is the <a class="reference external" href="https://github.com/pyinstaller/pyinstaller/issues/3422">fix</a> I found for the Pandas library, which I added to my build.spec:</li>
</ol>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><span class="n">hiddenimports</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pandas._libs.tslibs.timedeltas&#39;</span><span class="p">,</span><span class="s1">&#39;pandas._libs.tslibs.nattype&#39;</span><span class="p">,</span>
<span class="s1">&#39;pandas._libs.tslibs.np_datetime&#39;</span><span class="p">,</span><span class="s1">&#39;pandas._libs.skiplist&#39;</span><span class="p">]</span>
</pre></div></td></tr></table></div>
<ol class="arabic simple" start="2">
<li>The Gooey library needs some special code added to the build.spec for its images and languages data. More details are found in this <a class="reference external" href="http://chriskiehl.com/article/packaging-gooey-with-pyinstaller/">blog post</a>, written by the author of the Gooey library.</li>
</ol>
<img alt="Will Ferrell Old School" class="wp-image-1535 alignright" src="https://pythonmarketer.files.wordpress.com/2018/11/will_ferrell_composure.jpg" style="width: 293px; height: 216px;" />
<p><strong>Last, but not least: don't panic.</strong></p>
<p>Compiling Python to Windows binary code sounds like a dauntingtask, but it wasn't nearly as complex as I feared. The folks behind Pyinstaller have done a great job of making it possible and, dare I say, simple. Stay calm, drink some coffee, dig in and welcome the challenge with a trial and error mentality. I was able to figure it out over the span of one Saturday. Good luck.</p>
<p><strong>Useful Resources:</strong></p>
<ol class="arabic simple">
<li>Pyinstaller Github - <a class="reference external" href="https://github.com/pyinstaller/pyinstaller/wiki/If-Things-Go-Wrong">If Things Go Wrong</a></li>
<li>Pyinstaller Documentation:<a class="reference external" href="https://pyinstaller.readthedocs.io/en/stable/usage.html">Using Pyinstaller Arguments</a></li>
<li><a class="reference external" href="http://chriskiehl.com/article/packaging-gooey-with-pyinstaller/">Gooey Pyinstaller Instructions</a></li>
<li><a class="reference external" href="https://github.com/pyinstaller/pyinstaller/issues/3422">Pandas hiddenimports Discussion</a></li>
</ol>
<p><strong>Caveats:</strong></p>
<ol class="arabic simple">
<li>You should compile the program on the operating system it will be run on. There are options for creating a multi-os compatible package, but I did not attempt them.</li>
<li>Windows 7 is proven to work with Pyinstaller, per the documentation. It's also what I am running on. Other Windows systems older than Windows 10 may be less reliable.</li>
<li>I experienced trouble when passing arguments from the command line to pyinstaller and have so far been unable to get the console window to hide. Neither the -w, --windowed, --noconsole arguments seemed to work. I will update if I am able to find a solution.</li>
<li>Now that I am testing my compiled app, I am seeing 10x performance slowdowns when running as the final .exe vs. the original .py file. But at least the program runs correctly and still does so relatively quickly.</li>
<li>I also received the error: &quot;Fatal error: Pyinstaller does not include a pre-compiled bootloader for your platform.&quot; I fixed this by upgrading to the latest version of Pyinstaller:</li>
</ol>
<pre class="literal-block">
pip3 install --upgrade pyinstaller
</pre>
<p>My full build.spec file, modified from <a class="reference external" href="http://chriskiehl.com/article/packaging-gooey-with-pyinstaller/">here</a> :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span></pre></div></td><td class="code"><div><pre><span></span><span class="c1"># -*- mode: python -*-</span>
<span class="kn">import</span> <span class="nn">gooey</span>
<span class="n">gooey_root</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">gooey</span><span class="o">.</span><span class="vm">__file__</span><span class="p">)</span>
<span class="n">gooey_languages</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">gooey_root</span><span class="p">,</span> <span class="s1">&#39;languages&#39;</span><span class="p">),</span> <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;gooey/languages&#39;</span><span class="p">)</span>
<span class="n">gooey_images</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">gooey_root</span><span class="p">,</span> <span class="s1">&#39;images&#39;</span><span class="p">),</span> <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;gooey/images&#39;</span><span class="p">)</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">Analysis</span><span class="p">([</span><span class="s1">&#39;your_program.py&#39;</span><span class="p">],</span>
             <span class="n">pathex</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;C:</span><span class="se">\\</span><span class="s1">Python36</span><span class="se">\\</span><span class="s1">Lib</span><span class="se">\\</span><span class="s1">site-packages</span><span class="se">\\</span><span class="s1">your_appdir&#39;</span><span class="p">],</span>
             <span class="n">hiddenimports</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pandas._libs.tslibs.timedeltas&#39;</span><span class="p">,</span> <span class="s1">&#39;pandas._libs.tslibs.np_datetime&#39;</span><span class="p">,</span> <span class="s1">&#39;pandas._libs.tslibs.nattype&#39;</span><span class="p">,</span> <span class="s1">&#39;pandas._libs.skiplist&#39;</span><span class="p">],</span>
             <span class="n">hookspath</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">runtime_hooks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="p">)</span>
<span class="n">options</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;u&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;OPTION&#39;</span><span class="p">)]</span>
<span class="n">a</span><span class="o">.</span><span class="n">datas</span> <span class="o">+=</span> <span class="p">[(</span><span class="s1">&#39;program_icon.ico&#39;</span><span class="p">,</span> <span class="s1">&#39;C:</span><span class="se">\\</span><span class="s1">Python36</span><span class="se">\\</span><span class="s1">Lib</span><span class="se">\\</span><span class="s1">site-packages</span><span class="se">\\</span><span class="s1">your_appdir</span><span class="se">\\</span><span class="s1">program_icon.ico&#39;</span><span class="p">,</span>  <span class="s1">&#39;DATA&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;config_icon.png&#39;</span><span class="p">,</span> <span class="s1">&#39;C:</span><span class="se">\\</span><span class="s1">Python36</span><span class="se">\\</span><span class="s1">Lib</span><span class="se">\\</span><span class="s1">site-packages</span><span class="se">\\</span><span class="s1">your_appdir</span><span class="se">\\</span><span class="s1">config_icon.png&#39;</span><span class="p">,</span><span class="s1">&#39;DATA&#39;</span><span class="p">)]</span>

<span class="n">pyz</span> <span class="o">=</span> <span class="n">PYZ</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">pure</span><span class="p">)</span>
<span class="n">exe</span> <span class="o">=</span> <span class="n">EXE</span><span class="p">(</span><span class="n">pyz</span><span class="p">,</span>
          <span class="n">a</span><span class="o">.</span><span class="n">scripts</span><span class="p">,</span>
          <span class="n">a</span><span class="o">.</span><span class="n">binaries</span><span class="p">,</span>
          <span class="n">a</span><span class="o">.</span><span class="n">zipfiles</span><span class="p">,</span>
          <span class="n">a</span><span class="o">.</span><span class="n">datas</span><span class="p">,</span>
          <span class="n">options</span><span class="p">,</span>
          <span class="n">gooey_languages</span><span class="p">,</span>
          <span class="n">gooey_images</span><span class="p">,</span>
          <span class="n">name</span><span class="o">=</span><span class="s1">&#39;ADD YOUR APP NAME HERE&#39;</span><span class="p">,</span>
          <span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
          <span class="n">strip</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
          <span class="n">upx</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
          <span class="n">console</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
          <span class="n">icon</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;program_icon.ico&#39;</span><span class="p">))</span>
</pre></div></td></tr></table></div>

                <div class="clear"></div>

                <div class="info">
                    <a href="https://lofipython.com/packaging-python-as-a-windows-app.html">posted at 02:59</a>
                    &nbsp;&middot;&nbsp;<a href="https://lofipython.com/category/coding-pandas-python-software.html" rel="tag">coding, pandas, python, software</a>
                    &nbsp;&middot;
                    &nbsp;<a href="https://lofipython.com/tag/app-development.html" class="tags">app development</a>
                    &nbsp;<a href="https://lofipython.com/tag/computers.html" class="tags">computers</a>
                    &nbsp;<a href="https://lofipython.com/tag/programming.html" class="tags">programming</a>
                    &nbsp;<a href="https://lofipython.com/tag/windows.html" class="tags">Windows</a>
                </div>
            </article>            <h4 class="date">Sep 14, 2018</h4>

            <article class="post">
                <h2 class="title">
                    <a href="https://lofipython.com/making-a-python-eyedropper.html" rel="bookmark" title="Permanent Link to &quot;Making A Desktop Color Eyedropper in Python to Grab Color Values&quot;">Making A Desktop Color Eyedropper in Python to Grab Color Values</a>
                </h2>

                
                

                <p><strong>Goal:</strong> recreate my resume in the dark Atom text editor theme
(background and fonts). <strong>Sub-goal:</strong> find a color eyedropper to grab
the actual color values of the Atom layout.</p>
<p><strong>Approach #1: find an Atom eyedropper package to grab the colors.</strong> My
first thought was to find the easiest solution, within the packages of
my Atom text editor. After searching Atom's packages, the two best
potential solutions were &quot;an-color-eyedropper&quot; and &quot;color picker&quot; . The an-color-eyedropper
description sounds perfect: &quot;A simple &quot;real&quot; color picker. By &quot;real&quot; I
mean it's able to pick colors anywhere on any screen.&quot;</p>
<p><a class="reference external" href="https://atom.io/packages/color-picker">Color picker</a>
<a class="reference external" href="https://atom.io/packages/an-color-picker">an color eyedropper</a></p>
<p>Unfortunately it failed to install and displayed the error, &quot;Unable to
download 400 Bad Request Repository inaccessible&quot;. It seems to rely on
the &quot;python&quot; Atom package which is now deprecated. I was unable to find
a repo anywhere by googling.</p>
<p><a class="reference external" href="https://atom.io/packages/color-picker">Color picker</a> has
easy-to-follow instructions and installed with no problem. It allows you
to quickly select any color visually with sliders. Then the RGB or
Hexadecimal values of your color are added as text in the editor in
proper format. However, we are looking for a color grabber to pull
colors from a screen object. This is more of a productivity enhancing
and color exploration tool for programmers. On to Python options.</p>
<p><strong>Approach #2: Use the python tkcolorpicker package to grab the
colors.</strong></p>
<p>The first thing I found on Google was <a class="reference external" href="https://pypi.org/project/tkcolorpicker/">tkcolorpicker</a>, a package that uses the
<a class="reference external" href="https://lofipython.com/2016/02/29/tkinter-and-python-libraries/">tkinter</a>
library. I couldn't tell exactly what it was, so let's find out. First,
install via <a class="reference external" href="https://pythonmarketer.wordpress.com/2018/01/20/how-to-python-pip-install-new-libraries/">pip install</a>:</p>
<pre class="code literal-block">
python -m pip install tkcolorpicker
</pre>
<div class="line-block">
<div class="line">Then run the below script. Cool gadget for sure, but also not quite
what I was looking to use. It allows selection of a color with
sliders or input values, similar to Atom's color picker, but for user
input rather than color picking. Nice little tool. :D</div>
</div>
<div class="line-block">
<div class="line"><img alt="color_picker_gui" class="wp-image-1462 alignright" src="https://pythonmarketer.files.wordpress.com/2018/09/color_picker_gui.png" style="width: 301px; height: 315px;" /></div>
</div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">import</span> <span class="nn">tkinter</span> <span class="k">as</span> <span class="nn">tk</span>
<span class="kn">import</span> <span class="nn">tkinter.ttk</span> <span class="k">as</span> <span class="nn">ttk</span>
<span class="kn">from</span> <span class="nn">tkcolorpicker</span> <span class="kn">import</span> <span class="n">askcolor</span>

<span class="n">root</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Tk</span><span class="p">()</span>
<span class="n">style</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
<span class="n">style</span><span class="o">.</span><span class="n">theme_use</span><span class="p">(</span><span class="s2">&quot;clam&quot;</span><span class="p">)</span>
<span class="n">hex_code</span><span class="p">,</span> <span class="n">RGB_code</span> <span class="o">=</span> <span class="n">askcolor</span><span class="p">((</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">root</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">hex_code</span><span class="p">,</span> <span class="n">RGB_code</span><span class="p">)</span>
<span class="n">root</span><span class="o">.</span><span class="n">mainloop</span><span class="p">()</span>
</pre></div></td></tr></table></div>
<p>askcolor() returns a tuple with both the RGB and hex codes selected by
the user. Above, we are unpacking that tuple into the hex_code and
RGB_code variables.</p>
<p><strong>Approach #3: Use the Python eyedropper package to grab the colors.</strong></p>
<p>I then found <a class="reference external" href="https://github.com/umluizlima/eyedropper">eyedropper</a>
for Windows, which has a minimalist repository and offers a simple
approach to desktop eyedropper functionality. Install eyedropper via
pip:</p>
<pre class="code literal-block">
python -m pip install eyedropper
</pre>
<img alt="pyeyedropper_start" class="size-full wp-image-1458 alignright" src="https://pythonmarketer.files.wordpress.com/2018/09/pyeyedropper_start.png" style="width: 239px; height: 140px;" />
<p>Hover your mouse over the object you want to grab the color from (in my
case, the Atom text editor background). Alternatively, I was able to run
eyedropper from the command line by entering:</p>
<pre class="code literal-block">
py -m eyedropper
</pre>
<img alt="pasted_hex2" class="alignnone size-full wp-image-1461" src="https://pythonmarketer.files.wordpress.com/2018/09/pasted_hex2.png" style="width: 766px; height: 74px;" />
<img alt="CCvOYFiUgAA4DJd" class="alignright" src="https://pythonmarketer.files.wordpress.com/2018/09/ccvoyfiugaa4djd.jpg" style="width: 151px; height: 116px;" />
<p><strong>Mission possible.</strong> Then I hit ctrl+v in a text file and there was the
hex code for my Atom background. Some of the colors that eyedropper
grabbed were nearly identical to those in the Atom text editor dark
theme. Others were not quite the same. I made slight eyeball adjustments
to the colors for some of the fonts.</p>
<div class="section" id="using-python-to-convert-hex-to-rgb-1">
<h2><a class="reference external" href="https://stackoverflow.com/questions/29643352/converting-hex-to-rgb-value-in-python">Using Python to convert hex to RGB</a></h2>
<p>Microsoft Word uses RGB codes but eyedropper gave us hex. To convert, I
found <a class="reference external" href="https://www.webpagefx.com/web-design/hex-to-rgb/">this website</a> practical and
quick. Alternatively, you could <a class="reference external" href="https://stackoverflow.com/questions/29643352/converting-hex-to-rgb-value-in-python">convert a hex code to RGB with python</a>:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><span class="n">hex_code</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Enter hex: &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">)</span>
<span class="n">RGB_code</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">hex_code</span><span class="p">[</span><span class="n">i</span> <span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">16</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;RGB =&quot;</span><span class="p">,</span> <span class="n">RGB_code</span><span class="p">)</span>
</pre></div></td></tr></table></div>
<img alt="rgb_to_hex" class="alignnone size-full wp-image-2308" src="http://pythonmarketer.files.wordpress.com/2018/09/e084c-rgb_to_hex-e1581286493172.jpg" style="width: 805px; height: 83px;" />
<p>Bonus: use pd.read_clipboard()
<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_clipboard.html">docs</a>
to get the hex codes.</p>
<p>Once eyedropper sends the color values to your system's clipboard, there
are multiple ways to access them. This alternative uses pandas.</p>
<p>Installing pandas and <a class="reference external" href="https://github.com/asweigart/pyperclip">pyperclip</a> with pip:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">pip</span> <span class="n">install</span> <span class="n">pandas</span>
<span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">pip</span> <span class="n">install</span> <span class="n">pyperclip</span>
</pre></div></td></tr></table></div>
<p>On Linux, install <a class="reference external" href="https://github.com/astrand/xclip">xclip</a> or <a class="reference external" href="https://askubuntu.com/questions/705620/xclip-vs-xsel">xsel</a></p>
<pre class="literal-block">
sudo apt-get install xclip
</pre>
<p><strong>To get the clipboard contents with pandas:</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">hex_code_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_clipboard</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">hex_code_df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div></td></tr></table></div>
<p><strong>Supplementary Notes and Links</strong></p>
<ul class="simple">
<li>Here's a Python <a class="reference external" href="https://github.com/gigawhitlocks/eyedropper/blob/master/x-color-get.py">eyedropper script</a>
featuring the <a class="reference external" href="https://pillow.readthedocs.io/en/5.2.x/index.html">pillow</a> and <a class="reference external" href="https://github.com/python-xlib/python-xlib">xlib</a> libraries that I was
unable to get working.</li>
<li>I didn't try <a class="reference external" href="http://colorcop.net/">ColorCop for Windows</a>, but it
may be a non-Python alternative.</li>
<li>Did you know? Python 2 had a <a class="reference external" href="https://docs.python.org/2/library/colorpicker.html">ColorPicker</a> module that
is not in Python 3.</li>
<li><a class="reference external" href="https://dev.to/espoir/how-pandas-readclipboard-method-works-ake">How pandas read_clipboard method works</a></li>
<li><a class="reference external" href="https://github.com/pandas-dev/pandas/blob/v1.0.1/pandas/io/clipboards.py#L10-L76">pandas to_clipboard and read_clipboard source code</a></li>
<li>This <a class="reference external" href="https://github.com/Toinane/colorpicker">desktop tool</a> has
great U/X and an eyedropper feature. It runs on Electron, a
Javascript based framework. Coincidentally, Electron was used to
build Atom.</li>
</ul>
</div>

                <div class="clear"></div>

                <div class="info">
                    <a href="https://lofipython.com/making-a-python-eyedropper.html">posted at 05:45</a>
                    &nbsp;&middot;&nbsp;<a href="https://lofipython.com/category/coding-colors-pandas-programming.html" rel="tag">coding, Colors, pandas, programming</a>
                    &nbsp;&middot;
                    &nbsp;<a href="https://lofipython.com/tag/atom.html" class="tags">atom</a>
                    &nbsp;<a href="https://lofipython.com/tag/color.html" class="tags">color</a>
                    &nbsp;<a href="https://lofipython.com/tag/eyedropper.html" class="tags">eyedropper</a>
                    &nbsp;<a href="https://lofipython.com/tag/gui.html" class="tags">gui</a>
                    &nbsp;<a href="https://lofipython.com/tag/python.html" class="tags">python</a>
                </div>
            </article>

                <div class="clear"></div>
                <div class="pages">

                    <a href="https://lofipython.com/index8.html" class="prev_page">&larr;&nbsp;Previous</a>

                    <a href="https://lofipython.com/index10.html" class="next_page">Next&nbsp;&rarr;</a>

                    <span>Page 9 of 12</span>
                </div>

            <div class="clear"></div>
            <footer>
                <p>
                <a href="https://github.com/tcarwash/blue-penguin-dark">Blue Penguin Dark</a> Theme
                &middot;
                Powered by <a href="http://getpelican.com">Pelican</a>
                &middot;
                <a href="https://lofipython.com/feeds/all.atom.xml" rel="alternate">Atom Feed</a>
                &middot;
                <a href="https://lofipython.com/feeds/all.rss.xml" rel="alternate">Rss Feed</a>
            </footer>
        </div>
        <div class="clear"></div>
    </div>
</body>
</html>