<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Lo-Fi Python | articles tagged "coding"</title>
    <link rel="shortcut icon" type="image/png" href="https://lofipython.com/favicon.png">
    <link rel="shortcut icon" type="image/x-icon" href="https://lofipython.com/favicon.ico">
    <link href="https://lofipython.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Lo-Fi Python Full Atom Feed" />
    <link href="https://lofipython.com/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="Lo-Fi Python Full RSS Feed" />
    <link href="https://lofipython.com/feeds/coding.tag.atom.xml" type="application/atom+xml" rel="alternate" title="Lo-Fi Python Tags Atom Feed" />
    <link rel="stylesheet" href="https://lofipython.com/theme/css/main.css" type="text/css" />
    <link rel="stylesheet" href="https://lofipython.com/theme/css/pygments.css" type="text/css" />
    <meta name="generator" content="Pelican" />
    <meta name="description" content="" />
    <meta name="author" content="@erickbytes" />
</head>
<body>
    <header>
        <nav style="overflow: hidden;">
            <ul>
                <li class="ephemeral selected"><a href="https://lofipython.com/tag/coding.html">coding</a></li>
                <li><a href="https://lofipython.com/">Home</a></li>
                <li><a href="feeds/all.rss.xml">RSS</a></li>
                <li><a href="feeds/all.atom.xml">Atom</a></li>
                <li><a href="https://github.com/erickbytes/lofipython">Github</a></li>
            </ul>
        </nav>
        <div class="header_box" style="height: 50px">
        <h1><a href="https://lofipython.com/">
            <image src='images/python-powered-h-140x182.png' class="avatar" width="50px" /><span class="site_title">Lo-Fi Python</span>
            </a></h1></div>
        </div>
    </header>
    <div id="wrapper">
        <div id="content">            <h4 class="date">Sep 07, 2022</h4>

            <article class="post">
                <h2 class="title">
                    <a href="https://lofipython.com/30-external-python-libraries-starter-pack.html" rel="bookmark" title="Permanent Link to &quot;Beyond the Standard Library, An External Python Modules Starter Pack&quot;">Beyond the Standard Library, An External Python Modules Starter Pack</a>
                </h2>

                
                

                <p>Here is a list of external Python modules you can install with <a class="reference external" href="https://pythonmarketer.com/2018/01/20/how-to-python-pip-install-new-libraries/">pip</a>. These are not included with your Python version and need to be installed separately. In some cases, other options may be suitable. To keep the list shorter, I picked libraries that were chosen based on having at least one of these qualities:</p>
<ul class="simple">
<li>most obvious library for its category</li>
<li>a library I have experience using effectively</li>
<li>provide a niche, useful functionality or tool</li>
</ul>
<p><strong>In alphabetical order:</strong></p>
<div class="wp-block-columns docutils container">
</p><div class="wp-block-column docutils container">
</p><ol class="arabic simple">
<li><a class="reference external" href="https://pypi.org/project/black/">black</a>: code formatting</li>
<li><a class="reference external" href="https://pypi.org/project/chardet/">chardet</a>: detect file encoding (useful for reading CSVs)</li>
<li><a class="reference external" href="https://pypi.org/project/diagrams/">diagrams</a>: make cloud architecture diagrams</li>
<li><a class="reference external" href="https://pypi.org/project/Django/">Django</a>: web framework</li>
<li><a class="reference external" href="https://fastapi.tiangolo.com/#installation">fastapi</a>: web framework for building APIs</li>
<li><a class="reference external" href="https://pypi.org/project/ffn/">ffn</a>: financial function library</li>
<li><a class="reference external" href="https://pypi.org/project/Flask/">Flask:</a> web framework</li>
<li><a class="reference external" href="https://pypi.org/project/pygame/">ftfy</a>: fix mojibake in text</li>
<li><a class="reference external" href="https://pypi.org/project/fuzzywuzzy/">fuzzywuzzy</a>: fuzzy matching library</li>
<li><a class="reference external" href="https://pypi.org/project/matplotlib/">matplotlib</a>: data visualization</li>
<li><a class="reference external" href="https://pypi.org/project/numpy/">numpy</a>: array operations</li>
<li><a class="reference external" href="https://pypi.org/project/openpyxl/">openpyxl</a>: foundational Excel library</li>
<li><a class="reference external" href="https://pypi.org/project/pandas/">pandas</a>: working with tabular data</li>
<li><a class="reference external" href="https://pypi.org/project/pelican/">pelican</a>: static site generator</li>
<li><a class="reference external" href="https://github.com/giampaolo/psutil/blob/master/INSTALL.rst">psutil</a>: process and system utilities</li>
<li><a class="reference external" href="https://pypi.org/project/pygame/">pygame</a>: video game creation</li>
<li><a class="reference external" href="https://pypi.org/project/pyodbc/">pyodbc</a>: Open Database Connection client</li>
<li><a class="reference external" href="https://github.com/benfred/py-spy">py-spy</a>: sampling profiler to visualize your program</li>
<li>pyheat: visualize code bottlenecks</li>
<li><a class="reference external" href="https://pypi.org/project/pytest/">pytest</a>: testing framework</li>
<li><a class="reference external" href="https://pypi.org/project/pytrends/">pytrends</a>: research trends in the Google Trends API</li>
<li><a class="reference external" href="https://pypi.org/project/pytube3/">pytube3</a>: YouTube video downloading library</li>
<li><a class="reference external" href="https://pypi.org/project/pywin32/">pywin32</a>: Python for Win32 Extensions</li>
<li><a class="reference external" href="https://pypi.org/project/requests/">requests</a>: HTTP requests</li>
<li><a class="reference external" href="https://pypi.org/project/scikit-learn/">scikit-learn</a>: machine learning</li>
<li><a class="reference external" href="https://pypi.org/project/soltrack/">soltrack</a>: calculate the location of the sun</li>
<li><a class="reference external" href="https://pypi.org/project/sqlfluff/">sqlfluff</a>: SQL linter</li>
<li><a class="reference external" href="https://github.com/streamlit/streamlit">streamlit</a>: build data apps</li>
<li><a class="reference external" href="https://pypi.org/project/tqdm/">tqdm</a>: add a progress bar to loops</li>
<li><a class="reference external" href="https://wxpython.org/pages/downloads/index.html">wxPython</a>: Graphical User Interface</li>
<li><a class="reference external" href="https://pypi.org/project/xlrd/">xlrd</a>: supplementary Excel library</li>
<li><a class="reference external" href="https://pypi.org/project/xmltodict/">xmltodict</a>: convert XML to nested Python dicts</li>
</ol>
</div>
</div>
<p><a class="reference external" href="https://docs.python.org/3/installing/index.html">Python Documentation: Installing Python Modules</a></p>
<div class="wp-image-7164 figure">
<img alt="" src="https://pythonmarketer.files.wordpress.com/2022/09/image.png?w=672" />
</div>

                <div class="clear"></div>

                <div class="info">
                    <a href="https://lofipython.com/30-external-python-libraries-starter-pack.html">posted at 23:46</a>
                    &nbsp;&middot;&nbsp;<a href="https://lofipython.com/category/programming-python.html" rel="tag">programming, python</a>
                    &nbsp;&middot;
                    &nbsp;<a href="https://lofipython.com/tag/advanced-python-modules.html" class="tags">advanced python modules</a>
                    &nbsp;<a href="https://lofipython.com/tag/coding.html" class="tags selected">coding</a>
                    &nbsp;<a href="https://lofipython.com/tag/useful-python-libraries.html" class="tags">useful python libraries</a>
                </div>
            </article>            <h4 class="date">Mar 21, 2020</h4>

            <article class="post">
                <h2 class="title">
                    <a href="https://lofipython.com/automating-pytest-on-windows-with-a-bat-file-python-task-scheduler-and-box.html" rel="bookmark" title="Permanent Link to &quot;Automating pytest on Windows with a .bat file, Python, Task Scheduler and Box&quot;">Automating pytest on Windows with a .bat file, Python, Task Scheduler and Box</a>
                </h2>

                
                

                <p><strong>Automatic pytest Testing and Failure Alert Monitoring</strong></p>
<p>This is my solution to replace manually running pytest each day in command prompt. I want to automate running pytest every day, test if my automated python scripts ran smoothly and get notified if any tests fail.</p>
<p><strong>Installing</strong><a class="reference external" href="https://docs.pytest.org/en/latest/getting-started.html">pytest</a><strong>, a python testing library:</strong></p>
<p><tt class="docutils literal">python <span class="pre">-m</span> pip install pytest</tt></p>
<p><strong>A Few Words on pytest</strong></p>
<p>It is a unit test framework in python. pytest expects you to write each test as a self-contained function. One python file can contain many different test functions.</p>
<p><strong>Writing a Test</strong></p>
<p>Let's use <strong>test_file_date.py</strong> as our test, which uses the <a class="reference external" href="https://docs.python.org/3/library/glob.html">glob</a> module and <a class="reference external" href="https://docs.python.org/2/library/os.path.html#os.path.getmtime">os.getmtime</a> to get the csv with the most recent modification dateon my desktop. Then it tests if that date is today, in my case, for an expected daily file drop.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">date</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">getpass</span>

<span class="k">def</span> <span class="nf">test_csv_date_equals_today</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The dir_query format is for a Windows path with Unix style pattern matching.&quot;&quot;&quot;</span>
    <span class="n">dir_query</span> <span class="o">=</span> <span class="s1">&#39;C:</span><span class="se">\\</span><span class="s1">Users</span><span class="se">\\</span><span class="s1">{getpass.getuser()}</span><span class="se">\\</span><span class="s1">Desktop</span><span class="se">\\</span><span class="s1">*.csv&#39;</span> <span class="c1"># specify csv extension and folder</span>
    <span class="n">file_path</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">iglob</span><span class="p">(</span><span class="n">dir_query</span><span class="p">),</span> <span class="n">key</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getmtime</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># get most recent file</span>
    <span class="n">file_timestamp</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getmtime</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
    <span class="n">file_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">file_timestamp</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">file_date</span><span class="o">.</span><span class="n">day</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">day</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">file_date</span><span class="o">.</span><span class="n">day</span> <span class="o">==</span> <span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">day</span>
</pre></div></td></tr></table></div>
<p><strong>Here's the pytest text output when the test is passing:</strong></p>
<pre class="literal-block">
============================= test session starts =============================
platform win32 -- Python 3.8.1, pytest-5.3.5, py-1.8.1, pluggy-0.13.1
rootdir: C:\
collected 1 item

..\..\Users\martech\Desktop\test_file_date.py . [ 14%]
                                                                   [100%]

============================== 1 passed in 0.28s ==============================
</pre>
<p><strong>Creating a Task with Windows Task Scheduler</strong></p>
<p>If you haven't used python with Windows Task Scheduler before, <a class="reference external" href="https://pythonmarketer.wordpress.com/2018/11/25/automated-python-with-windows-task-scheduler/">my previous post</a> on creating a task may help you. We'll create two of them for our testing system.</p>
<p><strong>Adding Your Task Scheduler Program: a Windows .bat file</strong></p>
<p>Add your username to the text below and adjust the paths to your system. Then save a <a class="reference external" href="https://en.wikipedia.org/wiki/Batch_file">Windows .bat file</a> with this text, which points to your pytest.exe file:</p>
<pre class="literal-block">
cmd /c &quot;C:\Users\your_username\Desktop\VM_Jobs\Scripts\pytest.exe --capture=sys&quot; ^
C:\Users\your_username\Desktop\test_file_date.py &gt; C:\Users\your_username\Desktop\VM_Jobs\Test_Results\Test_Results.txt
</pre>
<p>This example is referencing an .exe within a hypothetical &quot;VM_Jobs&quot; <a class="reference external" href="https://pythonmarketer.wordpress.com/2018/04/10/creating-isolated-python-environments-with-virtualenv/">virtual environment</a>, located on my Desktop. If you have a virtualenv or venv, check the Scripts folder. (Bin on Linux.)</p>
<p><strong>Breaking this out, there are five .bat files parts:</strong></p>
<blockquote>
cmd /c &quot;C:Usersyour_usernameDesktopVM_JobsScriptspytest.exe --capture=sys&quot;</blockquote>
<p>Windows' <a class="reference external" href="https://ss64.com/nt/cmd.html">cmd command</a> takes a program, so we're passing pytest. <a class="reference external" href="https://docs.pytest.org/en/latest/capture.html">The --capture=sys argument</a> tells pytest to capture the test results. <strong>Note:</strong> switching cmd /c to cmd /k forces the terminal to stay open when you are testing your bat file. You can double-click your .bat file to test run it.</p>
<blockquote>
^</blockquote>
<p>circumflex represents a line continuation in Windows batch files for better readability</p>
<blockquote>
C:Usersyour_usernameDesktoptest_file_date.py</blockquote>
<p>Next we're passing our python file as an argument to pytest, testing our file's modified date matches today's date.</p>
<blockquote>
<strong>&gt;</strong></blockquote>
<p>This is a Windows redirect. It redirects the pytest output from sys to a text file, which is the last argument in our .bat file:</p>
<blockquote>
C:Usersyour_usernameDesktopVM_JobsTest_ResultsTest_Results.txt</blockquote>
<p><strong>Browse to select your .bat file for your Windows Task Scheduler task:</strong></p>
<img alt="bat_task" class="alignnone size-full wp-image-2669" src="https://pythonmarketer.files.wordpress.com/2020/03/bat_task.jpg" style="width: 1032px; height: 590px;" />
<p><strong>Reading the Tests and Triggering Alerts</strong></p>
<p>Passing tests signal your scripts are running successfully. When things don't work, email alerts of the failure help us respond quickly.</p>
<p>Let's set another task scheduler job to run <strong>read_test_results.py,</strong> to run a few minutes after the first job each day. See this <a class="reference external" href="https://pythonmarketer.wordpress.com/2018/11/25/automated-python-with-windows-task-scheduler/">example of running Python with Task Scheduler</a> if you haven't triggered a python script from Task Scheduler before.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">date</span>
<span class="kn">import</span> <span class="nn">getpass</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Automate pytest with Windows Task Scheduler - Python Marketer</span>
<span class="sd">http://atomic-temporary-107329037.wpcomstaging.com/2020/03/21/automating-pytest-on-windows-with-a-bat-file-python-task-scheduler-and-box/</span>

<span class="sd">Use Task Scheduler run a batch file.</span>
<span class="sd">The batch file runs pytest and captures our pytest function results to sys.</span>
<span class="sd">If a text file contains a failure or error, write the test contents into a folder.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">user_name</span> <span class="o">=</span> <span class="n">getpass</span><span class="o">.</span><span class="n">getuser</span><span class="p">()</span>
<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span>
    <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;C:</span><span class="se">\\</span><span class="s1">Users</span><span class="se">\\</span><span class="si">{</span><span class="n">user_name</span><span class="si">}</span><span class="se">\\</span><span class="s1">logging</span><span class="se">\\</span><span class="s1">Automated_Testing_Alerts.log&#39;</span><span class="p">,</span>
    <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span>
    <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%(asctime)s</span><span class="s1"> - </span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">,</span>
    <span class="n">datefmt</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">-%b-%y %H:%M:%S&#39;</span>
    <span class="p">)</span>
<span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Checking for failed tests...&quot;</span><span class="p">)</span>

<span class="n">directory</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;C:</span><span class="se">\\</span><span class="s1">Users</span><span class="se">\\</span><span class="si">{</span><span class="n">user_name</span><span class="si">}</span><span class="se">\\</span><span class="s1">Desktop</span><span class="se">\\</span><span class="s1">VM_Jobs</span><span class="se">\\</span><span class="s1">test_results</span><span class="se">\\</span><span class="s1">&#39;</span>
<span class="n">test_results</span> <span class="o">=</span> <span class="p">[</span><span class="n">fname</span> <span class="k">for</span> <span class="n">fname</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span> <span class="k">if</span> <span class="s1">&#39;.txt&#39;</span> <span class="ow">in</span> <span class="n">fname</span><span class="p">]</span>
<span class="k">for</span> <span class="n">txt_file</span> <span class="ow">in</span> <span class="n">test_results</span><span class="p">:</span>
    <span class="n">file_path</span> <span class="o">=</span> <span class="n">directory</span> <span class="o">+</span> <span class="n">txt_file</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="k">if</span> <span class="s1">&#39;FAILURES&#39;</span> <span class="ow">in</span> <span class="n">text</span><span class="p">:</span>
        <span class="n">directory</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;C:</span><span class="se">\\</span><span class="s1">Users</span><span class="se">\\</span><span class="si">{</span><span class="n">user_name</span><span class="si">}</span><span class="se">\\</span><span class="s1">Desktop</span><span class="se">\\</span><span class="s1">VM_Jobs</span><span class="se">\\</span><span class="s1">send_failure_alert</span><span class="se">\\</span><span class="s1">&#39;</span>
        <span class="n">today</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">())</span>
        <span class="n">out_file</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">directory</span><span class="si">}{</span><span class="n">txt_file</span><span class="si">}</span><span class="s1">_Failed_Results_</span><span class="si">{</span><span class="n">today</span><span class="si">}</span><span class="s1">.txt&#39;</span>
        <span class="n">alert_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">out_file</span><span class="p">,</span><span class="s2">&quot;w+&quot;</span><span class="p">)</span>
        <span class="n">alert_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">txt_file</span><span class="p">)</span>
        <span class="n">alert_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="n">alert_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No failed tests found in file:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">txt_file</span><span class="p">)</span>
</pre></div></td></tr></table></div>
<p><strong>Setting up Email Alert Notifications on a Box Folder</strong></p>
<p>The above script checks the test results and creates a file with any failed tests in a different folder. I <a class="reference external" href="https://support.box.com/hc/en-us/articles/360044194073-Manage-Notifications-for-Enterprise-Users">edited the folder's settings</a> to email me when a new file is added, thanks to Box notifications. We use <a class="reference external" href="http://www.box.com">Box</a> for secure file sharing at my day current day job.</p>
<p>Alternatively for those without Box, you could use 'ole trusty <a class="reference external" href="https://docs.python.org/3/library/smtplib.html">smtplib</a> to send the failure alerts with python. I chose the easier, ready to go option. Remember, &quot;<a class="reference external" href="https://zen-of-python.info/simple-is-better-than-complex.html">Simple is better than complex</a>.&quot;</p>
<p>Or the <a class="reference external" href="https://github.com/mhammond/pywin32">pywin32 module</a> has an interface to Outlook that is very handy. For an example of sending a Windows Outlook email, check the very end of <a class="reference external" href="http://pythonmarketer.wordpress.com/2020/05/06/exploring-windows-command-line-tools-batch-file-automation-and-remote-desktop-connection/">this post I wrote on &quot;Scripting Windows Like a Pro&quot;</a>.</p>
<p><strong>We now have an automated testing system with email monitoring alerts if our csv file date test fails, thanks to:</strong></p>
<ul class="simple">
<li>Windows Task Scheduler (two tasks running each day in succession)</li>
<li>python/pytest</li>
<li>a Windows .bat file</li>
<li>Box (or smtplib or pywin32) email alerts</li>
</ul>
<p><strong>In Summation</strong></p>
<ol class="arabic simple">
<li>The first task runs a .bat file to run pytest and create a text file with daily automation test results.</li>
<li>The second task runs a python file. Setting in motion:</li>
<li>Checking the test result text files, looking for failed tests</li>
<li>Creating a text file with any failing tests in a Box folder, if found</li>
<li>Then Box emails me if any test fails.</li>
</ol>
<p><strong>Final Thoughts on the .bat, Man</strong></p>
<p>This was the first time I successfully deployed a Windows batch file. It took me many tries and googling to properly format<a class="reference external image-reference" href="https://www.youtube.com/watch?v=65eDsGY5MTE"><img alt="legobatman" class="wp-image-2704 alignright" src="https://pythonmarketer.files.wordpress.com/2020/03/legobatman.jpg" style="width: 95px; height: 95px;" /></a> the .bat file. They are worth understanding and seem to open up many possibilities on Windows. In this case it was a &quot;glue&quot; piece that allowed me to accomplish my goal, automated testing and alerts for my python scripts.</p>
<p><strong>Life is in the journey.</strong></p>
<p>What we learn along the way shapes us. Learning to use these resources together has been a giant step towards writing more reliable python programs. It has improved my knowledge of Windows OS scripting, which can sometimes be a handy substitute or complement to python. Now, time to write more tests. Thanks for reading!</p>
</p><p><strong>See also:</strong></p>
<p><a class="reference external" href="_wp_link_placeholder">pytest plugins</a></p>
<p><a class="reference external" href="https://pypi.org/project/pytest-csv/">pytest-csv</a>: write test results to a csv with this plugin</p>
<p>I wrote another post compiling peoples' thoughts on testing <a class="reference external" href="https://pythonmarketer.wordpress.com/2019/12/05/a-collection-of-software-testing-opinions-for-python-and-beyond/">here</a>.</p>

                <div class="clear"></div>

                <div class="info">
                    <a href="https://lofipython.com/automating-pytest-on-windows-with-a-bat-file-python-task-scheduler-and-box.html">posted at 01:47</a>
                    &nbsp;&middot;&nbsp;<a href="https://lofipython.com/category/automation-programming-software-testing-windows.html" rel="tag">automation, programming, software testing, Windows</a>
                    &nbsp;&middot;
                    &nbsp;<a href="https://lofipython.com/tag/coding.html" class="tags selected">coding</a>
                    &nbsp;<a href="https://lofipython.com/tag/pytest.html" class="tags">pytest</a>
                    &nbsp;<a href="https://lofipython.com/tag/python.html" class="tags">python</a>
                    &nbsp;<a href="https://lofipython.com/tag/software-development.html" class="tags">software development</a>
                </div>
            </article>            <h4 class="date">Nov 25, 2018</h4>

            <article class="post">
                <h2 class="title">
                    <a href="https://lofipython.com/automated-python-with-windows-task-scheduler.html" rel="bookmark" title="Permanent Link to &quot;Automated Python With Windows Task Scheduler&quot;">Automated Python With Windows Task Scheduler</a>
                </h2>

                
                

                <p><strong>So you want to run your Python scripts automatically, but how?</strong></p>
<p>I had heard of several popular scheduling libraries in Python like <a class="reference external" href="http://www.celeryproject.org/">celery</a>, <a class="reference external" href="https://www.pyinvoke.org/">Invoke</a>, and&nbsp;<a class="reference external" href="https://github.com/dbader/schedule">schedule</a>. One of my requirements is to run the python file &quot;in the background&quot;, not in command prompt or an open window.</p>
<p>Enter Windows Task Scheduler, the de facto scheduler on Windows 7 computers. I have&nbsp; scheduled a few scripts and it is working like a charm. In this post, I will schedule an example script to clean up my desktop at the beginning of each day. I have a habit of accumulating many Excel files there throughout the workday. This example automatically moves them into a folder.</p>
<p>Other Windows scheduling alternatives worth mentioning include <a class="reference external" href="http://thepythoncorner.com/dev/how-to-create-a-windows-service-in-python/">creating a Windows service</a>, or using <a class="reference external" href="https://docs.microsoft.com/en-us/windows/win32/taskschd/schtasks">schtasks</a> if you prefer the command line.</p>
<p><strong>Here's how to schedule a Python script to run:</strong></p>
<ol class="arabic simple">
<li>Search for Windows Task Scheduler in the start menu. Then select &quot;Task Scheduler Library&quot; to see all of the tasks Windows is running automatically.</li>
<li>In the right toolbar, select &quot;Create Basic Task&quot; and give it a name and description. Note: I selected &quot;Configure for: Windows 7, Windows Server 2008 R2&quot;.</li>
</ol>
<img alt="general" class="wp-image-1577 alignright" src="https://pythonmarketer.files.wordpress.com/2018/11/general.png" style="width: 481px; height: 361px;" />
<ol class="arabic simple" start="3">
<li>Set the time and frequency that the program will run in the &quot;Triggers&quot; tab.</li>
<li>Under the &quot;Actions&quot; tab, select &quot;Start a Program&quot; from the dropdown. Under &quot;Program/Script&quot;, enter the path to your Python.exe file. I set mine to a Python executable located within my <a class="reference external" href="https://pythonmarketer.wordpress.com/2018/04/10/creating-isolated-python-environments-with-virtualenv/">virtual environment</a>, but yours might be found wherever you have Python installed.</li>
</ol>
<pre class="literal-block">
C:\Users\your_username\Desktop\36env\Scripts\python.exe
</pre>
<ol class="arabic simple" start="5">
<li>Under &quot;Add arguments (optional)&quot;, add the path to your .py script, within quotes:</li>
</ol>
<pre class="literal-block">
&quot;C:\Users\your_username\Desktop\36env\clean_desktop_excels.py&quot;
</pre>
<img alt="actions" class="alignnone size-full wp-image-1578" src="http://pythonmarketer.files.wordpress.com/2018/11/bd0a9-actions-e1543177551739.png" style="width: 448px; height: 236px;" />
<ol class="arabic simple" start="6">
<li>Select additional conditions and settings as desired, such as &quot;Wake the computer to run this task&quot; and &quot;Run with highest privileges&quot;.</li>
</ol>
<p>I am enjoying this simple, easy and convenient scheduling manager for Windows. I figured most of this out thanks to <a class="reference external" href="https://www.esri.com/arcgis-blog/products/product/analytics/scheduling-a-python-script-or-model-to-run-at-a-prescribed-time/?rmedium=redirect&amp;rsource=/esri/arcgis/2013/07/30/scheduling-a-scrip">this blog</a>. Below is my script to clean my desktop each morning by moving my Excel files into a folder, using Python's stock <a class="reference external" href="https://docs.python.org/3/library/shutil.html">shutil</a> and os libraries. Set it and forget it, ya know what i mean? :D</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">from</span> <span class="nn">shutil</span> <span class="kn">import</span> <span class="n">move</span>
<span class="kn">import</span> <span class="nn">getpass</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Desktop Spreadsheet File Cleaner - Python Marketer</span>
<span class="sd">https://atomic-temporary-107329037.wpcomstaging.com/2018/11/25/automated-python-with-windows-task-scheduler/</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="c1"># Get all Desktop files and folders</span>
<span class="n">src_directory</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;C:</span><span class="se">\\</span><span class="s1">Users</span><span class="se">\\</span><span class="si">{</span><span class="n">getpass</span><span class="o">.</span><span class="n">getuser</span><span class="p">()</span><span class="si">}</span><span class="se">\\</span><span class="s1">Desktop&#39;</span>
<span class="n">dir_items</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">src_directory</span><span class="p">)</span>
<span class="n">excel_files</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">dir_items</span> \
                <span class="k">if</span> <span class="s1">&#39;.csv&#39;</span> <span class="ow">in</span> <span class="n">item</span> <span class="ow">or</span> <span class="s1">&#39;.xls&#39;</span> <span class="ow">in</span> <span class="n">item</span><span class="p">]</span>

<span class="n">dst</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;C:</span><span class="se">\\</span><span class="s1">Users</span><span class="se">\\</span><span class="si">{</span><span class="n">getpass</span><span class="o">.</span><span class="n">getuser</span><span class="p">()</span><span class="si">}</span><span class="se">\\</span><span class="s1">Desktop</span><span class="se">\\</span><span class="s1">Current_Month_Excels&#39;</span>
<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">dst</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">xl</span> <span class="ow">in</span> <span class="n">excel_files</span><span class="p">:</span>
    <span class="n">path_to_file</span> <span class="o">=</span> <span class="n">src_directory</span> <span class="o">+</span> <span class="n">xl</span>
    <span class="n">move</span><span class="p">(</span><span class="n">path_to_file</span><span class="p">,</span> <span class="n">dst</span><span class="p">)</span>
</pre></div></td></tr></table></div>
<p><strong>Additional Reading</strong></p>
<p><a class="reference external" href="https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc721846(v=ws.11)?redirectedfrom=MSDN">Troubleshooting Windows Task Scheduler</a> - Windows Documentation</p>

                <div class="clear"></div>

                <div class="info">
                    <a href="https://lofipython.com/automated-python-with-windows-task-scheduler.html">posted at 19:44</a>
                    &nbsp;&middot;&nbsp;<a href="https://lofipython.com/category/automation-productivity-programming-python-windows.html" rel="tag">automation, productivity, programming, python, Windows</a>
                    &nbsp;&middot;
                    &nbsp;<a href="https://lofipython.com/tag/coding.html" class="tags selected">coding</a>
                    &nbsp;<a href="https://lofipython.com/tag/organization.html" class="tags">organization</a>
                </div>
            </article>

            <div class="clear"></div>
            <footer>
                <p>
                <a href="https://github.com/tcarwash/blue-penguin-dark">Blue Penguin Dark</a> Theme
                &middot;
                Powered by <a href="http://getpelican.com">Pelican</a>
                &middot;
                <a href="https://lofipython.com/feeds/all.atom.xml" rel="alternate">Atom Feed</a>
                &middot;
                <a href="https://lofipython.com/feeds/all.rss.xml" rel="alternate">Rss Feed</a>
            </footer>
        </div>
        <div class="clear"></div>
    </div>
</body>
</html>