<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Python Marketer | articles tagged "json"</title>
    <link rel="shortcut icon" type="image/png" href="../favicon.png">
    <link rel="shortcut icon" type="image/x-icon" href="../favicon.ico">
    <link href="https://pythonmarketer.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Python Marketer Full Atom Feed" />
    <link href="https://pythonmarketer.com/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="Python Marketer Full RSS Feed" />
    <link href="https://pythonmarketer.com/feeds/json.tag.atom.xml" type="application/atom+xml" rel="alternate" title="Python Marketer Tags Atom Feed" />
    <link rel="stylesheet" href="../theme/css/main.css" type="text/css" />
    <link rel="stylesheet" href="../theme/css/pygments.css" type="text/css" />
    <meta name="generator" content="Pelican" />
    <meta name="description" content="" />
    <meta name="author" content="@erickbytes" />
</head>
<body>
    <header>
        <nav style="overflow: hidden;">
            <ul>
                <li class="ephemeral selected"><a href="../tag/json.html">json</a></li>
                <li><a href="../">Home</a></li>
                <li><a href="feeds/all.rss.xml">RSS</a></li>
                <li><a href="feeds/all.atom.xml">Atom</a></li>
                <li><a href="https://github.com/erickbytes/divbull">Github</a></li>
            </ul>
        </nav>
        <div class="header_box" style="height: 50px">
        <h1><a href="../">
            <image src='images/python-powered-h-140x182.png' class="avatar" width="50px" /><span class="site_title">Python Marketer</span>
            </a></h1></div>
        </div>
    </header>
    <div id="wrapper">
        <div id="content">            <h4 class="date">Jan 10, 2022</h4>

            <article class="post">
                <h2 class="title">
                    <a href="../pretty-print-the-ea-sports-fifa-ultimate-team-json-with-jq-curl.html" rel="bookmark" title="Permanent Link to &quot;Analyzing Messi vs. Ronaldo with the FIFA API + jq + curl&quot;">Analyzing Messi vs. Ronaldo with the FIFA API + jq + curl</a>
                </h2>

                
                

                <p><code>&lt;!-- wp:paragraph --&gt;</code></p>
<p>Who is the world's greatest footballer, Messi or Ronaldo? EA Sports surely has calculated the answer to this question in their player ratings. They rate peak Crisitiano Ronaldo, Lionel Messi and Luka Modrić at 99 overall, with Neymar and Lewandowski at 98. Anecdotally, Messi has won 7 <a href="https://www.topendsports.com/sport/soccer/list-player-of-the-year-ballondor.htm">Ballon d'Or</a>, the highest individual football honor one can achieve each year. Ronaldo has won 5 B'allon d'Or. Modrić has won 1 Ballon d'Or. Lewandowski was runner up this year, but has never won the honor. Neymar has never won a Ballon d'Or.</p>
<p><code>&lt;!-- /wp:paragraph --&gt;</code></p>
<p><code>&lt;!-- wp:paragraph --&gt;</code></p>
<p>In <a href="https://www.ea.com/games/fifa/fifa-22">FIFA</a>, a player's video game representation is modeled intricately in a series of traits and specialties characterizing each player. The <a href="https://www.easports.com/fifa/ultimate-team/api/fut/item">"Ultimate Team" EA Sports API</a> is viewable as a plain json page or more cheekily with one line of <a href="https://curl.se/">curl</a> and <a href="https://github.com/stedolan/jq">jq, a "command line json processor"</a>:</p>
<p><code>&lt;!-- /wp:paragraph --&gt;</code></p>
<p><code>&lt;!-- wp:preformatted --&gt;</code></p>
<div class="highlight"><pre><span></span><code>curl &#39;https://www.easports.com/fifa/ultimate-team/api/fut/item&#39; | jq &#39;.&#39;
</code></pre></div>

<p><code>&lt;!-- /wp:preformatted --&gt;</code></p>
<p><code>&lt;!-- wp:paragraph --&gt;</code></p>
<p>Enter this in a <a href="https://missing.csail.mit.edu/2020/shell-tools/">shell</a> or <a href="https://github.com/jlevy/the-art-of-command-line">command line</a>. The result is beautiful, readable, pretty printed json!</p>
<p><code>&lt;!-- /wp:paragraph --&gt;</code></p>
<p><code>&lt;!-- wp:heading {"level":3} --&gt;</code></p>
<h3 id="messi-left-vs-ronaldo-right-fifa-player-ratings">Messi (Left) Vs. Ronaldo (Right) FIFA Player Ratings</h3>
<p><code>&lt;!-- /wp:heading --&gt;</code></p>
<p><code>&lt;!-- wp:jetpack/tiled-gallery {"columnWidths":[["53.33045","46.66955"]],"ids":[6511,6514]} --&gt;</code></p>
<p>::: {.wp-block-jetpack-tiled-gallery .aligncenter .is-style-rectangular}
::: tiled-gallery__gallery
::: tiled-gallery__row
::: {.tiled-gallery__col style="flex-basis:53.33045%;"}
<img alt="" amp-layout="responsive" data-height="923" data-id="6511" data-link="https://pythonmarketer.com/messi-fifa-attributes-cropped/" data-width="433" src="https://pythonmarketer.files.wordpress.com/2022/01/messi-fifa-attributes-cropped.png" url="https://pythonmarketer.files.wordpress.com/2022/01/messi-fifa-attributes-cropped.png?w=433">
:::</p>
<p>::: {.tiled-gallery__col style="flex-basis:46.66955%;"}
<img alt="" amp-layout="responsive" data-height="955" data-id="6514" data-link="https://pythonmarketer.com/ronaldo-attributes-fifa/" data-width="392" src="https://pythonmarketer.files.wordpress.com/2022/01/ronaldo-attributes-fifa.png" url="https://pythonmarketer.files.wordpress.com/2022/01/ronaldo-attributes-fifa.png?w=392">
:::
:::
:::
:::</p>
<p><code>&lt;!-- /wp:jetpack/tiled-gallery --&gt;</code></p>
<p><code>&lt;!-- wp:paragraph --&gt;</code></p>
<p>These ratings represent the players at their peak of their careers. Messi is a better dribbler, while Ronaldo has more power and strength. Messi has the edge in free kicks, curve in his shot and "longshots" 99 to 98 over Cristiano. They are tied at "finishing", each with 99. Ronaldo has the "Power Free-Kick" trait, whereas Messi has "Chip Shot", "Finesse Shot" and "Playmaker" traits giving him an edge.</p>
<p><code>&lt;!-- /wp:paragraph --&gt;</code></p>
<p><code>&lt;!-- wp:paragraph --&gt;</code></p>
<p>EA's ratings suggest that both are prominent goal scorers, with a slight edge to Messi in finesse and shooting from distance. However, there's something to be said for kicking the ball really damn hard. Ronaldo has superior raw shot power and a lethal combo of more powerful jump and stronger headers. All this combined with an "Aerial Threat" specialty enables Ronaldo to vault above and around defenders to smash in golazos off the volley. Ronaldo sizes up to 6' 2" (187 cm) vs. Messi's 5' 7" (170 cm) frame. This Portugese man definitely has an advantage in getting higher in the air. But the Argentinian is quite darty.</p>
<p><code>&lt;!-- /wp:paragraph --&gt;</code></p>
<p><code>&lt;!-- wp:embed {"url":"https://www.instagram.com/p/Cc59jtvjk_0/","type":"rich","providerNameSlug":"instagram","responsive":true} --&gt;</code></p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nx">figure</span><span class="w"> </span><span class="kd">class</span><span class="p">=</span><span class="s">&quot;wp-block-embed is-type-rich is-provider-instagram wp-block-embed-instagram&quot;</span><span class="p">&gt;</span>
</code></pre></div>

<p>::: wp-block-embed__wrapper
https://www.instagram.com/p/Cc59jtvjk_0/
:::</p>
<div class="highlight"><pre><span></span><code>&lt;figcaption&gt;
</code></pre></div>

<p>Messi has incredible accuracy from distance.</p>
<div class="highlight"><pre><span></span><code>&lt;/figcaption&gt;
</code></pre></div>

<div class="highlight"><pre><span></span><code>&lt;/figure&gt;
</code></pre></div>

<p><code>&lt;!-- /wp:embed --&gt;</code></p>
<p><code>&lt;!-- wp:paragraph --&gt;</code></p>
<p>Messi is a better passer all around and has perfect "vision", great qualities for winning football games. Only in crossing does he have a lower passing rating. Ronaldo is also 10 points better at "penalties" or penalty kicks. The closer he gets to the goal, the more dangerous he is. Messi is more dangerous with the ball while dribbling, passing or shooting except when taking a PK.</p>
<p><code>&lt;!-- /wp:paragraph --&gt;</code></p>
<p><code>&lt;!-- wp:paragraph --&gt;</code></p>
<p>Advantages can be gained in many different aspects of soccer. EA has developed a fun dataset to model these all time greats across several football skill dimensions. In <a href="https://www.ea.com/en-gb/games/fifa/fifa-22/ratings/ratings-database">2022's version of the game</a>, Messi is rated a 93, with Cristiano 91. Clearly these two are worthy of top honors. Don't forget Robert Lewandowski, with a 92 rating, who consistently lights up the Champions League and Bundesliga.</p>
<p><code>&lt;!-- /wp:paragraph --&gt;</code></p>
<p><code>&lt;!-- wp:paragraph --&gt;</code></p>
<p><strong>jq ftw</strong></p>
<p><code>&lt;!-- /wp:paragraph --&gt;</code></p>
<p><code>&lt;!-- wp:paragraph --&gt;</code></p>
<p>I had never used jq before this. Really enjoyed the quick, stylish and practical view of some json. This cool terminal display and syntax highlighting was on my Chromebook shell. It's neat how easily you can pretty print json with jq. I rate it a 99 for json pretty printing on the FIFA scale. Read more in the <a href="https://stedolan.github.io/jq/tutorial/">jq documentation</a>!</p>
<p><code>&lt;!-- /wp:paragraph --&gt;</code></p>
                <div class="clear"></div>

                <div class="info">
                    <a href="../pretty-print-the-ea-sports-fifa-ultimate-team-json-with-jq-curl.html">posted at 23:15</a>
                    &nbsp;&middot;&nbsp;<a href="../category/command-prompt-productivity.html" rel="tag">command prompt, productivity</a>
                    &nbsp;&middot;
                    &nbsp;<a href="../tag/command-line.html" class="tags">command line</a>
                    &nbsp;<a href="../tag/data.html" class="tags">data</a>
                    &nbsp;<a href="../tag/fifa.html" class="tags">fifa</a>
                    &nbsp;<a href="../tag/football.html" class="tags">football</a>
                    &nbsp;<a href="../tag/jq.html" class="tags">jq</a>
                    &nbsp;<a href="../tag/json.html" class="tags selected">json</a>
                </div>
            </article>            <h4 class="date">Dec 21, 2019</h4>

            <article class="post">
                <h2 class="title">
                    <a href="../copying-a-csv-file-to-google-sheets-with-pygsheets.html" rel="bookmark" title="Permanent Link to &quot;Copying a pandas Dataframe to Google Sheets with pygsheets&quot;">Copying a pandas Dataframe to Google Sheets with pygsheets</a>
                </h2>

                
                

                <blockquote>
<p><strong>Disclaimer</strong>: This endeavor was before I discovered <a href="https://developers.google.com/apps-script">AppScript</a>, which may be an alternative solution to using pygsheets or other python libraries. pygsheets is interesting, but it could be a stretch to justify using it for something that could be done with AppScript. Both are ways to solve a problem by automating Google Sheet operations.</p>
</blockquote>
<p><strong>This was done on the Windows 7 OS.</strong> <strong>First, <a href="https://docs.python.org/3/installing/index.html">install libraries with pip</a>. Enter in command prompt or terminal:</strong></p>
<ol>
<li><code>python -m pip install pandas</code></li>
<li><code>python -m pip install numpy</code></li>
<li><code>python -m pip install pygsheets</code></li>
</ol>
<p><strong>Then, following the</strong> <strong><a href="https://pygsheets.readthedocs.io/en/stable/authorization.html">steps documented by pygsheets:</a></strong></p>
<ol>
<li>Create a Google Developer Account at <a href="http://console.developers.google.com">console.developers.google.com</a></li>
<li><a href="https://pygsheets.readthedocs.io/en/stable/authorization.html">Enable Sheets API</a> to account</li>
<li>Enable Drive API to account. Same as last step, but search for Drive.</li>
<li>Create a Client Secret json file. Select "Credentials" tab, and "Create Credentials". Select Client Secret from options. Export from console and place in same directory as your .py file.</li>
<li>Create a Service Account json file by selecting it instead of "Client Secret".</li>
<li>Authorize pygsheets with your json files. (See below.)</li>
<li>Copy spreadsheet to Google Sheet with pandas and pygsheets. (See below.)</li>
</ol>
<p><strong>After completing the first 5 steps, import pygsheets and authorize your account with the client secret json file:</strong></p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">pygsheets</span>
<span class="n">gc</span> <span class="o">=</span> <span class="n">pygsheets</span><span class="o">.</span><span class="n">authorize</span><span class="p">(</span><span class="n">client_secret</span><span class="o">=</span><span class="s1">&#39;path/to/client_secret[...].json&#39;</span><span class="p">)</span>
</code></pre></div>

<p>You will be prompted by the terminal to go to a hyperlink in a browser, get your authorization code, and enter that authorization code into the terminal.</p>
<p><strong>Now, import both libraries needed and switch to authorize with your service json file. Then, load the csv to a dataframe with pandas. Finally, copy it to an existing Google Sheet with pygsheets:</strong></p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">pygsheets</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="sd">&quot;&quot;&quot;Select worksheets by id, index, or title.&quot;&quot;&quot;</span>
<span class="n">gc</span> <span class="o">=</span> <span class="n">pygsheets</span><span class="o">.</span><span class="n">authorize</span><span class="p">(</span><span class="n">service_file</span><span class="o">=</span><span class="s1">&#39;path/to/service_account_credentials.json&#39;</span><span class="p">)</span> 
<span class="n">sh</span> <span class="o">=</span> <span class="n">gc</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;add_google_sheet_name_here&#39;</span><span class="p">)</span>
<span class="n">wks</span> <span class="o">=</span> <span class="n">sh</span><span class="o">.</span><span class="n">worksheet_by_title</span><span class="p">(</span><span class="s1">&#39;add_sheet_tab_name_here&#39;</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot;Set a pandas dataframe to google sheet, starting at 1st row, 1st column&quot;&quot;&quot;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;Example_Data.csv&#39;</span><span class="p">)</span> 
<span class="n">wks</span><span class="o">.</span><span class="n">set_dataframe</span><span class="p">(</span><span class="n">df</span><span class="p">,(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</code></pre></div>

<p><strong>[Example] Split and upload a sheet with 40 columns</strong></p>
<p>Google Sheets limits importing to 26 columns and 1,000 rows at a time. So you'll have to load the sheets in chunks if you have more than that. This approach uses numpy's <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.array_split.html">array_split</a>:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">pygsheets</span> 
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">gc</span> <span class="o">=</span> <span class="n">pygsheets</span><span class="o">.</span><span class="n">authorize</span><span class="p">(</span><span class="n">client_secret</span><span class="o">=</span><span class="s1">&#39;path/to/client_secret[...].json&#39;</span><span class="p">)</span>
<span class="n">sh</span> <span class="o">=</span> <span class="n">gc</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;add_google_sheet_name_here&#39;</span><span class="p">)</span> 
<span class="n">wks</span> <span class="o">=</span> <span class="n">sh</span><span class="o">.</span><span class="n">worksheet_by_title</span><span class="p">(</span><span class="s1">&#39;add_sheet_tab_name_here&#39;</span><span class="p">)</span> 
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;Data_to_GSheets.csv&#39;</span><span class="p">)</span>

<span class="c1"># split columns into two dataframes with numpy and pandas</span>
<span class="n">first_half_cols</span><span class="p">,</span> <span class="n">second_half_cols</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="kp">array_split</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">first_half</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">first_half_cols</span><span class="p">]</span>
<span class="n">second_half</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">second_half_cols</span><span class="p">]</span>

<span class="c1"># set both dataframes side-by-side in Google sheet</span>
<span class="n">wks</span><span class="o">.</span><span class="n">set_dataframe</span><span class="p">(</span><span class="n">first_half</span><span class="p">,(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">start_column</span> <span class="o">=</span> <span class="n">first_half</span><span class="o">.</span><span class="kp">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">wks</span><span class="o">.</span><span class="n">set_dataframe</span><span class="p">(</span><span class="n">second_half</span><span class="p">,(</span><span class="mi">1</span><span class="p">,</span> <span class="n">start_column</span><span class="p">))</span>
</code></pre></div>

<p><strong>Conclusion</strong></p>
<p>I found the terminal error messages from pygsheets to be very helpful while debugging the above. This module offers many other nifty spreadsheet operations. Solid library. You can now create and edit Google Sheets with Python.</p>
<p>AppsScript should probably be the default tool when working with Google Sheets because it is built in, but Python does have tools available to work with Google Sheets.</p>
<p><strong>Resources</strong></p>
<p><a href="https://github.com/nithinmurali/pygsheets">pygsheets Github</a></p>
<p><a href="https://pygsheets.readthedocs.io/en/stable/authorization.html">pygsheets Documentation</a></p>
<p><a href="https://developers.google.com/sheets/api/guides/concepts">Google Sheets Documentation</a></p>
<p><a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_csv.html">pandas Documentation</a></p>
                <div class="clear"></div>

                <div class="info">
                    <a href="../copying-a-csv-file-to-google-sheets-with-pygsheets.html">posted at 18:58</a>
                    &nbsp;&middot;&nbsp;<a href="../category/automation-coding-excel-google-pandas.html" rel="tag">automation, coding, excel, Google, pandas</a>
                    &nbsp;&middot;
                    &nbsp;<a href="../tag/api.html" class="tags">api</a>
                    &nbsp;<a href="../tag/google-api.html" class="tags">google api</a>
                    &nbsp;<a href="../tag/google-sheets.html" class="tags">google sheets</a>
                    &nbsp;<a href="../tag/json.html" class="tags selected">json</a>
                    &nbsp;<a href="../tag/python.html" class="tags">python</a>
                    &nbsp;<a href="../tag/spreadsheets.html" class="tags">spreadsheets</a>
                </div>
            </article>

            <div class="clear"></div>
            <footer>
                <p>
                <a href="https://github.com/tcarwash/blue-penguin-dark">Blue Penguin Dark</a> Theme
                &middot;
                Powered by <a href="http://getpelican.com">Pelican</a>
                &middot;
                <a href="../feeds/all.atom.xml" rel="alternate">Atom Feed</a>
                &middot;
                <a href="../feeds/all.rss.xml" rel="alternate">Rss Feed</a>
            </footer>
        </div>
        <div class="clear"></div>
    </div>
</body>
</html>