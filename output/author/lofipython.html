<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Lo-Fi Python | Articles by lofipython</title>
    <link rel="shortcut icon" type="image/png" href="https://lofipython.com/favicon.png">
    <link rel="shortcut icon" type="image/x-icon" href="https://lofipython.com/favicon.ico">
    <link href="https://lofipython.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Lo-Fi Python Full Atom Feed" />
    <link href="https://lofipython.com/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="Lo-Fi Python Full RSS Feed" />
    <link rel="stylesheet" href="https://lofipython.com/theme/css/main.css" type="text/css" />
    <link rel="stylesheet" href="https://lofipython.com/theme/css/pygments.css" type="text/css" />
    <meta name="generator" content="Pelican" />
    <meta name="description" content="" />
    <meta name="author" content="@erickbytes" />
</head>
<body>
    <header>
        <nav style="overflow: hidden;">
            <ul>

                <li class="ephemeral selected"><a href="https://lofipython.com/author/lofipython.html">lofipython</a></li>
                <li><a href="https://lofipython.com/">Home</a></li>
                <li><a href="feeds/all.rss.xml">RSS</a></li>
                <li><a href="feeds/all.atom.xml">Atom</a></li>
                <li><a href="https://github.com/erickbytes/lofipython">Github</a></li>
            </ul>
        </nav>
        <div class="header_box" style="height: 50px">
        <h1><a href="https://lofipython.com/">
            <image src='images/python-powered-h-140x182.png' class="avatar" width="50px" /><span class="site_title">Lo-Fi Python</span>
            </a></h1></div>
        </div>
    </header>
    <div id="wrapper">
        <div id="content">            <h4 class="date">Feb 09, 2024</h4>

            <article class="post">
                <h2 class="title">
                    <a href="https://lofipython.com/ways-to-free-up-disk-space-on-your-computer.html" rel="bookmark" title="Permanent Link to &quot;Ways to Free Up Disk Space on Your Computer for Python Developers&quot;">Ways to Free Up Disk Space on Your Computer for Python Developers</a>
                </h2>

                
                

                <p>Below are some ways to free up disk space on your computer. This will be most helpful
for Ubuntu users and Python developers. The pip examples show what I used on my Python
version 3.11, so if you're running a different version use that number, like
pip3.12, pip3.10, pip3.9, etc.</p>
<p><strong>Benchmark your current disk space.</strong></p>
<p>Before you start freeing up space, you might want to see the current state of your
hard drive. You can print human readable disk space stats on Ubuntu with the df command.</p>
<pre class="code console literal-block">
<span class="go">df -h</span>
</pre>
<img alt="read disk space stats on Ubuntu" src="https://lofipython.com/images/readdiskspacedfh.png" />
<p>Alternatively, here is a Python script that reads available disk space from your hard drive.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">import</span> <span class="nn">shutil</span>

<span class="k">def</span> <span class="nf">readable_format</span><span class="p">(</span><span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts a bytes integer to a human-readable format.</span>

<span class="sd">    Args:</span>
<span class="sd">        size (int): The bytes integer to convert.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The human-readable format of the bytes integer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">unit</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;KB&quot;</span><span class="p">,</span> <span class="s2">&quot;MB&quot;</span><span class="p">,</span> <span class="s2">&quot;GB&quot;</span><span class="p">,</span> <span class="s2">&quot;TB&quot;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">size</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">size</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">unit</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">size</span> <span class="o">/=</span> <span class="mi">1000</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">size</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> PB&quot;</span>


<span class="k">def</span> <span class="nf">disk_space</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the current total, used and free disk space in bytes.&quot;&quot;&quot;</span>
    <span class="n">usage</span> <span class="o">=</span> <span class="n">shutil</span><span class="o">.</span><span class="n">disk_usage</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="n">total_space</span> <span class="o">=</span> <span class="n">usage</span><span class="o">.</span><span class="n">total</span>
    <span class="n">used_space</span> <span class="o">=</span> <span class="n">usage</span><span class="o">.</span><span class="n">used</span>
    <span class="n">free_space</span> <span class="o">=</span> <span class="n">usage</span><span class="o">.</span><span class="n">free</span>
    <span class="k">return</span> <span class="n">total_space</span><span class="p">,</span> <span class="n">used_space</span><span class="p">,</span> <span class="n">free_space</span>


<span class="c1"># Call the function with the current directory (you can specify a different path)</span>
<span class="n">total_space</span><span class="p">,</span> <span class="n">used_space</span><span class="p">,</span> <span class="n">free_space</span> <span class="o">=</span> <span class="n">disk_space</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total space: </span><span class="si">{</span><span class="n">readable_format</span><span class="p">(</span><span class="n">total_space</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Used space: </span><span class="si">{</span><span class="n">readable_format</span><span class="p">(</span><span class="n">used_space</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Free space: </span><span class="si">{</span><span class="n">readable_format</span><span class="p">(</span><span class="n">free_space</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div></td></tr></table></div>
<pre class="code console literal-block">
<span class="go">Total space: 21.47 GB
Used space: 10.34 GB
Free space: 10.50 GB</span>
</pre>
<p><strong>Clear your browser cache.</strong></p>
<img alt="read disk space stats on Ubuntu" src="https://lofipython.com/images/clearchromecache.png" />
<p><strong>Purge your pip cache.</strong></p>
<p>Before purging the Python pip package manager's cache, you can use the pip cache info command to see how much
storage is consumed by the cache.</p>
<pre class="code console literal-block">
<span class="go">pip3.11 cache info</span>
</pre>
<p>Next, use the <a class="reference external" href="https://pip.pypa.io/en/stable/cli/pip_cache/">pip cache purge command</a>
to clear up space on your system. Pip will print how many files it removed to the terminal.</p>
<pre class="code console literal-block">
<span class="go">pip3.11 cache purge</span>
</pre>
<img alt="clear the pip package manager cache" src="https://lofipython.com/images/pipcachepurge.png" />
<p><strong>Uninstall unnecessary Python libraries.</strong></p>
<p>I tend to build up modules that I installed to see how it works or to quickly test something out,
then never use again. It makes sense to cull your pip installed libraries occasionally.
Be aware that sometimes an unknown module may be a required dependency of a module
you want to use. First, use the pip list command to see your installed libraries:</p>
<pre class="code console literal-block">
<span class="go">pip3.11 list</span>
</pre>
<img alt="view pip installed libraries" src="https://lofipython.com/images/piplist.png" />
<p>The pip uninstall command makes removing Python libraries easy.
For example, let's say you're already using both the ruff Python linter and black.
The ruff module recently introduced a new formatter that is more or less identical
to Black. Therefore, I can uninstall black and use ruff format command instead
to format my code.</p>
<pre class="code console literal-block">
<span class="go">pip3.11 uninstall black</span>
</pre>
<p>If you're not sure about a package, use the pip show command to learn more about it:</p>
<pre class="code console literal-block">
<span class="go">pip3.11 show ruff</span>
</pre>
<img alt="view info about a Python library with pip" src="https://lofipython.com/images/pipshowruff.png" />
<p><strong>Run the autoremove Linux command.</strong></p>
<blockquote>
autoremove is used to remove packages that were automatically installed to satisfy
dependencies for other packages and are now no longer needed as dependencies changed
or the package(s) needing them were removed in the meantime.
- <a class="reference external" href="https://manpages.ubuntu.com/manpages/xenial/man8/apt.8.html">Linux apt Man Pages</a></blockquote>
<pre class="code console literal-block">
<span class="go">sudo apt autoremove</span>
</pre>
<p><strong>Run the clean and autoclean Linux commands.</strong></p>
<pre class="code console literal-block">
<span class="go">sudo apt clean
sudo apt autoclean</span>
</pre>
<p>Read more on Ask Ubuntu: <a class="reference external" href="https://askubuntu.com/questions/3167/what-is-difference-between-the-options-autoclean-autoremove-and-clean">What is the difference between the options &quot;autoclean&quot; &quot;autoremove&quot; and &quot;clean&quot;?</a></p>
<p><strong>Purge unnecessary Linux packages.</strong></p>
<p>First, create a text file with all your installed Linux packages. Then browse the
packages and assess if they can be safely removed.</p>
<pre class="code console literal-block">
<span class="go">apt list --installed &gt; installed_packages.txt</span>
</pre>
<p>You'll free up more space by deleting the largest optional packages. To list your installed
packages in order of their file sizes and priority, you can use dpkg-query:</p>
<pre class="code console literal-block">
<span class="go">dpkg-query -W -f='${Installed-Size;8}\t${Priority}\t${Package}\n' | sort -n -r</span>
</pre>
<p>Once you've targeted a package, learn more about it with the apt show command.
It shows if a package is essential or required, a description and its dependency modules.
Optional packages are generally safe to delete, assuming its not a dependency of
software you're actually using. Any leftover packages will be removed by the autoremove
command if they are &quot;orphaned&quot; after you purge a package.</p>
<pre class="code console literal-block">
<span class="go">apt show &lt;package-name&gt;</span>
</pre>
<img alt="see information about a linux package" src="https://lofipython.com/images/aptshowdash.png" />
<p>If you are certain a Linux package can be deleted, the apt-get purge command removes
a package and all configuration files from your computer. Be careful not to remove
any critical Linux packages.</p>
<pre class="code console literal-block">
<span class="go">sudo apt-get purge &lt;package-name&gt;</span>
</pre>
<p><strong>Find and delete your largest Linux files.</strong></p>
<p>This command prints the largest files on your root Linux file system. Then you can
use the rm command to remove the file. Hint: sometimes PDF files can be deceptively
large and can be good targets to free up space.</p>
<pre class="code console literal-block">
<span class="go">sudo find / -xdev -type f -size +25M -exec du -sh {} ';' | sort -rh | head -n 20
rm ~/large_file.pdf</span>
</pre>
<p>That sums up a few ways Ubuntu users and Python developers can add some extra available
disk space. It can definitely be frustrating to watch an install fail because there's
no more space on your computer. These are a few strategies you can deploy to make room
to operate on a disk space constrained system.</p>

                <div class="clear"></div>

                <div class="info">
                    <a href="https://lofipython.com/ways-to-free-up-disk-space-on-your-computer.html">posted at 14:30</a>
                    &nbsp;&middot;&nbsp;<a href="https://lofipython.com/category/computer-maintenance-python-ubuntu-disk-space.html" rel="tag">computer maintenance, Python, Ubuntu, disk space</a>
                    &nbsp;&middot;
                    &nbsp;<a href="https://lofipython.com/tag/how-to-free-up-disk-space.html" class="tags">how to free up disk space</a>
                    &nbsp;<a href="https://lofipython.com/tag/creating-extra-linux-ubuntu-disk-space.html" class="tags">creating extra linux ubuntu disk space</a>
                    &nbsp;<a href="https://lofipython.com/tag/cleaning-up-disk-space-on-hard-drive.html" class="tags">cleaning up disk space on hard drive</a>
                    &nbsp;<a href="https://lofipython.com/tag/managing-linux-files.html" class="tags">managing linux files</a>
                    &nbsp;<a href="https://lofipython.com/tag/clearing-python-cache-and-libraries.html" class="tags">clearing python cache and libraries</a>
                </div>
            </article>            <h4 class="date">Feb 05, 2024</h4>

            <article class="post">
                <h2 class="title">
                    <a href="https://lofipython.com/adding-city-name-autocomplete-to-a-django-form-with-jquery-ajax.html" rel="bookmark" title="Permanent Link to &quot;Adding City Name Autocomplete to a Django Form With jQuery + AJAX&quot;">Adding City Name Autocomplete to a Django Form With jQuery + AJAX</a>
                </h2>

                
                

                <p>Below is a slightly modified adaptation of the <a class="reference external" href="https://espere.in/Enhance-Your-Django-App:-Step-by-Step-Guide-to-Implementing-Autocomplete-Search-with-jQuery/">Espere.in Step By Step Guide</a>
by Abdulla Fajal. I needed to make a few changes to the code to get things to work.
I also expanded the example to show how I imported cities data to the Django model.
In this post, I'll show how you can use AJAX and <a class="reference external" href="https://jqueryui.com/autocomplete/">jQuery Autocomplete</a>
with a Django model to create a form with city auto-completion.</p>
<p><strong>Add a Model to models.py</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><span class="k">class</span> <span class="nc">City</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">city_name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="s2">&quot;Origen&quot;</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">country</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="s2">&quot;País&quot;</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
</pre></div></td></tr></table></div>
<p><strong>Register the City Model in admin.py</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span>
<span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">City</span>

<span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">City</span><span class="p">)</span>
</pre></div></td></tr></table></div>
<p><strong>Migrate the Django Model</strong></p>
<pre class="code console literal-block">
<span class="go">python manage.py makemigrations City
python manage.py migrate</span>
</pre>
<p><strong>Add Auto-complete TextInput() to forms.py</strong></p>
<p>The key items here are the &quot;id&quot; attribute holding the value &quot;search-input&quot; and
the &quot;name&quot; attribute with value &quot;city_name&quot;. Together, these values will tell jQuery
for which form element to render the autocomplete view and which model field you targeting
to fill into the autocomplete view.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">from</span> <span class="nn">django</span> <span class="kn">import</span> <span class="n">forms</span>
<span class="kn">from</span> <span class="nn">bookings.models</span> <span class="kn">import</span> <span class="n">Booking</span>

<span class="k">class</span> <span class="nc">BookingForm</span><span class="p">(</span><span class="n">forms</span><span class="o">.</span><span class="n">ModelForm</span><span class="p">):</span>
    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Booking</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="s2">&quot;__all__&quot;</span>
        <span class="n">widgets</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;city&quot;</span><span class="p">:</span> <span class="n">forms</span><span class="o">.</span><span class="n">TextInput</span><span class="p">(</span>
                <span class="n">attrs</span><span class="o">=</span><span class="p">{</span>
                    <span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="s2">&quot;form-control&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;search-input&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;city_name&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;placeholder&quot;</span><span class="p">:</span> <span class="s2">&quot;Type to search&quot;</span><span class="p">,</span>
                <span class="p">}</span>
            <span class="p">)</span>
        <span class="p">}</span>
</pre></div></td></tr></table></div>
<p><strong>Download the World Cities Database from Simplemaps</strong></p>
<p>The <a class="reference external" href="https://simplemaps.com/data/world-cities">World Cities Database</a> basic version
is free and allowed for commercial use. In this example, this provides the cities data.</p>
<p><strong>Import the Cities Database to Django Model</strong></p>
<p>Now we need to import the cities to our Django model. I achieved this by running
the below code in the Django shell and entering each line individually. The code was
modified from a <a class="reference external" href="https://stackoverflow.com/questions/2459979/how-to-import-csv-data-into-django-models">Stack Overflow post</a>.
The World Cities data stores the city in the first column (index 0) and the country
in the 5th column (index 4).</p>
<pre class="code console literal-block">
<span class="go">python manage.py shell</span>
</pre>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">from</span> <span class="nn">django.apps</span> <span class="kn">import</span> <span class="n">apps</span>

<span class="n">City</span> <span class="o">=</span> <span class="n">apps</span><span class="o">.</span><span class="n">get_model</span><span class="p">(</span><span class="n">app_label</span><span class="o">=</span><span class="s2">&quot;bookings&quot;</span><span class="p">,</span> <span class="n">model_name</span><span class="o">=</span><span class="s2">&quot;City&quot;</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;worldcities.csv&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">reader</span><span class="p">:</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">created</span> <span class="o">=</span> <span class="n">City</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get_or_create</span><span class="p">(</span><span class="n">city</span><span class="o">=</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">country</span><span class="o">=</span><span class="n">row</span><span class="p">[</span><span class="mi">4</span><span class="p">],)</span>
</pre></div></td></tr></table></div>
<img alt="running Python in the Django shell" src="https://lofipython.com/images/djangoshell.png" />
<p><strong>View Your City Model in the Admin Panel</strong></p>
<p>Enter the below command to start your local Django development server. Then you
can go to <a class="reference external" href="http://127.0.0.1:8000/admin">http://127.0.0.1:8000/admin</a> in a web browser to see your model on the back-end.</p>
<pre class="code console literal-block">
<span class="go">python manage.py runserver</span>
</pre>
<p><strong>Add jQuery Scripts to HTML File</strong></p>
<p>Add the jquery import scripts to your HTML &lt;head&gt; tag.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><span class="o">&lt;</span><span class="nx">link</span><span class="w"> </span><span class="nx">rel</span><span class="o">=</span><span class="s2">&quot;stylesheet&quot;</span><span class="w"> </span><span class="nx">href</span><span class="o">=</span><span class="s2">&quot;https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css&quot;</span><span class="w"> </span><span class="nx">type</span><span class="o">=</span><span class="s2">&quot;text/css&quot;</span><span class="w"> </span><span class="nx">media</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="w"> </span><span class="o">/&gt;</span>

<span class="c">&lt;!--</span><span class="w"> </span><span class="nx">Add</span><span class="w"> </span><span class="nx">jQuery</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">jQuery</span><span class="w"> </span><span class="nx">UI</span><span class="w"> </span><span class="nx">JavaScript</span><span class="w"> </span><span class="o">--&gt;</span>
<span class="o">&lt;</span><span class="nx">script</span><span class="w"> </span><span class="nx">src</span><span class="o">=</span><span class="s2">&quot;https://code.jquery.com/jquery-3.6.4.min.js&quot;</span><span class="o">&gt;&lt;</span><span class="err">/script&gt;</span>
<span class="o">&lt;</span><span class="nx">script</span><span class="w"> </span><span class="nx">src</span><span class="o">=</span><span class="s2">&quot;https://code.jquery.com/ui/1.12.1/jquery-ui.js&quot;</span><span class="o">&gt;&lt;</span><span class="err">/script&gt;</span>
</pre></div></td></tr></table></div>
<p>Add the jQuery autocomplete script to the bottom of your HTML. This is where we
reference the &quot;search-input&quot; id in our form and specify the url route &quot;/ajax_calls/search/&quot;.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
<span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
<span class="w">    </span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#search-input&quot;</span><span class="p">).</span><span class="nx">autocomplete</span><span class="p">({</span>
<span class="w">        </span><span class="nx">source</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;/ajax_calls/search/&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">minLength</span><span class="o">:</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span>
<span class="w">        </span><span class="nx">open</span><span class="o">:</span><span class="w"> </span><span class="kd">function</span><span class="p">(){</span>
<span class="w">            </span><span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;.ui-autocomplete&#39;</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="s1">&#39;z-index&#39;</span><span class="p">,</span><span class="w"> </span><span class="mf">99</span><span class="p">);</span>
<span class="w">            </span><span class="p">},</span><span class="w"> </span><span class="mf">0</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">});</span>
<span class="p">});</span>
<span class="o">&lt;</span><span class="err">/script&gt;</span>
</pre></div></td></tr></table></div>
<p><strong>Add the Autocomplete View to Views.py</strong></p>
<p>Note this script is using the <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest">XMLHttpRequest API</a>,
which is used in combination with <a class="reference external" href="https://en.wikipedia.org/wiki/Ajax_(programming)">AJAX</a>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">django.apps</span> <span class="kn">import</span> <span class="n">apps</span>
<span class="kn">from</span> <span class="nn">django.forms.models</span> <span class="kn">import</span> <span class="n">model_to_dict</span>
<span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">render</span>
<span class="kn">from</span> <span class="nn">forms</span> <span class="kn">import</span> <span class="n">BookingForm</span>
<span class="kn">from</span> <span class="nn">django.http</span> <span class="kn">import</span> <span class="n">HttpResponse</span><span class="p">,</span> <span class="n">HttpResponseRedirect</span>


<span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Displays an HTML page with a form. If the request is a post, save the data to the DB.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;POST&quot;</span><span class="p">:</span>
          <span class="c1"># Create a form instance and populate it with data from the request.</span>
          <span class="n">form</span> <span class="o">=</span> <span class="n">BookingForm</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">)</span>
          <span class="k">if</span> <span class="n">form</span><span class="o">.</span><span class="n">is_valid</span><span class="p">():</span>
              <span class="n">new_booking</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
              <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;/confirmation_page&quot;</span><span class="p">)</span>
    <span class="n">context</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">context</span><span class="p">[</span><span class="s2">&quot;form&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">BookingForm</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s2">&quot;simple_django_form.html&quot;</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">autocomplete</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Show the City model records via AJAX + jQuery.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;x-requested-with&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;XMLHttpRequest&quot;</span><span class="p">:</span>
        <span class="n">City</span> <span class="o">=</span> <span class="n">apps</span><span class="o">.</span><span class="n">get_model</span><span class="p">(</span><span class="n">app_label</span><span class="o">=</span><span class="s2">&quot;bookings&quot;</span><span class="p">,</span> <span class="n">model_name</span><span class="o">=</span><span class="s2">&quot;City&quot;</span><span class="p">)</span>
        <span class="n">term</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="p">[</span><span class="s2">&quot;term&quot;</span><span class="p">]</span>
        <span class="n">search_results</span> <span class="o">=</span> <span class="n">City</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">city_name__startswith</span><span class="o">=</span><span class="n">term</span><span class="p">)</span>
        <span class="n">cities</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">city_name</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">country</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">search_results</span><span class="p">]</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">cities</span><span class="p">)</span>
   <span class="k">else</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="s2">&quot;fail&quot;</span>
   <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s2">&quot;application/json&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">confirmation_page</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Show a confirmation page thanking the client for their business.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s2">&quot;Thanks for signing up!&quot;</span><span class="p">)</span>
</pre></div></td></tr></table></div>
<p><strong>Write the HTML for a Simple Django Form</strong></p>
<p>Here is the template I used. It differs slightly from the <a class="reference external" href="https://docs.djangoproject.com/en/5.0/topics/forms/#the-template">template in the Django docs</a>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><span class="p">{</span><span class="o">%</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="s1">&#39;base.html&#39;</span><span class="w"> </span><span class="o">%</span><span class="p">}</span>
<span class="p">{</span><span class="o">%</span><span class="w"> </span><span class="nx">block</span><span class="w"> </span><span class="nx">content</span><span class="w"> </span><span class="o">%</span><span class="p">}</span>
<span class="o">&lt;</span><span class="nx">form</span><span class="w"> </span><span class="nx">method</span><span class="o">=</span><span class="s2">&quot;post&quot;</span><span class="o">&gt;</span>
<span class="w">    </span><span class="p">{</span><span class="o">%</span><span class="w"> </span><span class="nx">csrf_token</span><span class="w"> </span><span class="o">%</span><span class="p">}</span>
<span class="w">    </span><span class="p">{{</span><span class="w"> </span><span class="nx">form</span><span class="p">.</span><span class="nx">as_p</span><span class="w"> </span><span class="p">}}</span>
<span class="w">    </span><span class="o">&lt;</span><span class="nx">input</span><span class="w"> </span><span class="nx">type</span><span class="o">=</span><span class="s2">&quot;submit&quot;</span><span class="w"> </span><span class="nx">value</span><span class="o">=</span><span class="s2">&quot;Submit&quot;</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="err">/form&gt;</span>
<span class="p">{</span><span class="o">%</span><span class="w"> </span><span class="nx">endblock</span><span class="w"> </span><span class="o">%</span><span class="p">}</span>
</pre></div></td></tr></table></div>
<p><strong>Understanding Ajax + XMLHttpRequest</strong></p>
<blockquote>
Ajax is a technique that uses XMLHttpRequest to exchange data with a web server
without reloading the whole page. XMLHttpRequest is an object that allows web apps
to make HTTP requests and receive the responses programmatically using JavaScript.
Ajax stands for Asynchronous JavaScript and XML,  which means that the data exchange
can happen in the background, while the user interacts with the web page.
- Bing AI</blockquote>
<p><strong>Add the URL Route to urls.py</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">path</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">views</span>

<span class="n">app_name</span> <span class="o">=</span> <span class="s2">&quot;your_app_name&quot;</span>
<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">path</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;index&quot;</span><span class="p">),</span>
    <span class="n">path</span><span class="p">(</span><span class="s2">&quot;confirmation_page/&quot;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">confirmation_page</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;confirmation page&quot;</span><span class="p">),</span>
    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;ajax_calls/search/&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">autocomplete</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;city_autocomplete&#39;</span><span class="p">),</span>
<span class="p">]</span>
</pre></div></td></tr></table></div>
<p><strong>Voila! The City Autocomplete View</strong></p>
<img alt="adding autocomplete to a Django form with jQuery" src="https://lofipython.com/images/jQueryautocomplete.png" />
<p>Note: to achieve the appearance of the form text box and autocomplete dropdown, I installed
the <a class="reference external" href="https://django-bootstrap-v5.readthedocs.io/en/latest/">django-bootstrap-v5 python module</a></p>
<p>This felt very rewarding to see once it was working. I stretched my abilities
outside of coding only in Python to achieve this functionality in my website.
Someday I would like to be an experienced Javascript developer also. <a class="reference external" href="https://api.jquery.com/">jQuery</a> has
been a staple in web development for many years. Auto-complete is just one of the features
that this core Javascript library enables. I am definitely intrigued to explore jQuery further.</p>
<p>Want to read more about Django? Check out my
<a class="reference external" href="https://lofipython.com/first-impressions-and-key-concepts-of-the-django-python-web-framework">notes on Django here</a>.</p>

                <div class="clear"></div>

                <div class="info">
                    <a href="https://lofipython.com/adding-city-name-autocomplete-to-a-django-form-with-jquery-ajax.html">posted at 14:33</a>
                    &nbsp;&middot;&nbsp;<a href="https://lofipython.com/category/coding-programming-python-ajax-javascript-web-development.html" rel="tag">coding, programming, python, AJAX, Javascript, web development</a>
                    &nbsp;&middot;
                    &nbsp;<a href="https://lofipython.com/tag/making-a-city-autocomplete-form.html" class="tags">making a city autocomplete form</a>
                    &nbsp;<a href="https://lofipython.com/tag/how-to-make-django-autocomplete.html" class="tags">how to make django autocomplete</a>
                    &nbsp;<a href="https://lofipython.com/tag/integrating-django-and-jquery.html" class="tags">integrating Django and jQuery</a>
                </div>
            </article>            <h4 class="date">Feb 02, 2024</h4>

            <article class="post">
                <h2 class="title">
                    <a href="https://lofipython.com/first-impressions-and-key-concepts-of-the-django-python-web-framework.html" rel="bookmark" title="Permanent Link to &quot;First Impressions and Key Concepts of the Django Python Web Framework&quot;">First Impressions and Key Concepts of the Django Python Web Framework</a>
                </h2>

                
                

                <p><strong>First Impressions of Django</strong></p>
<p>Picking up <a class="reference external" href="https://pypi.org/project/Django/">Django</a> felt right. In the past I used
other Python web frameworks like <a class="reference external" href="http://www.web2py.com/">web2py</a> and <a class="reference external" href="http://www.web2py.com/">flask</a>.
I mostly avoided Django before now because it felt a bit overkill for the smaller
toy apps I made in my beginning years as a Python developer. For example, this blog
is made with the <a class="reference external" href="https://getpelican.com/">Pelican</a> static site generator, a
choice which has served me well.</p>
<p>Recently, a project came my way that seemed a good fit to apply Django. The task
required building a travel booking website. For this use case, Django shined. It
fits like a glove on a seasoned Python programmer. I am impressed how quickly I
adapted to it and thrived as I made my minimum viable product website.</p>
<p>Kudos to the Django developers that I, a typical Python programmer
aided with artificial intelligence could rapidly develop using their tools to
achieve my goals. If I could learn to write some decent CSS, I'd be unstoppable!</p>
<p>I highly recommend all Python programmers pick Django for their web apps with more
robust requirements. I say this with no slight to fellow heavyweight Flask or other
popular Python web frameworks like <a class="reference external" href="https://www.tornadoweb.org/en/stable/">Tornado</a>,
<a class="reference external" href="https://bottlepy.org/docs/dev/">Bottle</a>, <a class="reference external" href="https://docs.cherrypy.dev/en/latest/">CherryPy</a>
or <a class="reference external" href="https://py4web.com/">py4web</a> . All of these can all be justified in the
right situation due to their unique capabilities. Django stands out because it's
pretty easy to reach for things that already exist in the library to get what you
need done. Other frameworks may require a more nuanced skillset to achieve the same results.
Ok, enough pontification. Here are my notes of key Django concepts.</p>
<p><strong>Start with the Django official tutorial.</strong></p>
<p>The tutorial is lengthy and starts from the ground up. I commend its thoroughness.
Start there and work your way out. <a class="reference external" href="https://docs.djangoproject.com/en/5.0/intro/tutorial01/">Django Documentation Tutorial</a></p>
<p><strong>Django Models, Forms &amp; Fields, models.py and forms.py</strong></p>
<p>Your forms.py and models.py files are crucial pieces to render a form, collect data
and store it in the database.</p>
<p><strong>manage.py</strong></p>
<p>This file is used for database model migrations, creating a new app and accessing
your app through the shell.</p>
<p><strong>views.py</strong></p>
<p>The views.py file contains the Python functions that execute the flow of your app.
Each function in the views.py can be a view.</p>
<p><strong>urls.py</strong></p>
<p>The urls.py defines your url schema so that when you go to &quot;example.com/any_page&quot;,
you can tell django which view to show there.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">path</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">views</span>

<span class="n">app_name</span> <span class="o">=</span> <span class="s2">&quot;bookings&quot;</span>
<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">path</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;index&quot;</span><span class="p">),</span>
    <span class="n">path</span><span class="p">(</span><span class="s2">&quot;hotels/&quot;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">hotels</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;hotels&quot;</span><span class="p">),</span>
<span class="p">]</span>
</pre></div></td></tr></table></div>
<p><strong>settings.py</strong></p>
<p>After you create your app structure with a django manage.py command, a settings.py is automatically generated.
You will need to make edits here occasionally, such as changing the value of debug
to true or false. You may need to add newly installed apps or make other changes
in your settings.py to get things to work.</p>
<p><strong>HTML + CSS Required</strong></p>
<p>Your HTML and CSS skills will come in handy when working with Django or any web framework.
This is not a big surprise. You almost always need to know HTML and CSS to mold
your website to your requirements.</p>
<p><strong>Django Template Language + Filters</strong></p>
<p>Django comes with its own <a class="reference external" href="https://docs.djangoproject.com/en/5.0/ref/templates/language/#the-django-template-language">HTML template language</a>
to help you dynamically populate values in HTML. You can also use its <a class="reference external" href="https://docs.djangoproject.com/en/5.0/ref/templates/builtins/">built-in template tags and filters</a>
to transform values directly in the HTML. Additionally, Django lets you write
<a class="reference external" href="https://docs.djangoproject.com/en/5.0/howto/custom-template-tags/">custom template tags and filters</a>
to use Python for more complex transformations or on the fly mathematic calculations.
Below is an example of how you can use Django's templating language to loop through
your Django model. Django has built-in support for if statements inside its HTML.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div><pre><span></span>{% for hotel in hotels %}
<span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>
{% if hotel.all_inclusive %}
    This hotel is all included.
{% else %}
    This hotel is not all included.
{% endif %}
<span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
{% if hotel.accepts_groups %}
    This hotel accepts groups.
{% else %}
    This hotel doesn&#39;t accept groups.
{% endif %}
<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</pre></div></td></tr></table></div>
<p><strong>Javascript + jQuery Friendly</strong></p>
<p>Django seems fully capable of integrating with Javascript libraries. I was able
to get jQuery + AJAX request autocomplete functionality working in my form with
help from Bing's AI Chat. I followed along with this <a class="reference external" href="https://espere.in/Enhance-Your-Django-App:-Step-by-Step-Guide-to-Implementing-Autocomplete-Search-with-jQuery/">helpful blog post</a>
to get my jQuery script working!</p>
<img alt="adding autocomplete to a django form with jQuery" src="https://lofipython.com/images/jQueryautocomplete.png" />
<p><strong>External Django Python Libraries</strong></p>
<p>Another plus of Django due to its popularity is the amount of external modules that
Python developers have written to add features and functionality. For example,
<a class="reference external" href="https://django-autocomplete-light.readthedocs.io/en/master/tutorial.html">django-autocomplete-light</a>
and the <a class="reference external" href="https://pypi.org/project/django-bootstrap-v5/">django-bootstrap-v5</a>
CSS library are installed with pip. I successfully used django-bootstrap-v5 to add
bootstrap CSS styling to my website. Note this library requires a slightly older
version of Django.</p>
<p>Often there are several ways to get something done in Django, with external Python libraries
or Javascript libraries each a possibility to succeed. After several hours of
failing to get django-autocomplete-light working, I achieved the same result with
jQuery. It's always good to have options.</p>
<p><strong>The Admin Panel + admin.py</strong></p>
<p>One of the best out of the box features of Django is its admin panel and user model.
If you intend to build a website with for your users, this makes Django a great choice.
Don't forget to register your models in your admin.py.</p>
<p><strong>apps.get_model()</strong></p>
<p>You can import your models at the top of your code or use this handy convenience function to
retrieve it directly.</p>
<p><strong>model_to_dict()</strong></p>
<p>This is another function Django provides for converting a model object class to a Python dictionary.
Once a model is in dictionary format, you can pass it to a django form's &quot;initial&quot; argument
to easily auto-populate a form.</p>
<p><strong>request.GET()</strong></p>
<p>Django has its own request objects. You can pass a raw query string to HttpResponseRedirect.
Then, in the view of the target page, you can use this function to get the querystring
value by passing its key.</p>
<p><strong>render() and contexts</strong></p>
<p>The render function renders an HTML document. This function has a context argument
that allows you to pass variables into the HTML view.</p>
<p><strong>How to Install Django</strong></p>
<pre class="code console literal-block">
<span class="go">pip install Django</span>
</pre>
<p><strong>Django Views.py Code Example</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">from</span> <span class="nn">django.apps</span> <span class="kn">import</span> <span class="n">apps</span>
<span class="kn">from</span> <span class="nn">django.forms.models</span> <span class="kn">import</span> <span class="n">model_to_dict</span>
<span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">render</span>
<span class="kn">from</span> <span class="nn">forms</span> <span class="kn">import</span> <span class="n">BookingForm</span>

<span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Displays an HTML page with a form. If the request is a post, save the data</span>
<span class="sd">    to the DB. If booking_id is passed in the url querystring, populate the form</span>
<span class="sd">    with data from that id.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;POST&quot;</span><span class="p">:</span>
          <span class="c1"># Create a form instance and populate it with data from the request.</span>
          <span class="n">form</span> <span class="o">=</span> <span class="n">BookingForm</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">)</span>
          <span class="k">if</span> <span class="n">form</span><span class="o">.</span><span class="n">is_valid</span><span class="p">():</span>
              <span class="n">new_booking</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
              <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;/hotels?booking_id=</span><span class="si">{</span><span class="n">new_booking</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">booking_id</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="p">[</span><span class="s2">&quot;booking_id&quot;</span><span class="p">]</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">booking_id</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">if</span> <span class="n">booking_id</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
        <span class="n">Booking</span> <span class="o">=</span> <span class="n">apps</span><span class="o">.</span><span class="n">get_model</span><span class="p">(</span><span class="n">app_label</span><span class="o">=</span><span class="s2">&quot;your_app_name&quot;</span><span class="p">,</span> <span class="n">model_name</span><span class="o">=</span><span class="s2">&quot;Booking&quot;</span><span class="p">)</span>
        <span class="n">booking</span> <span class="o">=</span> <span class="n">Booking</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">booking_id</span><span class="p">)</span>
        <span class="n">booking_dict</span> <span class="o">=</span> <span class="n">model_to_dict</span><span class="p">(</span><span class="n">booking</span><span class="p">)</span>
    <span class="n">context</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="n">booking_dict</span><span class="p">:</span>
        <span class="n">context</span><span class="p">[</span><span class="s2">&quot;form&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">BookingForm</span><span class="p">(</span><span class="n">initial</span><span class="o">=</span><span class="n">booking_dict</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">context</span><span class="p">[</span><span class="s2">&quot;form&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">BookingForm</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s2">&quot;simple_django_form.html&quot;</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">hotels</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Render a list of hotels to for clients to view from the Hotel model.&quot;&quot;&quot;</span>
    <span class="n">booking_id</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="p">[</span><span class="s2">&quot;booking_id&quot;</span><span class="p">]</span>
    <span class="n">Booking</span> <span class="o">=</span> <span class="n">apps</span><span class="o">.</span><span class="n">get_model</span><span class="p">(</span><span class="n">app_label</span><span class="o">=</span><span class="s2">&quot;your_app_name&quot;</span><span class="p">,</span> <span class="n">model_name</span><span class="o">=</span><span class="s2">&quot;Booking&quot;</span><span class="p">)</span>
    <span class="n">booking</span> <span class="o">=</span> <span class="n">Booking</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">booking_id</span><span class="p">)</span>
    <span class="n">Hotel</span> <span class="o">=</span> <span class="n">apps</span><span class="o">.</span><span class="n">get_model</span><span class="p">(</span><span class="n">app_label</span><span class="o">=</span><span class="s2">&quot;your_app_name&quot;</span><span class="p">,</span> <span class="n">model_name</span><span class="o">=</span><span class="s2">&quot;Hotel&quot;</span><span class="p">)</span>
    <span class="n">hotels</span> <span class="o">=</span> <span class="n">Hotel</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">city__contains</span><span class="o">=</span><span class="n">booking</span><span class="o">.</span><span class="n">to_city</span><span class="p">)</span>
    <span class="c1"># Pass context to access variables directly in hotels.html: {{ return_date }}</span>
    <span class="n">context</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;hotels&quot;</span><span class="p">:</span> <span class="n">hotels</span><span class="p">,</span>
        <span class="s2">&quot;booking_id&quot;</span><span class="p">:</span> <span class="n">booking_id</span><span class="p">,</span>
        <span class="s2">&quot;departure_date&quot;</span><span class="p">:</span> <span class="n">booking</span><span class="o">.</span><span class="n">departure_date</span><span class="o">.</span><span class="n">date</span><span class="p">(),</span>
        <span class="s2">&quot;return_date&quot;</span><span class="p">:</span> <span class="n">booking</span><span class="o">.</span><span class="n">return_date</span><span class="o">.</span><span class="n">date</span><span class="p">(),</span>
        <span class="s2">&quot;to_city&quot;</span><span class="p">:</span> <span class="n">booking</span><span class="o">.</span><span class="n">to_city</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s2">&quot;hotels.html&quot;</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
</pre></div></td></tr></table></div>
<p><strong>Basic Model Example</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span>

<span class="k">class</span> <span class="nc">Booking</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">departure_date</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="s2">&quot;departure date&quot;</span><span class="p">)</span>
    <span class="n">return_date</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="s2">&quot;return date&quot;</span><span class="p">)</span>
    <span class="n">from_city</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="s2">&quot;Origen&quot;</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">to_city</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="s2">&quot;Destino&quot;</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Hotel</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">price</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DecimalField</span><span class="p">(</span><span class="n">max_digits</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">decimal_places</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">address</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">city</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">all_inclusive</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">BooleanField</span><span class="p">()</span>
    <span class="n">photo</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ImageField</span><span class="p">(</span><span class="n">upload_to</span><span class="o">=</span><span class="s2">&quot;hotels&quot;</span><span class="p">)</span>
</pre></div></td></tr></table></div>
<p>Hopefully this helped you get started with Django. In my own experience, once you
get some momentum going with this web framework, you'll progress rapidly!</p>
<p><strong>Supplementary Django Links</strong></p>
<p><a class="reference external" href="https://docs.djangoproject.com/en/5.0/ref/forms/fields/">Django Form Fields Reference</a></p>
<p><a class="reference external" href="https://docs.djangoproject.com/en/5.0/ref/models/fields/">Django Model Fields Reference</a></p>
<p><a class="reference external" href="https://docs.djangoproject.com/en/5.0/ref/settings/">Django Settings Reference</a></p>
<p><a class="reference external" href="https://docs.djangoproject.com/en/5.0/howto/">Django How-to Guides</a></p>

                <div class="clear"></div>

                <div class="info">
                    <a href="https://lofipython.com/first-impressions-and-key-concepts-of-the-django-python-web-framework.html">posted at 12:33</a>
                    &nbsp;&middot;&nbsp;<a href="https://lofipython.com/category/coding-programming-python-django-web-development.html" rel="tag">coding, programming, python, django, web development</a>
                    &nbsp;&middot;
                    &nbsp;<a href="https://lofipython.com/tag/django-web-framework.html" class="tags">django web framework</a>
                    &nbsp;<a href="https://lofipython.com/tag/building-websites-with-django-python.html" class="tags">building websites with django python</a>
                    &nbsp;<a href="https://lofipython.com/tag/getting-started-with-a-django-app.html" class="tags">getting started with a django app</a>
                </div>
            </article>            <h4 class="date">Jan 15, 2024</h4>

            <article class="post">
                <h2 class="title">
                    <a href="https://lofipython.com/python-pandas-api-oddities.html" rel="bookmark" title="Permanent Link to &quot;Python Pandas API Oddities&quot;">Python Pandas API Oddities</a>
                </h2>

                
                

                <p>Below I've highlighted some niche functions in Python's pandas library. I've plucked
a few examples from the pandas documentation and the
<a class="reference external" href="https://en.wikipedia.org/wiki/List_of_Delta_Air_Lines_destinations">Delta Airlines Airports Wikipedia HTML table</a>
for sample data. This post is aimed at the more advanced stuff on the fringes of the pandas docs.
Here are some oddities of the less traveled parts of the pandas documentation.
You never know what you'll find there, it's always evolving. Images were sourced
from the <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/general_functions.html#importing-from-other-dataframe-libraries">pandas documentation</a>.</p>
<p><strong>Install pandas + lxml</strong></p>
<p>Install Python dependencies with pip: pandas and lxml, required for read_html()</p>
<pre class="literal-block">
python3.12 -m pip install pandas
python3.12 -m pip install lxml
</pre>
<p><strong>What's Not Mentioned Here</strong></p>
<p>I skipped the standard must know functions like <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.read_csv.html">pd.read_csv()</a>,
pd.read_excel(), pd.DataFrame.to_csv(), <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.to_json.html">pd.DataFrame.to_json()</a>
and so on. The documentation on these functions is extensive. I recommend checking
out all the ways you can customize behavior of your data with their arguments.</p>
<p><strong>pd.DataFrame.__dataframe__() + pd.api.interchange.from_dataframe()</strong></p>
<p>Import a DataFrame from another library via the <a class="reference external" href="https://data-apis.org/dataframe-protocol/latest/index.html">DataFrame interchange protocol</a>.
The .__dataframe__() dunder method returns an interchange object which can be used to
convert another dialect of dataframe to pandas. If the protocol is supported,
a dataframe interchange object has the methods &quot;column_names&quot; and &quot;select_columns_by_name&quot;.
If you're dealing with a flavor of dataframe other than pandas, keep in mind it may support
the DataFrame interchange protocol.</p>
<img alt="interchange dataframes between libraries" src="https://lofipython.com/images/pandasdataframeinterchangeprotocol.png" />
<p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.api.interchange.from_dataframe.html#pandas.api.interchange.from_dataframe">pandas.api.interchange.from_dataframe() documentation</a></p>
<img alt="get a dataframe interchange object" src="https://lofipython.com/images/dunderdataframepandasapi.png" />
<p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.__dataframe__.html">pandas interchange object documentation</a></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df_not_necessarily_pandas</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]})</span>
<span class="n">interchange_object</span> <span class="o">=</span> <span class="n">df_not_necessarily_pandas</span><span class="o">.</span><span class="n">__dataframe__</span><span class="p">()</span>
<span class="n">df_pandas</span> <span class="o">=</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">interchange</span><span class="o">.</span><span class="n">from_dataframe</span>
           <span class="p">(</span><span class="n">interchange_object</span><span class="o">.</span><span class="n">select_columns_by_name</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">])))</span>
</pre></div></td></tr></table></div>
<pre class="literal-block">
&gt;&gt;&gt; df_pandas

     A
0    1
1    2

&gt;&gt;&gt; interchange_object.column_names()

Index(['A', 'B'], dtype='object')
</pre>
<p><strong>pd.read_html(url)</strong></p>
<p>pd.read_html() accepts a website url. It returns a list of all HTML tables
as DataFrames. After getting the table as a dataframe, use &quot;.drop()&quot; to drop a column and &quot;.fillna()&quot;
to fill NA values as blanks. <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.read_html.html">read_html() Documentation</a></p>
<img alt="read an HTML table to pandas dataframe" src="https://lofipython.com/images/readhtmlpandas.png" />
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://en.wikipedia.org/wiki/List_of_Delta_Air_Lines_destinations&quot;</span>
<span class="n">airports</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="n">url</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># Drop the irrelevant &quot;Refs&quot; column and fill nans blank.</span>
<span class="n">airports</span> <span class="o">=</span> <span class="n">airports</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;Refs&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">airports</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div></td></tr></table></div>
<p><strong>pd.DataFrame.to_html()</strong></p>
<p>This function returns your tabular data as an HTML string.
df.head() accepts a number and returns a df with that many records, in this case 2.
<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.to_html.html">to_html() Documentation</a></p>
<img alt="convert dataframe to HTML table with pandas" src="https://lofipython.com/images/tohtmlpandas.png" />
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><span class="n">html</span> <span class="o">=</span> <span class="n">airports</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>
</pre></div></td></tr></table></div>
<pre class="literal-block">
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;Country / Territory&lt;/th&gt;
      &lt;th&gt;City&lt;/th&gt;
      &lt;th&gt;Airport&lt;/th&gt;
      &lt;th&gt;Notes&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;Antigua and Barbuda&lt;/td&gt;
      &lt;td&gt;Osbourn&lt;/td&gt;
      &lt;td&gt;V. C. Bird International Airport&lt;/td&gt;
      &lt;td&gt;Seasonal&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Argentina&lt;/td&gt;
      &lt;td&gt;Buenos Aires&lt;/td&gt;
      &lt;td&gt;Ministro Pistarini International Airport&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
</pre>
<img alt="example pandas HTML table" src="https://lofipython.com/images/htmltable.png" />
<p><strong>pd.DataFrame.memory_usage()</strong></p>
<p>Returns the memory usage of each column in bytes. Per the docs, &quot;this value is displayed in DataFrame.info by default.&quot;
<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.memory_usage.html">.memory_usage() Documentation</a></p>
<img alt="see bytes size for each column" src="https://lofipython.com/images/memoryusagepandasapi.png" />
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><span class="c1"># To include memory footprint of object dtypes, pass deep=True.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">airports</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div></td></tr></table></div>
<pre class="literal-block">
Index                    132
Country / Territory    24125
City                   21164
Airport                30660
Notes                  19237
dtype: int64
</pre>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div><pre><span></span><span class="k">def</span> <span class="nf">readable_format</span><span class="p">(</span><span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts a bytes integer to a human-readable format.</span>

<span class="sd">    Args:</span>
<span class="sd">        size (int): The bytes integer to convert.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The human-readable format of the bytes integer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">unit</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;KB&quot;</span><span class="p">,</span> <span class="s2">&quot;MB&quot;</span><span class="p">,</span> <span class="s2">&quot;GB&quot;</span><span class="p">,</span> <span class="s2">&quot;TB&quot;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">size</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">size</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">unit</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">size</span> <span class="o">/=</span> <span class="mi">1000</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">size</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> PB&quot;</span>

<span class="c1"># Use pd.Series.apply() to convert bytes to &quot;human readable&quot; data format.</span>
<span class="n">memory_usage</span> <span class="o">=</span> <span class="n">airports</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">readable_format</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">memory_usage</span><span class="p">)</span>
</pre></div></td></tr></table></div>
<pre class="literal-block">
Index                  132.00 B
Country / Territory    24.12 KB
City                   21.16 KB
Airport                30.66 KB
Notes                  19.24 KB
dtype: object
</pre>
<p><strong>pd.DataFrame.empty</strong></p>
<p>Every pandas DataFrame has a &quot;.empty&quot; attribute. If Series/DataFrame is empty,
returns True, if not returns False. <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.empty.html">.empty Documentation</a></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">airports</span><span class="o">.</span><span class="n">empty</span><span class="p">)</span>
<span class="c1"># False</span>
<span class="k">if</span> <span class="n">airports</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DataFrame has no data.&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DataFrame contains data.&quot;</span><span class="p">)</span>
<span class="c1"># DataFrame contains data.</span>
</pre></div></td></tr></table></div>
<p><strong>pd.DataFrame.T</strong></p>
<p>Every pandas DataFrame has a &quot;.T&quot; attribute. It returns the transposed version
of the DataFrame. <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.T.html#pandas.DataFrame.T">.T Documentation</a></p>
<pre class="literal-block">
&gt;&gt;&gt; airports.head(3).T
</pre>
<pre class="literal-block">
  0                                         1                                    2
Country / Territory               Antigua and Barbuda                                 Argentina                                Aruba
City                                          Osbourn                              Buenos Aires                           Oranjestad
Airport              V. C. Bird International Airport  Ministro Pistarini International Airport  Queen Beatrix International Airport
Notes                                        Seasonal
</pre>
<p><strong>pd.DataFrame.convert_dtypes() + .infer_objects()</strong></p>
<p>These are 2 functions for swiftly handling data types in your tabular data.
Note: these are alternatives to the <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.astype.html">&quot;astype()&quot; function</a>, which is used more commonly.
Use astype() to set a column or dataframe to a specific dtype. Use infer_objects() to
infer more suitable types for object columns. Use convert_dtypes() to let pandas choose the best possible dtype.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><span class="c1"># Convert columns to the best possible dtypes using dtypes supporting pd.NA.</span>
<span class="n">typed_df</span> <span class="o">=</span> <span class="n">airports</span><span class="o">.</span><span class="n">convert_dtypes</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">typed_df</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>

<span class="c1"># Attempt to infer better dtypes for object columns.</span>
<span class="n">inferred_df</span> <span class="o">=</span> <span class="n">airports</span><span class="o">.</span><span class="n">infer_objects</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">inferred_df</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
</pre></div></td></tr></table></div>
<pre class="literal-block">
&gt;&gt;&gt; airports.head()
  Country / Territory          City                                   Airport       Notes
0  Antigua and Barbuda       Osbourn          V. C. Bird International Airport    Seasonal
1            Argentina  Buenos Aires  Ministro Pistarini International Airport
2                Aruba    Oranjestad       Queen Beatrix International Airport
3            Australia        Sydney                            Sydney Airport
4              Austria        Vienna              Vienna International Airport  Terminated

&gt;&gt;&gt; airports.dtypes
Country / Territory    object
City                   object
Airport                object
Notes                  object
dtype: object

&gt;&gt;&gt; typed_df.dtypes
Country / Territory    string[python]
City                   string[python]
Airport                string[python]
Notes                  string[python]
dtype: object

&gt;&gt;&gt; inferred_df.dtypes
Country / Territory    object
City                   object
Airport                object
Notes                  object
dtype: object
</pre>
<p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.convert_dtypes.html">convert_dtypes Documentation</a>
+ <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.convert_dtypes.html">infer_objects() Documentation</a></p>
<p><strong>pd.Series.str.get(index)</strong></p>
<p>str.get() is available via the pandas Series string accessor.
This function is useful when your dataset contains a column holding a list in each cell.
It also works on strings by returning the character at the index of a string.
You can pass an index and that value will be returned for each cell in a column.
<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.str.get.html#pandas-series-str-get">str.get() Documentation</a></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span>
    <span class="p">[</span><span class="s2">&quot;String&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">],</span> <span class="mi">123</span><span class="p">,</span> <span class="o">-</span><span class="mi">456</span><span class="p">,</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;Hello&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">:</span> <span class="s2">&quot;World&quot;</span><span class="p">}]</span>
<span class="p">)</span>
<span class="n">new_column</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">new_column</span><span class="p">)</span>
</pre></div></td></tr></table></div>
<pre class="literal-block">
&gt;&gt;&gt; s
0                        String
1                     (1, 2, 3)
2                     [a, b, c]
3                           123
4                          -456
5    {1: 'Hello', '2': 'World'}
dtype: object

&gt;&gt;&gt; s.str.get(1)
0        t
1        2
2        b
3      NaN
4      NaN
5    Hello
dtype: object
</pre>
<p><strong>Pique Your Curiosity With Pandas</strong></p>
<p>Now you know a few of my favorite pandas API oddities. It's always time
well spent reading the <a class="reference external" href="https://pandas.pydata.org/">Pandas API documentation</a>.
Check out <a class="reference external" href="https://lofipython.com/pandas-pythons-excel-powerhouse">this other post I wrote about pandas</a>
for a deeper dive into this powerful Python module.</p>

                <div class="clear"></div>

                <div class="info">
                    <a href="https://lofipython.com/python-pandas-api-oddities.html">posted at 17:41</a>
                    &nbsp;&middot;&nbsp;<a href="https://lofipython.com/category/coding-programming-python-pandas.html" rel="tag">coding, programming, python, pandas</a>
                    &nbsp;&middot;
                    &nbsp;<a href="https://lofipython.com/tag/pandas-api.html" class="tags">pandas api</a>
                    &nbsp;<a href="https://lofipython.com/tag/using-pandas-in-python.html" class="tags">using pandas in Python</a>
                    &nbsp;<a href="https://lofipython.com/tag/working-with-data.html" class="tags">working with data</a>
                    &nbsp;<a href="https://lofipython.com/tag/how-to-use-pandas.html" class="tags">how to use pandas</a>
                    &nbsp;<a href="https://lofipython.com/tag/reading-html-with-pandas.html" class="tags">reading HTML with pandas</a>
                    &nbsp;<a href="https://lofipython.com/tag/reading-pandas-memory-usage.html" class="tags">reading pandas memory usage</a>
                </div>
            </article>            <h4 class="date">Oct 27, 2023</h4>

            <article class="post">
                <h2 class="title">
                    <a href="https://lofipython.com/how-to-make-a-wi-fi-qr-code-with-python.html" rel="bookmark" title="Permanent Link to &quot;Streamline Sharing Your Wi-Fi Network Details With Python&quot;">Streamline Sharing Your Wi-Fi Network Details With Python</a>
                </h2>

                
                

                <p>If you host a public space or office with shared Wi-Fi, a QR code skips the tedious process of
exchanging your network's details. This is nice to have as an alternative to asking
people to manually enter an auto-generated, cryptic, error-prone 16 character string password.
Especially when you frequently have customers or new people asking for the information.
You could post a sign with the network name and password like most coffee shops do,
or you could try a QR code. Here's how to create a QR code for your Wi-Fi network.</p>
<p>To accomplish this task, I found the <a class="reference external" href="https://pypi.org/project/wifi-qrcode-generator/">wifi-qr-code-generator library on pypi</a>.
It makes creating a Wi-Fi QR code very simple with help from the <a class="reference external" href="https://pypi.org/project/Pillow/">pillow</a> and <a class="reference external" href="https://pypi.org/project/qrcode/">qrcode</a> modules.
It is a great example of a library that has a very specific purpose and does it well.
The connection will only be automatic if your password is correct, so make sure you type it carefully.</p>
<p>The library has two ways to create a QR code:</p>
<ol class="arabic simple">
<li>Run a Python script with the network details.</li>
<li>Use wifi-qr-code-generator's CLI and respond to prompts for Wi-Fi details.</li>
</ol>
<p><strong>Install wifi-qrcode-generator</strong></p>
<pre class="code console literal-block">
<span class="go">pip install wifi-qrcode-generator</span>
</pre>
<p><strong>Generating a QR Code Python Script</strong></p>
<p>This code snippet prints the qr code to the terminal screen, then saves it as a png image.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="kn">import</span> <span class="nn">wifi_qrcode_generator.generator</span>

<span class="n">qr_code</span> <span class="o">=</span> <span class="n">wifi_qrcode_generator</span><span class="o">.</span><span class="n">generator</span><span class="o">.</span><span class="n">wifi_qrcode</span><span class="p">(</span>
    <span class="n">ssid</span><span class="o">=</span><span class="s2">&quot;add_wi-fi_network_name&quot;</span><span class="p">,</span>
    <span class="n">hidden</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">authentication_type</span><span class="o">=</span><span class="s2">&quot;WPA&quot;</span><span class="p">,</span>
    <span class="n">password</span><span class="o">=</span><span class="s2">&quot;add_wi-fi_password&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">qr_code</span><span class="o">.</span><span class="n">print_ascii</span><span class="p">()</span>
<span class="n">qr_code</span><span class="o">.</span><span class="n">make_image</span><span class="p">()</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;wifi-qr-code.png&quot;</span><span class="p">)</span>
</pre></div></td></tr></table></div>
<p><strong>QR Code Example Image</strong></p>
<img alt="QR code image result" src="https://lofipython.com/images/wifi-qr.png" />
<p><strong>Wi-Fi Auto-Connected Confirmation</strong></p>
<img alt="confirmation of wi-fi connection" src="https://lofipython.com/images/connected-qr-notice.png" />
<p><strong>Generating a QR Code With CLI Command</strong></p>
<p>The 2nd way to use this module is via a built-in command line interface to make your QR code.
It can be invoked with this command:</p>
<pre class="code console literal-block">
<span class="go">wifi-qrcode-generator</span>
</pre>
<p><strong>Small Projects for the Win</strong></p>
<p>Some of my favorite coding happens when I start with a simple goal, research
the libraries available, apply Python skills and get a tangible result
in a short period of time. If you want to streamline sharing your Wi-Fi network,
remember this practical Python library!</p>

                <div class="clear"></div>

                <div class="info">
                    <a href="https://lofipython.com/how-to-make-a-wi-fi-qr-code-with-python.html">posted at 19:33</a>
                    &nbsp;&middot;&nbsp;<a href="https://lofipython.com/category/coding-programming-python-qr-code-wi-fi.html" rel="tag">coding, programming, python, QR code, Wi-Fi</a>
                    &nbsp;&middot;
                    &nbsp;<a href="https://lofipython.com/tag/making-a-wi-fi-qr-code.html" class="tags">making a wi-fi QR code</a>
                    &nbsp;<a href="https://lofipython.com/tag/how-to-create-a-qr-code-for-internet-password.html" class="tags">how to create a QR code for internet password</a>
                </div>
            </article>            <h4 class="date">Oct 25, 2023</h4>

            <article class="post">
                <h2 class="title">
                    <a href="https://lofipython.com/formatting-url-arguments-in-python.html" rel="bookmark" title="Permanent Link to &quot;Formatting URL Parameters in Python&quot;">Formatting URL Parameters in Python</a>
                </h2>

                
                

                <p>When I first started working with APIs, I had a bad habit of passing URL parameters
as one long ugly string. Anything longer than 79 characters violates PEP-8.
It's also hard to read and can be difficult to edit the code in your text editor if the URL is trailing off the screen.
In this post, you'll find some alternatives to the primitive &quot;long ugly string&quot; approach.</p>
<blockquote>
<strong>Did you know?</strong> URL stands for &quot;uniform resource locator&quot;.</blockquote>
<p>Below are two ways to neatly format your URLs so that they have parameters.
Both involve using a Python dictionary. The requests API allows you to pass
a dictionary or list of tuples to its params argument. Alternatively, if you want
to see the full URL as a string, there's a sleek way to format URL arguments
with urllib's <a class="reference external" href="https://docs.python.org/3/library/urllib.parse.html#urllib.parse.urlencode">urlencode function</a>.</p>
<img alt="a visual breakdown of a url with parameters" src="https://lofipython.com/images/url-structure.png" />
<p>source: <a class="reference external" href="https://www.geeksforgeeks.org/how-to-handle-missing-parameters-in-url-with-flask/">Geeks for Geeks</a></p>
<p><strong>Pass a dictionary to the requests params argument to include URL arguments.</strong></p>
<blockquote>
You often want to send some sort of data in the URL’s query string.
If you were constructing the URL by hand, this data would be given as key/value pairs
in the URL after a question mark, e.g. httpbin.org/get?key=val.
Requests allows you to provide these arguments as a dictionary of strings, using the params keyword argument.
- requests documentation, <a class="reference external" href="https://requests.readthedocs.io/en/latest/user/quickstart/#passing-parameters-in-urls">Passing Parameters in URLs</a></blockquote>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;email&quot;</span><span class="p">:</span> <span class="s2">&quot;example@example.com&quot;</span><span class="p">,</span>
    <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;This email is not real.&quot;</span><span class="p">,</span>
    <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;inactive&quot;</span>
<span class="p">}</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;https://httpbin.org/get&quot;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">payload</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</pre></div></td></tr></table></div>
<p><strong>Use urllib's urlencode function to dynamically construct URL from a dictionary.</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">urlencode</span>

<span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;email&quot;</span><span class="p">:</span> <span class="s2">&quot;example@example.com&quot;</span><span class="p">,</span>
    <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;This email is not real.&quot;</span><span class="p">,</span>
    <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;inactive&quot;</span>
<span class="p">}</span>
<span class="c1"># Returns str of URL encoded parameters.</span>
<span class="n">url_parameters</span> <span class="o">=</span> <span class="n">urlencode</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
<span class="c1"># &gt;&gt;&gt; url_parameters</span>
<span class="c1"># &quot;email=example%40example.com&amp;message=This+email+is+not+real.&amp;status=inactive&quot;</span>
<span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://httpbin.org/get?</span><span class="si">{</span><span class="n">url_parameters</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</pre></div></td></tr></table></div>
<p><strong>Arguments can be a good thing.</strong></p>
<p>This seemingly basic HTTP formatting was something that took me too long to realize.
I hope it helps you keep your URLs tidy and your HTTP requests more readable.</p>
<p><strong>Read More About URL Parameters</strong></p>
<p><a class="reference external" href="https://requests.readthedocs.io/en/latest/user/quickstart/#passing-parameters-in-urls">Passing Parameters in URLS, requests Documentation</a></p>
<p><a class="reference external" href="https://docs.python.org/3/library/urllib.request.html#urllib-examples">urllib Examples, Python Documentation</a></p>
<p><a class="reference external" href="https://requests.readthedocs.io/en/latest/api/#requests.request">requests API Documentation Reference</a></p>
<p><a class="reference external" href="https://stackoverflow.com/questions/1233539/python-dictionary-to-url-parameters">Stack Overflow, Python Dictionary to URL Parameters</a></p>

                <div class="clear"></div>

                <div class="info">
                    <a href="https://lofipython.com/formatting-url-arguments-in-python.html">posted at 15:42</a>
                    &nbsp;&middot;&nbsp;<a href="https://lofipython.com/category/http-urls-python-requests.html" rel="tag">http, urls, python, requests</a>
                    &nbsp;&middot;
                    &nbsp;<a href="https://lofipython.com/tag/url-formatting.html" class="tags">url formatting</a>
                    &nbsp;<a href="https://lofipython.com/tag/working-with-urls-in-apis.html" class="tags">working with urls in APIs</a>
                    &nbsp;<a href="https://lofipython.com/tag/python-http-url-formatting.html" class="tags">python http url formatting</a>
                    &nbsp;<a href="https://lofipython.com/tag/python-url-parameters.html" class="tags">python url parameters</a>
                    &nbsp;<a href="https://lofipython.com/tag/format-python-url-arguments.html" class="tags">format python url arguments</a>
                </div>
            </article>            <h4 class="date">Oct 13, 2023</h4>

            <article class="post">
                <h2 class="title">
                    <a href="https://lofipython.com/how-i-sped-up-a-python-get-request-by-25%.html" rel="bookmark" title="Permanent Link to &quot;How I Sped Up My Python CLI By 25%&quot;">How I Sped Up My Python CLI By 25%</a>
                </h2>

                
                

                <p>I recently noticed that the <a class="reference external" href="https://github.com/erickbytes/finsou.py">Yahoo Finance stock summary command line interface (CLI)</a> I made seemed to be slowing down. Seeking to understand what was happening in my code, I remembered Python has multiple profilers available like Scalene, line_profiler, cProfile and pyinstrument. In this case, I was running my code on Python version 3.11.</p>
<p>First, I tried <a class="reference external" href="https://docs.python.org/3/library/profile.html#module-cProfile">cProfile</a> from the Python standard library. It is nice to have without any install required! However, I found its output to be tough to interpret. I also remembered I liked a <a class="reference external" href="https://www.youtube.com/watch?v=5iEf-_7mM1k">talk I saw about Scalene</a>, which gave a thorough overview of several Python profilers and how they're different. So next, I tried Scalene. Finally, I found pyinstrument and can safely say it is now my favorite Python profiler. This post will focus on how I used <a class="reference external" href="https://pyinstrument.readthedocs.io/en/latest/guide.html">pyinstrument</a> to make my command line tool faster.</p>
<p><strong>Install pyinstrument with pip</strong></p>
<pre class="code console literal-block">
<span class="go">pip install pyinstrument</span>
</pre>
<p>I preferred the format in which pyinstrument presented the modules, functions and time they consumed in a tree structure. Scalene's percentage-based diagnosis was useful also. Scalene showed the specific lines where code was bottlenecked, whereas pyinstrument showed the time spent in each module and function. I liked that I could see time of specific  functions from the external modules I was using with pyinstrument. For example, the beautiful soup and rich modules both consumed shockingly little time. However, the pandas module took a whole second.</p>
<p>Just importing the pandas module and doing nothing else was taking up to and sometimes over a second each time my CLI ran. On a script that takes about four seconds to execute, one second is 25% of the total run time! Once I realized this, I decided to only import the pandas module if my CLI's --csv argument was given. I was only using pandas to sort stocks and write a CSV. It wasn't critical functionality for my CLI.</p>
<p>My CLI script accepts a stock ticker as an argument. The below command fetches a stock report from Yahoo Finance and prints to the terminal. Swapping out &quot;python&quot; for pyinstrument runs the script and prints a pyinstrument report to your console.</p>
<p><strong>Fetch a stock report from Yahoo.</strong></p>
<pre class="code console literal-block">
<span class="go">pyinstrument finsou.py -s GOOG</span>
</pre>
<p><strong>pyinstrument Results With Normal Pandas Import</strong></p>
<p><strong>GOOG, Google</strong></p>
<img alt="profiling a Python script with pyinstrument, before with GOOG" src="https://lofipython.com/images/goog-pandas-import.png" />
<p><strong>MSFT, Microsoft</strong></p>
<img alt="profiling a Python script with pyinstrument, before with MSFT" src="https://lofipython.com/images/msft-pandas-import.png" />
<p>The line for the pandas module looks like this:</p>
<blockquote>
0.946 &lt;module&gt;  pandas/__init__.py:1</blockquote>
<p><strong>pyinstrument Results With Pandas Import Only If Necessary</strong></p>
<p>After changing the pandas module to only import if needed, it is no longer eating almost a second of time. As a result, the script runs about second faster each time! Below are the pyinstrument reports for two different stocks after changing my pandas import to only be called if it was actually used:</p>
<p><strong>GOOG, Google</strong></p>
<img alt="profiling a Python script with pyinstrument, after with GOOG" src="https://lofipython.com/images/goog-no-pandas-import-fast.png" />
<p><strong>NVDA, Nvidia</strong></p>
<img alt="profiling a Python script with pyinstrument, after with NVDA" src="https://lofipython.com/images/nvda-no-pandas-import.png" />
<p><strong>Sidebar: HTTP Request Volatility</strong></p>
<blockquote>
The time that the script runs fluctuates about half a second to a few seconds based on the HTTP get request. It lags even more if my internet connection is weaker or Yahoo throttles my request because I've made too many in a short period of time. My time savings weren't gained from tinkering with the HTTP request, even though that was a time-eater. I noticed the requests module get request tends to fluctuate and sometimes causes an extra delay.</blockquote>
<p><strong>Simplified Python Example to Achieve Speed Gains</strong></p>
<p>Below shows the method I used to achieve a faster CLI. Heads up, this code will not work if you run it. It's only meant to explain how I my code faster. You can find the actual script where I made this improvement <a class="reference external" href="https://github.com/erickbytes/finsou.py/blob/main/finsou.py">here on Github</a>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">import</span> <span class="nn">argparse</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">from</span> <span class="nn">rich</span> <span class="kn">import</span> <span class="nb">print</span> <span class="k">as</span> <span class="n">rprint</span>
<span class="c1"># Original import --&gt; lazy import only if csv argument given: import pandas as pd</span>

<span class="k">def</span> <span class="nf">yahoo_finance_prices</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">stock</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">&quot;Stonk went up.&quot;</span><span class="p">,</span> <span class="s2">&quot;1000%&quot;</span>

<span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span>
    <span class="n">prog</span><span class="o">=</span><span class="s2">&quot;finsou.py&quot;</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Beautiful Financial Soup&quot;</span><span class="p">,</span>
    <span class="n">epilog</span><span class="o">=</span><span class="s2">&quot;fin soup... yum yum yum yum&quot;</span><span class="p">,</span>
    <span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-s&quot;</span><span class="p">,</span> <span class="s2">&quot;--stocks&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;comma sep. stocks or portfolio.txt&quot;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-c&quot;</span><span class="p">,</span> <span class="s2">&quot;--csv&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;set csv export with &quot;your_csv.csv&quot;&#39;</span><span class="p">)</span>
<span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
<span class="n">prices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="k">for</span> <span class="n">stock</span> <span class="ow">in</span> <span class="n">args</span><span class="o">.</span><span class="n">stocks</span><span class="p">:</span>
    <span class="n">summary</span><span class="p">,</span> <span class="n">ah_pct_change</span> <span class="o">=</span> <span class="n">yahoo_finance_prices</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">stock</span><span class="p">)</span>
    <span class="n">rprint</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[steel_blue]</span><span class="si">{</span><span class="n">summary</span><span class="si">}</span><span class="s2">[/steel_blue]</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">prices</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">stock</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">ah_pct_change</span><span class="p">])</span>
<span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">csv</span><span class="p">:</span>
    <span class="c1"># Importing here shaves 1 second off the CLI when CSV is not required.</span>
    <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
    <span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Stock&quot;</span><span class="p">,</span> <span class="s2">&quot;Price_Summary&quot;</span><span class="p">,</span> <span class="s2">&quot;URL&quot;</span><span class="p">,</span> <span class="s2">&quot;AH_%_Change&quot;</span><span class="p">]</span>
    <span class="n">stock_prices</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">prices</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">cols</span><span class="p">)</span>
    <span class="n">stock_prices</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">csv</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div></td></tr></table></div>
<p><strong>Make It Fast</strong></p>
<blockquote>
&quot;Make it work, make it better, make it fast.&quot;
- <a class="reference external" href="https://tidyfirst.substack.com/">Kent Beck</a></blockquote>
<p>That's how I sped up my Python CLI by 25%. This method bucks the convention of keeping your import statements at the top of your script. In my case, it's a hobby project so I feel ok with making the trade-off of less readable code for a snappier CLI experience. You could also consider using the standard library csv module instead of pandas.</p>
<p><strong>For Comparison, An import csv pyinstrument Report</strong></p>
<img alt="profiling an import of the Python csv module" src="https://lofipython.com/images/csv-module-import.png" />
<p>I clocked the csv module import at 0.003 or three thousandths of a second with pyinstrument. That's insanely fast compared to pandas. I chose to make a quick fix by shifting the import but using the csv module could be a better long-term solution for speeding up your scripts.</p>
<p><strong>Supplementary Reading</strong></p>
<p><a class="reference external" href="https://lofipython.com/making-a-yahoo-stock-price-summary-cli-with-python">Making a Yahoo Stock Price CLI With Python</a></p>
<p><a class="reference external" href="https://docs.python.org/3/library/profile.html">The Python Profilers, Python Documentation</a></p>
<p><a class="reference external" href="https://stackoverflow.com/questions/62599036/python-requests-is-slow-and-takes-very-long-to-complete-http-or-https-request">Stack Overflow Thread About Slow HTTP Requests</a></p>
<p><a class="reference external" href="https://lofipython.com/tools-tips-to-beat-memoryerror-in-your-python-scripts">An Overview of Python Profiling and Diagnostic Tools</a></p>

                <div class="clear"></div>

                <div class="info">
                    <a href="https://lofipython.com/how-i-sped-up-a-python-get-request-by-25%.html">posted at 17:25</a>
                    &nbsp;&middot;&nbsp;<a href="https://lofipython.com/category/coding-programming-python-python-performance-cli.html" rel="tag">coding, programming, python, python performance, CLI</a>
                    &nbsp;&middot;
                    &nbsp;<a href="https://lofipython.com/tag/python-cli.html" class="tags">python CLI</a>
                    &nbsp;<a href="https://lofipython.com/tag/python-script-optimization.html" class="tags">python script optimization</a>
                    &nbsp;<a href="https://lofipython.com/tag/speeding-up-python-code.html" class="tags">speeding up python code</a>
                </div>
            </article>            <h4 class="date">Oct 10, 2023</h4>

            <article class="post">
                <h2 class="title">
                    <a href="https://lofipython.com/making-a-yahoo-stock-price-summary-cli-with-python.html" rel="bookmark" title="Permanent Link to &quot;Making a Yahoo Stock Price Summary CLI with Python&quot;">Making a Yahoo Stock Price Summary CLI with Python</a>
                </h2>

                
                

                <p>Over the past few years, I found a few different external Python libraries that relied on a broken <a class="reference external" href="https://finance.yahoo.com/">Yahoo Finance</a> API. Apparently, the API changes frequently, leaving us developers in a tough spot troubleshooting tracebacks in order to get stock data. I wanted to check my stocks' prices from the terminal. 6 months ago, dealing with these frustrations inspired me to begin making a Python command line interface (CLI) to fetch stock info directly from the Yahoo Finance website.</p>
<p>With an idea and curiosity to see if I could make it work, I reached for the beautifulsoup4 library, the de facto HTML parser in Python. It turned out way better than I envisioned when I started. The CLI is working great, barring any changes to Yahoo's stock page HTML or CSS code. It accepts a stock ticker and grabs stock price data from the Yahoo website in your terminal. It is designed to monitor daily moves of stocks, including after hours prices.</p>
<p>Here is <a class="reference external" href="https://github.com/erickbytes/finsou.py">the Github repo with the code</a>. I've named the CLI finsou.py, which I've been pronouncing to myself as &quot;finsoupy&quot;, a word play on fin soup, short for financial soup. The standard library <a class="reference external" href="https://docs.python.org/3/library/argparse.html">argparse module</a> provided the CLI argument ingesting functionality. The CLI uses <a class="reference external" href="https://pypi.org/project/requests/">the requests module</a>, <a class="reference external" href="https://pypi.org/project/beautifulsoup4/">beautifulsoup4</a> and <a class="reference external" href="https://docs.python.org/3/library/re.html">re</a> modules. With these 3 modules, it retrieves stock info and organizes it into a tidy, color coded report that is printed to your console. After getting the essential functionality working, I added improvements like the <a class="reference external" href="https://github.com/Textualize/rich">rich module</a> to add in terminal color formatting and <a class="reference external" href="https://github.com/tqdm/tqdm">tqdm</a> for a progress bar.</p>
<p>The CLI currently works after the US stock market has closed normal market hours. Additionally, after hours prices for &quot;over the counter&quot; (OTC) traded stocks are not listed on Yahoo so an error is returned for those stocks.</p>
<p><strong>Getting Started with finsou.py</strong></p>
<ol class="arabic simple">
<li>First, install the necessary Python library dependencies:</li>
</ol>
<pre class="code console literal-block">
<span class="go">pip install beautifulsoup4
pip install pandas
pip install requests
pip install rich
pip install tqdm</span>
</pre>
<ol class="arabic simple" start="2">
<li>Next, clone the Github repo:</li>
</ol>
<pre class="code console literal-block">
<span class="go">git clone https://github.com/erickbytes/finsou.py.git</span>
</pre>
<ol class="arabic simple" start="3">
<li>Change directory into the finsou.py folder that contains the Python script:</li>
</ol>
<pre class="code console literal-block">
<span class="go">cd finsou.py</span>
</pre>
<ol class="arabic simple" start="4">
<li>Query a stock's daily price summary:</li>
</ol>
<pre class="code console literal-block">
<span class="gp"># </span>Print<span class="w"> </span>a<span class="w"> </span>daily<span class="w"> </span>stock<span class="w"> </span>summary<span class="w"> </span><span class="k">for</span><span class="w"> </span>Virgin<span class="w"> </span>Galactic<span class="w"> </span><span class="o">(</span>SPCE<span class="o">)</span>.<span class="w">
</span><span class="go">python finsou.py -s SPCE</span>
</pre>
<img alt="example stock summary report" src="https://lofipython.com/images/finsoupy-stock-summary.png" />
<p><strong>Fetch a stock summary for multiple companies.</strong></p>
<pre class="code console literal-block">
<span class="gp"># </span>Summarize<span class="w"> </span>a<span class="w"> </span>list<span class="w"> </span>of<span class="w"> </span>stocks.<span class="w">
</span><span class="go">python finsou.py -s BABA,SPOT,KO</span>
</pre>
<p><strong>Read a list of stocks from a .txt file.</strong></p>
<pre class="code console literal-block">
<span class="gp"># </span>Read<span class="w"> </span>a<span class="w"> </span>list<span class="w"> </span>of<span class="w"> </span>stocks<span class="w"> </span>from<span class="w"> </span>a<span class="w"> </span>text<span class="w"> </span>file<span class="w"> </span>with<span class="w"> </span>one<span class="w"> </span>ticker<span class="w"> </span>on<span class="w"> </span>each<span class="w"> </span>line.<span class="w">
</span><span class="go">python finsou.py -s portfolio.txt -c &quot;Portfolio Prices.csv&quot;</span>
</pre>
<p><strong>Research + download media from investor relations websites.</strong></p>
<p>Note: currently the code needs to be modified depending on the HTML structure of the page.</p>
<pre class="code console literal-block">
<span class="gp"># </span>Note:<span class="w"> </span>this<span class="w"> </span>is<span class="w"> </span>experimental<span class="w"> </span>and<span class="w"> </span>results<span class="w"> </span>will<span class="w"> </span>vary.<span class="w"> </span>URLs<span class="w"> </span>are<span class="w"> </span>typically<span class="w"> </span>buried<span class="w"> </span><span class="k">in</span><span class="w"> </span>nested<span class="w"> </span>span<span class="w"> </span>and<span class="w"> </span>div<span class="w"> </span>tags.<span class="w">
</span><span class="go">python finsou.py -s GRAB -r https://investors.grab.com/events-and-presentations</span>
</pre>
<p><strong>How It Works</strong></p>
<p>Check out the <a class="reference external" href="https://github.com/erickbytes/finsou.py/blob/main/finsou.py">finsou.py Python script</a> to see the complete code for how this stock report is created. Here is a brief simplified example of the logic behind the code.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>

<span class="n">stock</span> <span class="o">=</span> <span class="s2">&quot;SNOW&quot;</span>
<span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://finance.yahoo.com/quote/</span><span class="si">{</span><span class="n">stock</span><span class="si">}</span><span class="s2">/&quot;</span>
<span class="n">user_agent</span> <span class="o">=</span> <span class="s2">&quot;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/534.1 (KHTML, like Gecko) Chrome/43.0.845.0 Safari/534.1&quot;</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Cache-Control&quot;</span><span class="p">:</span> <span class="s2">&quot;no-cache&quot;</span><span class="p">,</span>
    <span class="s2">&quot;User-Agent&quot;</span><span class="p">:</span> <span class="n">user_agent</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">page</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
<span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">page</span><span class="p">,</span> <span class="s2">&quot;html.parser&quot;</span><span class="p">)</span>
<span class="n">price_tags</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span>
    <span class="n">class_</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&quot;Fw\(b\) Fz\(36px\) Mb\(\-4px\) D\(ib\)&quot;</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">mkt_close_price</span> <span class="o">=</span> <span class="n">price_tags</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">string</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mkt_close_price</span><span class="p">)</span>
</pre></div></td></tr></table></div>
<p>First, an HTTP request is made and parsed by beautiful soup using Python's html.parser. We can then use bs4 and regex's <a class="reference external" href="https://docs.python.org/3/library/re.html#re.compile">re.compile function</a> to return the HTML tags with a specific CSS class. Then once we have the tags, beautiful soup gives us a &quot;.string&quot; attribute for each tag to return their contents as a string. This pattern was applied to return all of the data in the stock report. To find the css classes I wanted, I right-clicked the price or data on Yahoo's website in a Chrome browser and selected &quot;Inspect&quot;. Doing this opens Chrome's developer tools and drops you into that spot in the HTML code, where you can find the class you want to target.</p>
<p><strong>No Official API, No Problem</strong></p>
<p>It felt good to prove the concept that you don't need an official API
to print stock data in your terminal! If you want to check in on your
portfolio's daily moves, give this CLI a try: <a class="reference external" href="https://github.com/erickbytes/finsou.py">finsou.py Github Repo</a></p>
<p>If you're looking for a more robust finance Python module,
I recommend <a class="reference external" href="https://pypi.org/project/yfinance/">yfinance</a> for querying stock data.</p>

                <div class="clear"></div>

                <div class="info">
                    <a href="https://lofipython.com/making-a-yahoo-stock-price-summary-cli-with-python.html">posted at 18:56</a>
                    &nbsp;&middot;&nbsp;<a href="https://lofipython.com/category/coding-programming-python-stocks-cli.html" rel="tag">coding, programming, python, stocks, CLI</a>
                    &nbsp;&middot;
                    &nbsp;<a href="https://lofipython.com/tag/stock-prices-command-line.html" class="tags">stock prices command line</a>
                    &nbsp;<a href="https://lofipython.com/tag/python-cli.html" class="tags">python CLI</a>
                    &nbsp;<a href="https://lofipython.com/tag/python-investing-research.html" class="tags">python investing research</a>
                </div>
            </article>            <h4 class="date">Oct 02, 2023</h4>

            <article class="post">
                <h2 class="title">
                    <a href="https://lofipython.com/an-introduction-to-the-langchain-python-library.html" rel="bookmark" title="Permanent Link to &quot;An Introduction to the LangChain Python Library&quot;">An Introduction to the LangChain Python Library</a>
                </h2>

                
                

                <p>LangChain is a lauded Python library in the <a class="reference external" href="https://en.wikipedia.org/wiki/Large_language_model">large language model</a> space. It seems to be riding along on the AI hype train as of late and is getting mentioned everywhere I look. I wrote this post to understand better, what is LangChain? Warning: I learned a lot by researching for this post! Below you'll find basic information about what LangChain is and code examples for a few of its use cases. I connected a few different sources that helped me fill in the gaps in my knowledge. After reading this, you'll have a basic understanding of what this Python module does and some of the diverse ways it can be applied.</p>
<p>A huge bonus of this library is that it has <a class="reference external" href="https://python.langchain.com/docs/get_started/quickstart">excellent documentation</a>. On the front page, they state its main value propositions.</p>
<blockquote>
<p>The main value props of LangChain are:</p>
<p>Components: abstractions for working with language models, along with a collection of implementations for each  abstraction. Components are modular and easy-to-use, whether you are using the rest of the LangChain framework or not</p>
<p>Off-the-shelf chains: a structured assembly of components for accomplishing specific higher-level tasks
Off-the-shelf chains make it easy to get started. For complex applications, components make it easy to customize existing chains and build new ones.</p>
</blockquote>
<p>The Github repo states LangChain is for &quot;Building applications with LLMs through composability&quot;. Ok, so what is composability?</p>
<blockquote>
Composability is a system design principle that deals with the inter-relationships of components. A highly composable system provides components that can be selected and assembled in various combinations to satisfy specific user requirements. - <a class="reference external" href="https://en.wikipedia.org/wiki/Large_language_model">Wikipedia</a></blockquote>
<p>LangChain is important because it provides the function of &quot;orchestration&quot; in an LLM serving workflow:</p>
<blockquote>
<p>The leading orchestration tool right now in the LLM space is LangChain, and it is a marvel. It has a feature list a mile long, it provides astonishing power and flexibility, and it enables you to build AI apps of all sizes and levels of sophistication. But with that power comes quite a bit of complexity. Learning LangChain isn’t necessarily an easy task, let alone harnessing its full power.</p>
<p>- Stephen Hood, <a class="reference external" href="https://hacks.mozilla.org/2023/07/so-you-want-to-build-your-own-open-source-chatbot">So you want to build your own open source chatbot… – Mozilla Hacks</a></p>
</blockquote>
<p>Sometimes an orchestration tool is required, but sometimes you can &quot;roll your own&quot; in a sense, as Mozilla did in their post about serving an LLM. When making your own large language model, you'll want to consider how it will be orchestrated. This is the functionality LangChain provides. In more complex LLM flows that involve tasks like writing code and subsequently running it, LangChain is essential.</p>
<blockquote>
<p>Often people hook up LLMs as part of a sequence of operations. LangChain does this. It puts an LLM in series with some other tools. For instance, LLMs can’t do math, they just spout plausible answers. They can write code, because they’ve read so much of it in their training. By themselves, they can’t use it. But configure a LangChain agent with both an LLM and a Python interpreter, and it can answer word problems. First ask the LLM for a plan to solve the problem, given a Python interpreter; then when the LLM returns code, run it; then provide the answer to the LLM so it can structure the final response.</p>
<p>- Jessica Kerr, <a class="reference external" href="https://jessitron.com/2023/09/04/a-developers-guide-to-integrating-with-llms">A Developer’s Starting Point for Integrating with LLMs</a></p>
</blockquote>
<p>You'll also want to consider if you need to tune your own AI model, but beware that this can cost a lot of money in compute resources consumed. It seems more likely that for the AI-layperson coder, going with an off-the-shelf model via an API or open source code base makes more fiscal sense and is probably easier. However, you may achieve a unique quality of response by tuning your model to your specific use case, or providing examples as tokens for the model to consume before responding.</p>
<blockquote>
<p>Model training needs lots and lots of machines in relatively close proximity to one another. It needs the absolute latest, greatest GPUs.</p>
<p>- Matthew Prince, James Governor, <a class="reference external" href="https://redmonk.com/jgovernor/2023/07/17/cloudflare-as-an-ai-play-an-interview-with-ceo-matthew-prince">Cloudflare as an AI play. An Interview with Matthew Prince</a></p>
</blockquote>
<p><strong>An Example LLM Stack With LangChain</strong></p>
<img alt="Overview of an LLM stack from Mozilla" src="https://lofipython.com/images/MozillaAssistantdiagram.png" />
<p>source: <a class="reference external" href="https://hacks.mozilla.org/2023/07/so-you-want-to-build-your-own-open-source-chatbot">So you want to build your own open source chatbot… – Mozilla Hacks</a></p>
<p><strong>Installing the Python Libraries with pip</strong></p>
<pre class="code console literal-block">
<span class="go">pip install langchain[all]</span>
</pre>
<pre class="code console literal-block">
<span class="go">pip install openai</span>
</pre>
<p><strong>The Two Types of Language Models</strong></p>
<blockquote>
<p>There are two types of language models, which in LangChain are called:</p>
<p>LLMs: this is a language model which takes a string as input and returns a string</p>
<p>ChatModels: this is a language model which takes a list of messages as input and returns a message</p>
</blockquote>
<p><strong>Calling OpenAI Without a Chain from LangChain</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">from</span> <span class="nn">langchain.llms</span> <span class="kn">import</span> <span class="n">OpenAI</span>

<span class="n">llm</span> <span class="o">=</span> <span class="n">OpenAI</span><span class="p">(</span><span class="n">openai_api_key</span><span class="o">=</span><span class="s2">&quot;...&quot;</span><span class="p">)</span>
<span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;What would be a good company name for a company that makes colorful socks?&quot;</span>
<span class="n">llm</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<span class="c1"># &gt;&gt; Feetful of Fun</span>
<span class="n">chat_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<span class="c1"># &gt;&gt; Socks O&#39;Color</span>
</pre></div></td></tr></table></div>
<p><strong>Chaining Components with LangChain</strong></p>
<p>The chains are a Python class, as demonstrated in this psuedo-code from their docs.</p>
<blockquote>
<p>Using an LLM in isolation is fine for simple applications, but more complex applications require chaining LLMs - either with each other or with other components.</p>
<p>LangChain provides the Chain interface for such &quot;chained&quot; applications. We define a Chain very generically as a sequence of calls to components, which can include other chains. The base interface is simple:</p>
<p>- <a class="reference external" href="https://python.langchain.com/docs/modules/chains/">LangChain Documentation, Chains How-To</a></p>
</blockquote>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><span class="k">class</span> <span class="nc">Chain</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">,</span> <span class="n">ABC</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base interface that all chains should implement.&quot;&quot;&quot;</span>

    <span class="n">memory</span><span class="p">:</span> <span class="n">BaseMemory</span>
    <span class="n">callbacks</span><span class="p">:</span> <span class="n">Callbacks</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">inputs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
        <span class="n">return_only_outputs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">callbacks</span><span class="p">:</span> <span class="n">Callbacks</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
        <span class="o">...</span>
</pre></div></td></tr></table></div>
<p><strong>Chaining Open AI Components</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">from</span> <span class="nn">langchain.llms</span> <span class="kn">import</span> <span class="n">OpenAI</span>
<span class="kn">from</span> <span class="nn">langchain.prompts</span> <span class="kn">import</span> <span class="n">PromptTemplate</span>
<span class="kn">from</span> <span class="nn">langchain.chains</span> <span class="kn">import</span> <span class="n">LLMChain</span>

<span class="n">llm</span> <span class="o">=</span> <span class="n">OpenAI</span><span class="p">(</span><span class="n">temperature</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
<span class="n">prompt</span> <span class="o">=</span> <span class="n">PromptTemplate</span><span class="p">(</span>
    <span class="n">input_variables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;product&quot;</span><span class="p">],</span>
    <span class="n">template</span><span class="o">=</span><span class="s2">&quot;What is a good name for a company that makes </span><span class="si">{product}</span><span class="s2">?&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">chain</span> <span class="o">=</span> <span class="n">LLMChain</span><span class="p">(</span><span class="n">llm</span><span class="o">=</span><span class="n">llm</span><span class="p">,</span> <span class="n">prompt</span><span class="o">=</span><span class="n">prompt</span><span class="p">)</span>
<span class="c1"># Run the chain only specifying the input variable.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">chain</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;colorful socks&quot;</span><span class="p">))</span>
<span class="c1"># &gt;&gt; Socks O&#39;Color</span>
</pre></div></td></tr></table></div>
<p><strong>Natural Language Queries with LangChain</strong></p>
<p>These examples are shown in <a class="reference external" href="https://python.langchain.com/docs/use_cases/qa_structured/sql/">Analyzing Structured Data</a>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">from</span> <span class="nn">langchain.utilities</span> <span class="kn">import</span> <span class="n">SQLDatabase</span>
<span class="kn">from</span> <span class="nn">langchain.llms</span> <span class="kn">import</span> <span class="n">OpenAI</span>
<span class="kn">from</span> <span class="nn">langchain_experimental.sql</span> <span class="kn">import</span> <span class="n">SQLDatabaseChain</span>

<span class="c1"># The documented examples use a Chinook DB.</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">SQLDatabase</span><span class="o">.</span><span class="n">from_uri</span><span class="p">(</span><span class="s2">&quot;sqlite:///Chinook.db&quot;</span><span class="p">)</span>
<span class="n">llm</span> <span class="o">=</span> <span class="n">OpenAI</span><span class="p">(</span><span class="n">temperature</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">db_chain</span> <span class="o">=</span> <span class="n">SQLDatabaseChain</span><span class="o">.</span><span class="n">from_llm</span><span class="p">(</span><span class="n">llm</span><span class="p">,</span> <span class="n">db</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">db_chain</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;How many employees are there?&quot;</span><span class="p">)</span>
<span class="c1"># &gt;&gt;&gt; &#39;There are 8 employees.&#39;</span>
</pre></div></td></tr></table></div>
<p><strong>Text to SQL Queries With Ability to Run the Query on the Database</strong></p>
<blockquote>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">from</span> <span class="nn">langchain.utilities</span> <span class="kn">import</span> <span class="n">SQLDatabase</span>
<span class="kn">from</span> <span class="nn">langchain.chat_models</span> <span class="kn">import</span> <span class="n">ChatOpenAI</span>
<span class="kn">from</span> <span class="nn">langchain.chains</span> <span class="kn">import</span> <span class="n">create_sql_query_chain</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">SQLDatabase</span><span class="o">.</span><span class="n">from_uri</span><span class="p">(</span><span class="s2">&quot;sqlite:///Chinook.db&quot;</span><span class="p">)</span>
<span class="n">chain</span> <span class="o">=</span> <span class="n">create_sql_query_chain</span><span class="p">(</span><span class="n">ChatOpenAI</span><span class="p">(</span><span class="n">temperature</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">db</span><span class="p">)</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">chain</span><span class="o">.</span><span class="n">invoke</span><span class="p">({</span><span class="s2">&quot;question&quot;</span><span class="p">:</span><span class="s2">&quot;How many employees are there&quot;</span><span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
<span class="c1"># &gt;&gt;&gt; &#39;There are 8 employees.&#39;</span>
</pre></div></td></tr></table></div>
</blockquote>
<p><strong>Use a LangChain Agent to Describe a Database Table</strong></p>
<blockquote>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">from</span> <span class="nn">langchain.agents</span> <span class="kn">import</span> <span class="n">create_sql_agent</span>
<span class="kn">from</span> <span class="nn">langchain.agents.agent_toolkits</span> <span class="kn">import</span> <span class="n">SQLDatabaseToolkit</span>
<span class="c1"># from langchain.agents import AgentExecutor</span>
<span class="kn">from</span> <span class="nn">langchain.agents.agent_types</span> <span class="kn">import</span> <span class="n">AgentType</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">SQLDatabase</span><span class="o">.</span><span class="n">from_uri</span><span class="p">(</span><span class="s2">&quot;sqlite:///Chinook.db&quot;</span><span class="p">)</span>
<span class="n">llm</span> <span class="o">=</span> <span class="n">OpenAI</span><span class="p">(</span><span class="n">temperature</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">agent_executor</span> <span class="o">=</span> <span class="n">create_sql_agent</span><span class="p">(</span>
    <span class="n">llm</span><span class="o">=</span><span class="n">OpenAI</span><span class="p">(</span><span class="n">temperature</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
    <span class="n">toolkit</span><span class="o">=</span><span class="n">SQLDatabaseToolkit</span><span class="p">(</span><span class="n">db</span><span class="o">=</span><span class="n">db</span><span class="p">,</span> <span class="n">llm</span><span class="o">=</span><span class="n">OpenAI</span><span class="p">(</span><span class="n">temperature</span><span class="o">=</span><span class="mi">0</span><span class="p">)),</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">agent_type</span><span class="o">=</span><span class="n">AgentType</span><span class="o">.</span><span class="n">ZERO_SHOT_REACT_DESCRIPTION</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">agent_executor</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;Describe the playlisttrack table&quot;</span><span class="p">)</span>
</pre></div></td></tr></table></div>
</blockquote>
<p><strong>Description of Database Table Result</strong></p>
<blockquote>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span></pre></div></td><td class="code"><div><pre><span></span><span class="go">&gt; Entering new AgentExecutor chain...</span>
<span class="go">Action: sql_db_list_tables</span>
<span class="go">Action Input:</span>
<span class="go">Observation: Album, Artist, Customer, Employee, Genre, Invoice, InvoiceLine, MediaType, Playlist, PlaylistTrack, Track</span>
<span class="go">Thought: The PlaylistTrack table is the most relevant to the question.</span>
<span class="go">Action: sql_db_schema</span>
<span class="go">Action Input: PlaylistTrack</span>
<span class="go">Observation:</span>
<span class="go">CREATE TABLE &quot;PlaylistTrack&quot; (</span>
<span class="go">    &quot;PlaylistId&quot; INTEGER NOT NULL,</span>
<span class="go">    &quot;TrackId&quot; INTEGER NOT NULL,</span>
<span class="go">    PRIMARY KEY (&quot;PlaylistId&quot;, &quot;TrackId&quot;),</span>
<span class="go">    FOREIGN KEY(&quot;TrackId&quot;) REFERENCES &quot;Track&quot; (&quot;TrackId&quot;),</span>
<span class="go">    FOREIGN KEY(&quot;PlaylistId&quot;) REFERENCES &quot;Playlist&quot; (&quot;PlaylistId&quot;)</span>
<span class="go">)</span>

<span class="go">/*</span>
<span class="go">3 rows from PlaylistTrack table:</span>
<span class="go">PlaylistId  TrackId</span>
<span class="go">1   3402</span>
<span class="go">1   3389</span>
<span class="go">1   3390</span>
<span class="go">*/</span>
<span class="go">Thought: I now know the final answer</span>
<span class="go">Final Answer: The PlaylistTrack table contains two columns, PlaylistId and TrackId, which are both integers and form a primary key. It also has two foreign keys, one to the Track table    and one to the Playlist table.</span>

<span class="go">&gt; Finished chain.</span>
</pre></div></td></tr></table></div>
</blockquote>
<p><strong>Versatile + Flexible for Your LLM Needs</strong></p>
<p>If you prefer using the Meta's LLaMA model over OpenAI, more power to you. LangChain can do both and many more. At the time of this writing, the following models are documented: Anthropic, Anthropic Functions, Anyscale, Azure, Azure ML Chat Online Interface, Baidu Qianfan, Bedrock Chat, ERNIE-bot Chat, Fireworks, GCP Vertex API, JinaChat, Konko, LiteLLM, Llama API, MiniMax, Ollama, OpenAI, PromptLayer ChatOpenAI and vLLM Chat.</p>
<p><strong>Wrapping Up With LangChain</strong></p>
<p>These examples represent a few things you can do with this popular Python library. You're now a step closer to creating your next AI-infused product or service. No one needs to know it's just a wrapper for OpenAI and LangChain! The library's name makes more sense once you understand a bit of its context as orchestrator. It chains together the pieces of your large language model's parts into a shiny, impressive AI solution.</p>
<p><strong>Read More:</strong></p>
<p><a class="reference external" href="https://python.langchain.com/docs/modules/chains/how_to/">LangChain Documentation, Chains How To</a></p>
<p><a class="reference external" href="https://python.langchain.com/docs/guides/deployments/">LangChain Documentation, Deployments</a></p>

                <div class="clear"></div>

                <div class="info">
                    <a href="https://lofipython.com/an-introduction-to-the-langchain-python-library.html">posted at 15:15</a>
                    &nbsp;&middot;&nbsp;<a href="https://lofipython.com/category/coding-programming-python-artificial-intelligence-ai.html" rel="tag">coding, programming, python, artificial intelligence, AI</a>
                    &nbsp;&middot;
                    &nbsp;<a href="https://lofipython.com/tag/python-large-language-models.html" class="tags">python large language models</a>
                    &nbsp;<a href="https://lofipython.com/tag/python-llm.html" class="tags">python LLM</a>
                    &nbsp;<a href="https://lofipython.com/tag/langchain-python-introduction.html" class="tags">langchain python introduction</a>
                    &nbsp;<a href="https://lofipython.com/tag/python-llm-orchestration.html" class="tags">python LLM orchestration</a>
                </div>
            </article>            <h4 class="date">Sep 18, 2023</h4>

            <article class="post">
                <h2 class="title">
                    <a href="https://lofipython.com/working-with-rss-in-python.html" rel="bookmark" title="Permanent Link to &quot;RSS Is Thriving: Working With RSS Python Tools&quot;">RSS Is Thriving: Working With RSS Python Tools</a>
                </h2>

                
                

                <p>There have been countless obituaries about RSS on the internet, like when Dan McKinley wrote that <a class="reference external" href="https://mcfunley.com/google-reader-killed-rss">&quot;Google Reader Killed RSS&quot;</a>. For sure, the existence of Google Reader had an impact on other readers gaining a wider audience before it was shut down by Google. This likely did have a suppressive impact on the adoption of RSS.</p>
<p>&quot;Whatever happened to RSS?&quot; is a question that murmurs thorugh the internet. The answer: it's still here and it's not going anywhere. I propose that RSS is not dead, but quietly regaining its strength and is on track to relevancy again. But did it actually fall off?</p>
<blockquote>
<strong>Did you know?</strong> RSS stands for &quot;Really Simple Syndication&quot;.</blockquote>
<p>Some say with the rise of social media and email newsletters, RSS is not worth the time. That's precisely what the social media and search engine giants want so you'll stay in their walled garden platform. Google killed Google Reader because it is not in their interests to support a syndication format that cuts out their search engine middleman role. Nonetheless, we only need to consciously choose to use RSS to bring it back to prominence. Who's with me?!</p>
<blockquote>
<p>&quot;RSS readers have not only survived in the era of social media,
but are driving more and more attention back to themselves, as people are realizing the pitfalls&quot;</p>
<p>- Brian Barrett. &quot;It's Time for an RSS Revival&quot;. Wired. <a class="reference external" href="https://www.wired.com/story/rss-readers-feedly-inoreader-old-reader">https://www.wired.com/story/rss-readers-feedly-inoreader-old-reader</a></p>
</blockquote>
<p>You'll often hear the term &quot;aggregator&quot; or &quot;reader&quot; when dealing with RSS, which both mean &quot;tool that collects multiple RSS feeds into single readable format&quot;. There are plenty of free RSS reader websites to keep up with new material from your favorite websites. Currently, I use <a class="reference external" href="https://feeder.co">Feeder</a> to keep up with the blogs I follow. Their free plan allows you to follow up to 200 RSS feeds for free. <a class="reference external" href="https://feedly.com">Feedly</a> is a commonly suggested RSS reader also.</p>
<img alt="RSS icon" src="https://lofipython.com/images/rssicon.png" />
<p><strong>A Few Benefits of RSS</strong></p>
<ul>
<li><p class="first">Receive notice when a new post is published by your favorite websites and blogs.</p>
</li>
<li><p class="first">The personal data of your readers is not collected.</p>
</li>
<li><p class="first">An RSS subscription is less intrusive compared to blasting into someone's cluttered email inbox. Plus you won't end up in the spam folder.</p>
</li>
<li><p class="first">Diversify your website's traffic to be less dependent on search engines and social media platforms.</p>
<blockquote>
<p>To know approximately how much RSS traffic you have, check how many HTTP requests have an XML content type. <a class="reference external" href="https://darekkay.com/blog/rss-subscriber-count/">This blog post</a> has a good breakdown of this HTTP based approach. Typically, 6% of total HTTP requests on my blog have XML content type, indicating RSS traffic.</p>
</blockquote>
</li>
</ul>
<div class="section" id="python-rss-tools">
<h2>Python RSS Tools</h2>
<p>The rest of this post will highlight some practical Python tools and resources for RSS. The libraries used in the below code examples can be installed with <a class="reference external" href="https://pip.pypa.io/en/stable/user_guide/">pip</a>. There are also some standard library Python tools mentioned. Enjoy!</p>
<p><a class="reference external" href="https://github.com/kurtmckee/feedparser">feedparser</a>: Universal Feed Parser is a Python module for downloading and parsing syndicated feeds</p>
<p><strong>Parse an RSS feed with feedparser.</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">import</span> <span class="nn">feedparser</span>

<span class="n">feed</span> <span class="o">=</span> <span class="s2">&quot;https://feedparser.readthedocs.io/en/latest/examples/atom10.xml&quot;</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">feedparser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">feed</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;feed&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">feed</span><span class="o">.</span><span class="n">published</span><span class="p">)</span>
</pre></div></td></tr></table></div>
<p><strong>Detect a malformed RSS feed with feedparser &quot;bozo&quot;.</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">import</span> <span class="nn">feedparser</span>

<span class="c1"># https://feedparser.readthedocs.io/en/latest/bozo.html#detecting-a-non-well-formed-feed</span>
<span class="n">feed</span> <span class="o">=</span> <span class="s2">&quot;http://feedparser.org/tests/illformed/rss/aaa_illformed.xml&quot;</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">feedparser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">feed</span><span class="p">)</span>
<span class="c1"># d.bozo: An integer, either 1 or 0. Set to 1 if the feed is not well-formed XML, and 0 otherwise.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">bozo</span><span class="p">)</span>
<span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">bozo</span><span class="p">:</span>
    <span class="n">exc</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">bozo_exception</span>
    <span class="c1"># Print bozo error message.</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">getMessage</span><span class="p">())</span>
    <span class="c1"># Print line number where exception occurred.</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error at line </span><span class="si">{</span><span class="n">exc</span><span class="o">.</span><span class="n">getLineNumber</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Feed is well-formed RSS.&quot;</span><span class="p">)</span>
</pre></div></td></tr></table></div>
<p><a class="reference external" href="https://www.feedvalidator.org/">feedvalidator</a> and <a class="reference external" href="https://validator.w3.org/feed/">W3 RSS Validator</a>: check if your feed is valid RSS or Atom. Below shows how you can validate your feed using the webbrowser module with the Python CLI:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><span class="gp"># </span>Validate<span class="w"> </span>an<span class="w"> </span>RSS<span class="w"> </span>feed.
<span class="go">python -m webbrowser -t &quot;https://validator.w3.org/feed/check.cgi?url=https://example.com/feeds/all.rss.xml&quot;</span>
</pre></div></td></tr></table></div>
<p><a class="reference external" href="https://github.com/NicolasLM/atoma">atoma</a>: an Atom, RSS and JSON feed parser</p>
<p><strong>Parse an RSS feed with atoma.</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">import</span> <span class="nn">atoma</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;https://example.com/feed.atom&quot;</span><span class="p">)</span>
<span class="n">feed</span> <span class="o">=</span> <span class="n">atoma</span><span class="o">.</span><span class="n">parse_atom_bytes</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">feed</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</pre></div></td></tr></table></div>
<p><strong>Additional RSS Tools, Reads + Resources</strong></p>
<p><a class="reference external" href="https://www.wired.com/story/rss-readers-feedly-inoreader-old-reader/">It's Time for an RSS Revival, Wired</a></p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Mozilla_Thunderbird">Mozilla Thunderbird</a>: an open source RSS client</p>
<p><a class="reference external" href="https://github.com/tuan3w/awesome-tech-rss">Awesome Tech RSS</a>: a list of tech RSS feeds you can follow</p>
<p><a class="reference external" href="https://pypi.org/project/pelican-planet/">pelican-planet</a>: a Pelican static site generator plugin that allows generating a page aggregating blog articles from other web sites. The <a class="reference external" href="https://docs.getpelican.com/en/latest/">pelican Python library</a> also has built-in support for RSS and Atom feed generation.</p>
<p><a class="reference external" href="https://docs.djangoproject.com/en/4.2/ref/contrib/syndication/#module-django.contrib.syndication">Django Syndication Feed Framework</a>: built-in RSS feed framework for Django websites</p>
<p><a class="reference external" href="https://github.com/radiac/django-yarr">django-yarr</a>: a lightweight, customisable RSS reader for the Django web framework</p>
<p><a class="reference external" href="https://github.com/lkiesow/python-feedgen">python-feedgen</a>: generates atom feeds, RSS feeds and podcasts</p>
<p><a class="reference external" href="https://realpython.com/python-xml-parser/">A Roadmap to XML Parsers in Python, Real Python</a></p>
<p><a class="reference external" href="https://pypi.org/project/lxml/">lxml</a>: a Pythonic, mature binding for the libxml2 and libxslt libraries</p>
<p><a class="reference external" href="https://docs.python.org/3/library/xml.sax.handler.html">xml.sax</a> API: standard library XML validation option that is based on a Java API</p>
<p><a class="reference external" href="https://docs.python.org/3/library/xml.html">Python Documentation, XML Processing Modules</a></p>
<p><a class="reference external" href="https://github.com/RSSerpent/RSSerpent">RSSerpent</a>: open source software to create RSS feeds for websites without them</p>
<p><a class="reference external" href="http://offog.org/git/rawdog/README">rawdog</a>: an &quot;RSS aggregator without visions of grandeur&quot;</p>
<p><a class="reference external" href="https://github.com/ai6yr/rss2mastodon">RSS2mastodon</a>: a quick set of python scripts for auto-posting an RSS or Atom feed to Mastodon</p>
<p><a class="reference external" href="https://github.com/anhqle/craigslist">Craigslist RSS Scraper Python Script</a></p>
</div>

                <div class="clear"></div>

                <div class="info">
                    <a href="https://lofipython.com/working-with-rss-in-python.html">posted at 17:14</a>
                    &nbsp;&middot;&nbsp;<a href="https://lofipython.com/category/coding-programming-python-xml-rss-writing.html" rel="tag">coding, programming, python, XML, RSS, writing</a>
                    &nbsp;&middot;
                    &nbsp;<a href="https://lofipython.com/tag/python-rss-tools.html" class="tags">python RSS tools</a>
                    &nbsp;<a href="https://lofipython.com/tag/rss-aggregator.html" class="tags">RSS aggregator</a>
                    &nbsp;<a href="https://lofipython.com/tag/rss-validation.html" class="tags">RSS validation</a>
                    &nbsp;<a href="https://lofipython.com/tag/parsing-rss-python.html" class="tags">parsing RSS python</a>
                    &nbsp;<a href="https://lofipython.com/tag/rss-feeds.html" class="tags">RSS feeds</a>
                    &nbsp;<a href="https://lofipython.com/tag/python-rss-readers.html" class="tags">python RSS readers</a>
                </div>
            </article>

                <div class="clear"></div>
                <div class="pages">


                    <a href="https://lofipython.com/author/lofipython2.html" class="next_page">Next&nbsp;&rarr;</a>

                    <span>Page 1 of 2</span>
                </div>

            <div class="clear"></div>
            <footer>
                <p>
                <a href="https://github.com/tcarwash/blue-penguin-dark">Blue Penguin Dark</a> Theme
                &middot;
                Powered by <a href="http://getpelican.com">Pelican</a>
                &middot;
                <a href="https://lofipython.com/feeds/all.atom.xml" rel="alternate">Atom Feed</a>
                &middot;
                <a href="https://lofipython.com/feeds/all.rss.xml" rel="alternate">Rss Feed</a>
            </footer>
        </div>
        <div class="clear"></div>
    </div>
</body>
</html>